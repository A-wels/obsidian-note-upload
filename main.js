/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var vu=Object.create;var Ai=Object.defineProperty;var Lu=Object.getOwnPropertyDescriptor;var Ou=Object.getOwnPropertyNames;var Uu=Object.getPrototypeOf,Pu=Object.prototype.hasOwnProperty;var ze=(n,t)=>()=>(t||n((t={exports:{}}).exports,t),t.exports),Du=(n,t)=>{for(var e in t)Ai(n,e,{get:t[e],enumerable:!0})},Bf=(n,t,e,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Ou(t))!Pu.call(n,i)&&i!==e&&Ai(n,i,{get:()=>t[i],enumerable:!(r=Lu(t,i))||r.enumerable});return n};var cn=(n,t,e)=>(e=n!=null?vu(Uu(n)):{},Bf(t||!n||!n.__esModule?Ai(e,"default",{value:n,enumerable:!0}):e,n)),Qu=n=>Bf(Ai({},"__esModule",{value:!0}),n);var kf=ze((CA,Rf)=>{"use strict";var un=n=>n!==null&&typeof n=="object"&&typeof n.pipe=="function";un.writable=n=>un(n)&&n.writable!==!1&&typeof n._write=="function"&&typeof n._writableState=="object";un.readable=n=>un(n)&&n.readable!==!1&&typeof n._read=="function"&&typeof n._readableState=="object";un.duplex=n=>un.writable(n)&&un.readable(n);un.transform=n=>un.duplex(n)&&typeof n._transform=="function";Rf.exports=un});var Uf=ze((ve,Of)=>{ve=Of.exports=Ke;var ft;typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?ft=function(){var n=Array.prototype.slice.call(arguments,0);n.unshift("SEMVER"),console.log.apply(console,n)}:ft=function(){};ve.SEMVER_SPEC_VERSION="2.0.0";var Or=256,gi=Number.MAX_SAFE_INTEGER||9007199254740991,Is=16,Hu=Or-6,rr=ve.re=[],ot=ve.safeRe=[],$=ve.src=[],P=ve.tokens={},vf=0;function Ye(n){P[n]=vf++}var ys="[a-zA-Z0-9-]",xs=[["\\s",1],["\\d",Or],[ys,Hu]];function Pr(n){for(var t=0;t<xs.length;t++){var e=xs[t][0],r=xs[t][1];n=n.split(e+"*").join(e+"{0,"+r+"}").split(e+"+").join(e+"{1,"+r+"}")}return n}Ye("NUMERICIDENTIFIER");$[P.NUMERICIDENTIFIER]="0|[1-9]\\d*";Ye("NUMERICIDENTIFIERLOOSE");$[P.NUMERICIDENTIFIERLOOSE]="\\d+";Ye("NONNUMERICIDENTIFIER");$[P.NONNUMERICIDENTIFIER]="\\d*[a-zA-Z-]"+ys+"*";Ye("MAINVERSION");$[P.MAINVERSION]="("+$[P.NUMERICIDENTIFIER]+")\\.("+$[P.NUMERICIDENTIFIER]+")\\.("+$[P.NUMERICIDENTIFIER]+")";Ye("MAINVERSIONLOOSE");$[P.MAINVERSIONLOOSE]="("+$[P.NUMERICIDENTIFIERLOOSE]+")\\.("+$[P.NUMERICIDENTIFIERLOOSE]+")\\.("+$[P.NUMERICIDENTIFIERLOOSE]+")";Ye("PRERELEASEIDENTIFIER");$[P.PRERELEASEIDENTIFIER]="(?:"+$[P.NUMERICIDENTIFIER]+"|"+$[P.NONNUMERICIDENTIFIER]+")";Ye("PRERELEASEIDENTIFIERLOOSE");$[P.PRERELEASEIDENTIFIERLOOSE]="(?:"+$[P.NUMERICIDENTIFIERLOOSE]+"|"+$[P.NONNUMERICIDENTIFIER]+")";Ye("PRERELEASE");$[P.PRERELEASE]="(?:-("+$[P.PRERELEASEIDENTIFIER]+"(?:\\."+$[P.PRERELEASEIDENTIFIER]+")*))";Ye("PRERELEASELOOSE");$[P.PRERELEASELOOSE]="(?:-?("+$[P.PRERELEASEIDENTIFIERLOOSE]+"(?:\\."+$[P.PRERELEASEIDENTIFIERLOOSE]+")*))";Ye("BUILDIDENTIFIER");$[P.BUILDIDENTIFIER]=ys+"+";Ye("BUILD");$[P.BUILD]="(?:\\+("+$[P.BUILDIDENTIFIER]+"(?:\\."+$[P.BUILDIDENTIFIER]+")*))";Ye("FULL");Ye("FULLPLAIN");$[P.FULLPLAIN]="v?"+$[P.MAINVERSION]+$[P.PRERELEASE]+"?"+$[P.BUILD]+"?";$[P.FULL]="^"+$[P.FULLPLAIN]+"$";Ye("LOOSEPLAIN");$[P.LOOSEPLAIN]="[v=\\s]*"+$[P.MAINVERSIONLOOSE]+$[P.PRERELEASELOOSE]+"?"+$[P.BUILD]+"?";Ye("LOOSE");$[P.LOOSE]="^"+$[P.LOOSEPLAIN]+"$";Ye("GTLT");$[P.GTLT]="((?:<|>)?=?)";Ye("XRANGEIDENTIFIERLOOSE");$[P.XRANGEIDENTIFIERLOOSE]=$[P.NUMERICIDENTIFIERLOOSE]+"|x|X|\\*";Ye("XRANGEIDENTIFIER");$[P.XRANGEIDENTIFIER]=$[P.NUMERICIDENTIFIER]+"|x|X|\\*";Ye("XRANGEPLAIN");$[P.XRANGEPLAIN]="[v=\\s]*("+$[P.XRANGEIDENTIFIER]+")(?:\\.("+$[P.XRANGEIDENTIFIER]+")(?:\\.("+$[P.XRANGEIDENTIFIER]+")(?:"+$[P.PRERELEASE]+")?"+$[P.BUILD]+"?)?)?";Ye("XRANGEPLAINLOOSE");$[P.XRANGEPLAINLOOSE]="[v=\\s]*("+$[P.XRANGEIDENTIFIERLOOSE]+")(?:\\.("+$[P.XRANGEIDENTIFIERLOOSE]+")(?:\\.("+$[P.XRANGEIDENTIFIERLOOSE]+")(?:"+$[P.PRERELEASELOOSE]+")?"+$[P.BUILD]+"?)?)?";Ye("XRANGE");$[P.XRANGE]="^"+$[P.GTLT]+"\\s*"+$[P.XRANGEPLAIN]+"$";Ye("XRANGELOOSE");$[P.XRANGELOOSE]="^"+$[P.GTLT]+"\\s*"+$[P.XRANGEPLAINLOOSE]+"$";Ye("COERCE");$[P.COERCE]="(^|[^\\d])(\\d{1,"+Is+"})(?:\\.(\\d{1,"+Is+"}))?(?:\\.(\\d{1,"+Is+"}))?(?:$|[^\\d])";Ye("COERCERTL");rr[P.COERCERTL]=new RegExp($[P.COERCE],"g");ot[P.COERCERTL]=new RegExp(Pr($[P.COERCE]),"g");Ye("LONETILDE");$[P.LONETILDE]="(?:~>?)";Ye("TILDETRIM");$[P.TILDETRIM]="(\\s*)"+$[P.LONETILDE]+"\\s+";rr[P.TILDETRIM]=new RegExp($[P.TILDETRIM],"g");ot[P.TILDETRIM]=new RegExp(Pr($[P.TILDETRIM]),"g");var Fu="$1~";Ye("TILDE");$[P.TILDE]="^"+$[P.LONETILDE]+$[P.XRANGEPLAIN]+"$";Ye("TILDELOOSE");$[P.TILDELOOSE]="^"+$[P.LONETILDE]+$[P.XRANGEPLAINLOOSE]+"$";Ye("LONECARET");$[P.LONECARET]="(?:\\^)";Ye("CARETTRIM");$[P.CARETTRIM]="(\\s*)"+$[P.LONECARET]+"\\s+";rr[P.CARETTRIM]=new RegExp($[P.CARETTRIM],"g");ot[P.CARETTRIM]=new RegExp(Pr($[P.CARETTRIM]),"g");var Mu="$1^";Ye("CARET");$[P.CARET]="^"+$[P.LONECARET]+$[P.XRANGEPLAIN]+"$";Ye("CARETLOOSE");$[P.CARETLOOSE]="^"+$[P.LONECARET]+$[P.XRANGEPLAINLOOSE]+"$";Ye("COMPARATORLOOSE");$[P.COMPARATORLOOSE]="^"+$[P.GTLT]+"\\s*("+$[P.LOOSEPLAIN]+")$|^$";Ye("COMPARATOR");$[P.COMPARATOR]="^"+$[P.GTLT]+"\\s*("+$[P.FULLPLAIN]+")$|^$";Ye("COMPARATORTRIM");$[P.COMPARATORTRIM]="(\\s*)"+$[P.GTLT]+"\\s*("+$[P.LOOSEPLAIN]+"|"+$[P.XRANGEPLAIN]+")";rr[P.COMPARATORTRIM]=new RegExp($[P.COMPARATORTRIM],"g");ot[P.COMPARATORTRIM]=new RegExp(Pr($[P.COMPARATORTRIM]),"g");var qu="$1$2$3";Ye("HYPHENRANGE");$[P.HYPHENRANGE]="^\\s*("+$[P.XRANGEPLAIN]+")\\s+-\\s+("+$[P.XRANGEPLAIN]+")\\s*$";Ye("HYPHENRANGELOOSE");$[P.HYPHENRANGELOOSE]="^\\s*("+$[P.XRANGEPLAINLOOSE]+")\\s+-\\s+("+$[P.XRANGEPLAINLOOSE]+")\\s*$";Ye("STAR");$[P.STAR]="(<|>)?=?\\s*\\*";for(hn=0;hn<vf;hn++)ft(hn,$[hn]),rr[hn]||(rr[hn]=new RegExp($[hn]),ot[hn]=new RegExp(Pr($[hn])));var hn;ve.parse=qn;function qn(n,t){if((!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1}),n instanceof Ke)return n;if(typeof n!="string"||n.length>Or)return null;var e=t.loose?ot[P.LOOSE]:ot[P.FULL];if(!e.test(n))return null;try{return new Ke(n,t)}catch{return null}}ve.valid=Ku;function Ku(n,t){var e=qn(n,t);return e?e.version:null}ve.clean=Wu;function Wu(n,t){var e=qn(n.trim().replace(/^[=v]+/,""),t);return e?e.version:null}ve.SemVer=Ke;function Ke(n,t){if((!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1}),n instanceof Ke){if(n.loose===t.loose)return n;n=n.version}else if(typeof n!="string")throw new TypeError("Invalid Version: "+n);if(n.length>Or)throw new TypeError("version is longer than "+Or+" characters");if(!(this instanceof Ke))return new Ke(n,t);ft("SemVer",n,t),this.options=t,this.loose=!!t.loose;var e=n.trim().match(t.loose?ot[P.LOOSE]:ot[P.FULL]);if(!e)throw new TypeError("Invalid Version: "+n);if(this.raw=n,this.major=+e[1],this.minor=+e[2],this.patch=+e[3],this.major>gi||this.major<0)throw new TypeError("Invalid major version");if(this.minor>gi||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>gi||this.patch<0)throw new TypeError("Invalid patch version");e[4]?this.prerelease=e[4].split(".").map(function(r){if(/^[0-9]+$/.test(r)){var i=+r;if(i>=0&&i<gi)return i}return r}):this.prerelease=[],this.build=e[5]?e[5].split("."):[],this.format()}Ke.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version};Ke.prototype.toString=function(){return this.version};Ke.prototype.compare=function(n){return ft("SemVer.compare",this.version,this.options,n),n instanceof Ke||(n=new Ke(n,this.options)),this.compareMain(n)||this.comparePre(n)};Ke.prototype.compareMain=function(n){return n instanceof Ke||(n=new Ke(n,this.options)),Mn(this.major,n.major)||Mn(this.minor,n.minor)||Mn(this.patch,n.patch)};Ke.prototype.comparePre=function(n){if(n instanceof Ke||(n=new Ke(n,this.options)),this.prerelease.length&&!n.prerelease.length)return-1;if(!this.prerelease.length&&n.prerelease.length)return 1;if(!this.prerelease.length&&!n.prerelease.length)return 0;var t=0;do{var e=this.prerelease[t],r=n.prerelease[t];if(ft("prerelease compare",t,e,r),e===void 0&&r===void 0)return 0;if(r===void 0)return 1;if(e===void 0)return-1;if(e===r)continue;return Mn(e,r)}while(++t)};Ke.prototype.compareBuild=function(n){n instanceof Ke||(n=new Ke(n,this.options));var t=0;do{var e=this.build[t],r=n.build[t];if(ft("prerelease compare",t,e,r),e===void 0&&r===void 0)return 0;if(r===void 0)return 1;if(e===void 0)return-1;if(e===r)continue;return Mn(e,r)}while(++t)};Ke.prototype.inc=function(n,t){switch(n){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t),this.inc("pre",t);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var e=this.prerelease.length;--e>=0;)typeof this.prerelease[e]=="number"&&(this.prerelease[e]++,e=-2);e===-1&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+n)}return this.format(),this.raw=this.version,this};ve.inc=Gu;function Gu(n,t,e,r){typeof e=="string"&&(r=e,e=void 0);try{return new Ke(n,e).inc(t,r).version}catch{return null}}ve.diff=Yu;function Yu(n,t){if(Ss(n,t))return null;var e=qn(n),r=qn(t),i="";if(e.prerelease.length||r.prerelease.length){i="pre";var s="prerelease"}for(var o in e)if((o==="major"||o==="minor"||o==="patch")&&e[o]!==r[o])return i+o;return s}ve.compareIdentifiers=Mn;var Nf=/^[0-9]+$/;function Mn(n,t){var e=Nf.test(n),r=Nf.test(t);return e&&r&&(n=+n,t=+t),n===t?0:e&&!r?-1:r&&!e?1:n<t?-1:1}ve.rcompareIdentifiers=$u;function $u(n,t){return Mn(t,n)}ve.major=Xu;function Xu(n,t){return new Ke(n,t).major}ve.minor=ju;function ju(n,t){return new Ke(n,t).minor}ve.patch=Vu;function Vu(n,t){return new Ke(n,t).patch}ve.compare=pn;function pn(n,t,e){return new Ke(n,e).compare(new Ke(t,e))}ve.compareLoose=zu;function zu(n,t){return pn(n,t,!0)}ve.compareBuild=Ju;function Ju(n,t,e){var r=new Ke(n,e),i=new Ke(t,e);return r.compare(i)||r.compareBuild(i)}ve.rcompare=Zu;function Zu(n,t,e){return pn(t,n,e)}ve.sort=eh;function eh(n,t){return n.sort(function(e,r){return ve.compareBuild(e,r,t)})}ve.rsort=th;function th(n,t){return n.sort(function(e,r){return ve.compareBuild(r,e,t)})}ve.gt=Ur;function Ur(n,t,e){return pn(n,t,e)>0}ve.lt=Ei;function Ei(n,t,e){return pn(n,t,e)<0}ve.eq=Ss;function Ss(n,t,e){return pn(n,t,e)===0}ve.neq=Lf;function Lf(n,t,e){return pn(n,t,e)!==0}ve.gte=ws;function ws(n,t,e){return pn(n,t,e)>=0}ve.lte=ms;function ms(n,t,e){return pn(n,t,e)<=0}ve.cmp=_i;function _i(n,t,e,r){switch(t){case"===":return typeof n=="object"&&(n=n.version),typeof e=="object"&&(e=e.version),n===e;case"!==":return typeof n=="object"&&(n=n.version),typeof e=="object"&&(e=e.version),n!==e;case"":case"=":case"==":return Ss(n,e,r);case"!=":return Lf(n,e,r);case">":return Ur(n,e,r);case">=":return ws(n,e,r);case"<":return Ei(n,e,r);case"<=":return ms(n,e,r);default:throw new TypeError("Invalid operator: "+t)}}ve.Comparator=Jt;function Jt(n,t){if((!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1}),n instanceof Jt){if(n.loose===!!t.loose)return n;n=n.value}if(!(this instanceof Jt))return new Jt(n,t);n=n.trim().split(/\s+/).join(" "),ft("comparator",n,t),this.options=t,this.loose=!!t.loose,this.parse(n),this.semver===ir?this.value="":this.value=this.operator+this.semver.version,ft("comp",this)}var ir={};Jt.prototype.parse=function(n){var t=this.options.loose?ot[P.COMPARATORLOOSE]:ot[P.COMPARATOR],e=n.match(t);if(!e)throw new TypeError("Invalid comparator: "+n);this.operator=e[1]!==void 0?e[1]:"",this.operator==="="&&(this.operator=""),e[2]?this.semver=new Ke(e[2],this.options.loose):this.semver=ir};Jt.prototype.toString=function(){return this.value};Jt.prototype.test=function(n){if(ft("Comparator.test",n,this.options.loose),this.semver===ir||n===ir)return!0;if(typeof n=="string")try{n=new Ke(n,this.options)}catch{return!1}return _i(n,this.operator,this.semver,this.options)};Jt.prototype.intersects=function(n,t){if(!(n instanceof Jt))throw new TypeError("a Comparator is required");(!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1});var e;if(this.operator==="")return this.value===""?!0:(e=new Et(n.value,t),pi(this.value,e,t));if(n.operator==="")return n.value===""?!0:(e=new Et(this.value,t),pi(n.semver,e,t));var r=(this.operator===">="||this.operator===">")&&(n.operator===">="||n.operator===">"),i=(this.operator==="<="||this.operator==="<")&&(n.operator==="<="||n.operator==="<"),s=this.semver.version===n.semver.version,o=(this.operator===">="||this.operator==="<=")&&(n.operator===">="||n.operator==="<="),f=_i(this.semver,"<",n.semver,t)&&(this.operator===">="||this.operator===">")&&(n.operator==="<="||n.operator==="<"),a=_i(this.semver,">",n.semver,t)&&(this.operator==="<="||this.operator==="<")&&(n.operator===">="||n.operator===">");return r||i||s&&o||f||a};ve.Range=Et;function Et(n,t){if((!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1}),n instanceof Et)return n.loose===!!t.loose&&n.includePrerelease===!!t.includePrerelease?n:new Et(n.raw,t);if(n instanceof Jt)return new Et(n.value,t);if(!(this instanceof Et))return new Et(n,t);if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=n.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(function(e){return this.parseRange(e.trim())},this).filter(function(e){return e.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+this.raw);this.format()}Et.prototype.format=function(){return this.range=this.set.map(function(n){return n.join(" ").trim()}).join("||").trim(),this.range};Et.prototype.toString=function(){return this.range};Et.prototype.parseRange=function(n){var t=this.options.loose,e=t?ot[P.HYPHENRANGELOOSE]:ot[P.HYPHENRANGE];n=n.replace(e,hh),ft("hyphen replace",n),n=n.replace(ot[P.COMPARATORTRIM],qu),ft("comparator trim",n,ot[P.COMPARATORTRIM]),n=n.replace(ot[P.TILDETRIM],Fu),n=n.replace(ot[P.CARETTRIM],Mu),n=n.split(/\s+/).join(" ");var r=t?ot[P.COMPARATORLOOSE]:ot[P.COMPARATOR],i=n.split(" ").map(function(s){return rh(s,this.options)},this).join(" ").split(/\s+/);return this.options.loose&&(i=i.filter(function(s){return!!s.match(r)})),i=i.map(function(s){return new Jt(s,this.options)},this),i};Et.prototype.intersects=function(n,t){if(!(n instanceof Et))throw new TypeError("a Range is required");return this.set.some(function(e){return Tf(e,t)&&n.set.some(function(r){return Tf(r,t)&&e.every(function(i){return r.every(function(s){return i.intersects(s,t)})})})})};function Tf(n,t){for(var e=!0,r=n.slice(),i=r.pop();e&&r.length;)e=r.every(function(s){return i.intersects(s,t)}),i=r.pop();return e}ve.toComparators=nh;function nh(n,t){return new Et(n,t).set.map(function(e){return e.map(function(r){return r.value}).join(" ").trim().split(" ")})}function rh(n,t){return ft("comp",n,t),n=oh(n,t),ft("caret",n),n=ih(n,t),ft("tildes",n),n=ah(n,t),ft("xrange",n),n=uh(n,t),ft("stars",n),n}function Ht(n){return!n||n.toLowerCase()==="x"||n==="*"}function ih(n,t){return n.trim().split(/\s+/).map(function(e){return sh(e,t)}).join(" ")}function sh(n,t){var e=t.loose?ot[P.TILDELOOSE]:ot[P.TILDE];return n.replace(e,function(r,i,s,o,f){ft("tilde",n,r,i,s,o,f);var a;return Ht(i)?a="":Ht(s)?a=">="+i+".0.0 <"+(+i+1)+".0.0":Ht(o)?a=">="+i+"."+s+".0 <"+i+"."+(+s+1)+".0":f?(ft("replaceTilde pr",f),a=">="+i+"."+s+"."+o+"-"+f+" <"+i+"."+(+s+1)+".0"):a=">="+i+"."+s+"."+o+" <"+i+"."+(+s+1)+".0",ft("tilde return",a),a})}function oh(n,t){return n.trim().split(/\s+/).map(function(e){return fh(e,t)}).join(" ")}function fh(n,t){ft("caret",n,t);var e=t.loose?ot[P.CARETLOOSE]:ot[P.CARET];return n.replace(e,function(r,i,s,o,f){ft("caret",n,r,i,s,o,f);var a;return Ht(i)?a="":Ht(s)?a=">="+i+".0.0 <"+(+i+1)+".0.0":Ht(o)?i==="0"?a=">="+i+"."+s+".0 <"+i+"."+(+s+1)+".0":a=">="+i+"."+s+".0 <"+(+i+1)+".0.0":f?(ft("replaceCaret pr",f),i==="0"?s==="0"?a=">="+i+"."+s+"."+o+"-"+f+" <"+i+"."+s+"."+(+o+1):a=">="+i+"."+s+"."+o+"-"+f+" <"+i+"."+(+s+1)+".0":a=">="+i+"."+s+"."+o+"-"+f+" <"+(+i+1)+".0.0"):(ft("no pr"),i==="0"?s==="0"?a=">="+i+"."+s+"."+o+" <"+i+"."+s+"."+(+o+1):a=">="+i+"."+s+"."+o+" <"+i+"."+(+s+1)+".0":a=">="+i+"."+s+"."+o+" <"+(+i+1)+".0.0"),ft("caret return",a),a})}function ah(n,t){return ft("replaceXRanges",n,t),n.split(/\s+/).map(function(e){return ch(e,t)}).join(" ")}function ch(n,t){n=n.trim();var e=t.loose?ot[P.XRANGELOOSE]:ot[P.XRANGE];return n.replace(e,function(r,i,s,o,f,a){ft("xRange",n,r,i,s,o,f,a);var u=Ht(s),h=u||Ht(o),l=h||Ht(f),A=l;return i==="="&&A&&(i=""),a=t.includePrerelease?"-0":"",u?i===">"||i==="<"?r="<0.0.0-0":r="*":i&&A?(h&&(o=0),f=0,i===">"?(i=">=",h?(s=+s+1,o=0,f=0):(o=+o+1,f=0)):i==="<="&&(i="<",h?s=+s+1:o=+o+1),r=i+s+"."+o+"."+f+a):h?r=">="+s+".0.0"+a+" <"+(+s+1)+".0.0"+a:l&&(r=">="+s+"."+o+".0"+a+" <"+s+"."+(+o+1)+".0"+a),ft("xRange return",r),r})}function uh(n,t){return ft("replaceStars",n,t),n.trim().replace(ot[P.STAR],"")}function hh(n,t,e,r,i,s,o,f,a,u,h,l,A){return Ht(e)?t="":Ht(r)?t=">="+e+".0.0":Ht(i)?t=">="+e+"."+r+".0":t=">="+t,Ht(a)?f="":Ht(u)?f="<"+(+a+1)+".0.0":Ht(h)?f="<"+a+"."+(+u+1)+".0":l?f="<="+a+"."+u+"."+h+"-"+l:f="<="+f,(t+" "+f).trim()}Et.prototype.test=function(n){if(!n)return!1;if(typeof n=="string")try{n=new Ke(n,this.options)}catch{return!1}for(var t=0;t<this.set.length;t++)if(lh(this.set[t],n,this.options))return!0;return!1};function lh(n,t,e){for(var r=0;r<n.length;r++)if(!n[r].test(t))return!1;if(t.prerelease.length&&!e.includePrerelease){for(r=0;r<n.length;r++)if(ft(n[r].semver),n[r].semver!==ir&&n[r].semver.prerelease.length>0){var i=n[r].semver;if(i.major===t.major&&i.minor===t.minor&&i.patch===t.patch)return!0}return!1}return!0}ve.satisfies=pi;function pi(n,t,e){try{t=new Et(t,e)}catch{return!1}return t.test(n)}ve.maxSatisfying=dh;function dh(n,t,e){var r=null,i=null;try{var s=new Et(t,e)}catch{return null}return n.forEach(function(o){s.test(o)&&(!r||i.compare(o)===-1)&&(r=o,i=new Ke(r,e))}),r}ve.minSatisfying=Ah;function Ah(n,t,e){var r=null,i=null;try{var s=new Et(t,e)}catch{return null}return n.forEach(function(o){s.test(o)&&(!r||i.compare(o)===1)&&(r=o,i=new Ke(r,e))}),r}ve.minVersion=gh;function gh(n,t){n=new Et(n,t);var e=new Ke("0.0.0");if(n.test(e)||(e=new Ke("0.0.0-0"),n.test(e)))return e;e=null;for(var r=0;r<n.set.length;++r){var i=n.set[r];i.forEach(function(s){var o=new Ke(s.semver.version);switch(s.operator){case">":o.prerelease.length===0?o.patch++:o.prerelease.push(0),o.raw=o.format();case"":case">=":(!e||Ur(e,o))&&(e=o);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+s.operator)}})}return e&&n.test(e)?e:null}ve.validRange=Eh;function Eh(n,t){try{return new Et(n,t).range||"*"}catch{return null}}ve.ltr=_h;function _h(n,t,e){return Cs(n,t,"<",e)}ve.gtr=ph;function ph(n,t,e){return Cs(n,t,">",e)}ve.outside=Cs;function Cs(n,t,e,r){n=new Ke(n,r),t=new Et(t,r);var i,s,o,f,a;switch(e){case">":i=Ur,s=ms,o=Ei,f=">",a=">=";break;case"<":i=Ei,s=ws,o=Ur,f="<",a="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(pi(n,t,r))return!1;for(var u=0;u<t.set.length;++u){var h=t.set[u],l=null,A=null;if(h.forEach(function(_){_.semver===ir&&(_=new Jt(">=0.0.0")),l=l||_,A=A||_,i(_.semver,l.semver,r)?l=_:o(_.semver,A.semver,r)&&(A=_)}),l.operator===f||l.operator===a||(!A.operator||A.operator===f)&&s(n,A.semver))return!1;if(A.operator===a&&o(n,A.semver))return!1}return!0}ve.prerelease=bh;function bh(n,t){var e=qn(n,t);return e&&e.prerelease.length?e.prerelease:null}ve.intersects=Ih;function Ih(n,t,e){return n=new Et(n,e),t=new Et(t,e),n.intersects(t)}ve.coerce=xh;function xh(n,t){if(n instanceof Ke)return n;if(typeof n=="number"&&(n=String(n)),typeof n!="string")return null;t=t||{};var e=null;if(!t.rtl)e=n.match(ot[P.COERCE]);else{for(var r;(r=ot[P.COERCERTL].exec(n))&&(!e||e.index+e[0].length!==n.length);)(!e||r.index+r[0].length!==e.index+e[0].length)&&(e=r),ot[P.COERCERTL].lastIndex=r.index+r[1].length+r[2].length;ot[P.COERCERTL].lastIndex=-1}return e===null?null:qn(e[2]+"."+(e[3]||"0")+"."+(e[4]||"0"),t)}});var Mf=ze((BA,Bs)=>{"use strict";var bi=require("fs"),bn=require("path"),{promisify:Pf}=require("util"),yh=Uf(),Df=yh.satisfies(process.version,">=10.12.0"),Qf=n=>{if(process.platform==="win32"&&/[<>:"|?*]/.test(n.replace(bn.parse(n).root,""))){let e=new Error(`Path contains invalid characters: ${n}`);throw e.code="EINVAL",e}},Hf=n=>({...{mode:511,fs:bi},...n}),Ff=n=>{let t=new Error(`operation not permitted, mkdir '${n}'`);return t.code="EPERM",t.errno=-4048,t.path=n,t.syscall="mkdir",t},Sh=async(n,t)=>{Qf(n),t=Hf(t);let e=Pf(t.fs.mkdir),r=Pf(t.fs.stat);if(Df&&t.fs.mkdir===bi.mkdir){let s=bn.resolve(n);return await e(s,{mode:t.mode,recursive:!0}),s}let i=async s=>{try{return await e(s,t.mode),s}catch(o){if(o.code==="EPERM")throw o;if(o.code==="ENOENT"){if(bn.dirname(s)===s)throw Ff(s);if(o.message.includes("null bytes"))throw o;return await i(bn.dirname(s)),i(s)}try{if(!(await r(s)).isDirectory())throw new Error("The path is not a directory")}catch{throw o}return s}};return i(bn.resolve(n))};Bs.exports=Sh;Bs.exports.sync=(n,t)=>{if(Qf(n),t=Hf(t),Df&&t.fs.mkdirSync===bi.mkdirSync){let r=bn.resolve(n);return bi.mkdirSync(r,{mode:t.mode,recursive:!0}),r}let e=r=>{try{t.fs.mkdirSync(r,t.mode)}catch(i){if(i.code==="EPERM")throw i;if(i.code==="ENOENT"){if(bn.dirname(r)===r)throw Ff(r);if(i.message.includes("null bytes"))throw i;return e(bn.dirname(r)),e(r)}try{if(!t.fs.statSync(r).isDirectory())throw new Error("The path is not a directory")}catch{throw i}}return r};return e(bn.resolve(n))}});var Gf=ze((TA,Wf)=>{Wf.exports=mh;function mh(n){var t=[];return n.forEach(function(e){/^[A-Za-z0-9_\/-]+$/.test(e)||(e="'"+e.replace(/'/g,"'\\''")+"'",e=e.replace(/^(?:'')+/g,"").replace(/\\'''/g,"\\'")),t.push(e)}),t.join(" ")}});var Ii=ze((vA,Yf)=>{Yf.exports={newInvalidAsn1Error:function(n){var t=new Error;return t.name="InvalidAsn1Error",t.message=n||"",t}}});var xi=ze((LA,$f)=>{$f.exports={EOC:0,Boolean:1,Integer:2,BitString:3,OctetString:4,Null:5,OID:6,ObjectDescriptor:7,External:8,Real:9,Enumeration:10,PDV:11,Utf8String:12,RelativeOID:13,Sequence:16,Set:17,NumericString:18,PrintableString:19,T61String:20,VideotexString:21,IA5String:22,UTCTime:23,GeneralizedTime:24,GraphicString:25,VisibleString:26,GeneralString:28,UniversalString:29,CharacterString:30,BMPString:31,Constructor:32,Context:128}});var Ts=ze((OA,Xf)=>{"use strict";var yi=require("buffer"),or=yi.Buffer,Zt={},en;for(en in yi)yi.hasOwnProperty(en)&&(en==="SlowBuffer"||en==="Buffer"||(Zt[en]=yi[en]));var fr=Zt.Buffer={};for(en in or)or.hasOwnProperty(en)&&(en==="allocUnsafe"||en==="allocUnsafeSlow"||(fr[en]=or[en]));Zt.Buffer.prototype=or.prototype;(!fr.from||fr.from===Uint8Array.from)&&(fr.from=function(n,t,e){if(typeof n=="number")throw new TypeError('The "value" argument must not be of type number. Received type '+typeof n);if(n&&typeof n.length>"u")throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof n);return or(n,t,e)});fr.alloc||(fr.alloc=function(n,t,e){if(typeof n!="number")throw new TypeError('The "size" argument must be of type number. Received type '+typeof n);if(n<0||n>=2*(1<<30))throw new RangeError('The value "'+n+'" is invalid for option "size"');var r=or(n);return!t||t.length===0?r.fill(0):typeof e=="string"?r.fill(t,e):r.fill(t),r});if(!Zt.kStringMaxLength)try{Zt.kStringMaxLength=process.binding("buffer").kStringMaxLength}catch{}Zt.constants||(Zt.constants={MAX_LENGTH:Zt.kMaxLength},Zt.kStringMaxLength&&(Zt.constants.MAX_STRING_LENGTH=Zt.kStringMaxLength));Xf.exports=Zt});var zf=ze((UA,Vf)=>{var Ch=require("assert"),jf=Ts().Buffer,Dr=xi(),Bh=Ii(),ar=Bh.newInvalidAsn1Error;function Ft(n){if(!n||!jf.isBuffer(n))throw new TypeError("data must be a node Buffer");this._buf=n,this._size=n.length,this._len=0,this._offset=0}Object.defineProperty(Ft.prototype,"length",{enumerable:!0,get:function(){return this._len}});Object.defineProperty(Ft.prototype,"offset",{enumerable:!0,get:function(){return this._offset}});Object.defineProperty(Ft.prototype,"remain",{get:function(){return this._size-this._offset}});Object.defineProperty(Ft.prototype,"buffer",{get:function(){return this._buf.slice(this._offset)}});Ft.prototype.readByte=function(n){if(this._size-this._offset<1)return null;var t=this._buf[this._offset]&255;return n||(this._offset+=1),t};Ft.prototype.peek=function(){return this.readByte(!0)};Ft.prototype.readLength=function(n){if(n===void 0&&(n=this._offset),n>=this._size)return null;var t=this._buf[n++]&255;if(t===null)return null;if((t&128)===128){if(t&=127,t===0)throw ar("Indefinite length not supported");if(t>4)throw ar("encoding too long");if(this._size-n<t)return null;this._len=0;for(var e=0;e<t;e++)this._len=(this._len<<8)+(this._buf[n++]&255)}else this._len=t;return n};Ft.prototype.readSequence=function(n){var t=this.peek();if(t===null)return null;if(n!==void 0&&n!==t)throw ar("Expected 0x"+n.toString(16)+": got 0x"+t.toString(16));var e=this.readLength(this._offset+1);return e===null?null:(this._offset=e,t)};Ft.prototype.readInt=function(){return this._readTag(Dr.Integer)};Ft.prototype.readBoolean=function(){return this._readTag(Dr.Boolean)!==0};Ft.prototype.readEnumeration=function(){return this._readTag(Dr.Enumeration)};Ft.prototype.readString=function(n,t){n||(n=Dr.OctetString);var e=this.peek();if(e===null)return null;if(e!==n)throw ar("Expected 0x"+n.toString(16)+": got 0x"+e.toString(16));var r=this.readLength(this._offset+1);if(r===null||this.length>this._size-r)return null;if(this._offset=r,this.length===0)return t?jf.alloc(0):"";var i=this._buf.slice(this._offset,this._offset+this.length);return this._offset+=this.length,t?i:i.toString("utf8")};Ft.prototype.readOID=function(n){n||(n=Dr.OID);var t=this.readString(n,!0);if(t===null)return null;for(var e=[],r=0,i=0;i<t.length;i++){var s=t[i]&255;r<<=7,r+=s&127,s&128||(e.push(r),r=0)}return r=e.shift(),e.unshift(r%40),e.unshift(r/40>>0),e.join(".")};Ft.prototype._readTag=function(n){Ch.ok(n!==void 0);var t=this.peek();if(t===null)return null;if(t!==n)throw ar("Expected 0x"+n.toString(16)+": got 0x"+t.toString(16));var e=this.readLength(this._offset+1);if(e===null)return null;if(this.length>4)throw ar("Integer too long: "+this.length);if(this.length>this._size-e)return null;this._offset=e;for(var r=this._buf[this._offset],i=0,s=0;s<this.length;s++)i<<=8,i|=this._buf[this._offset++]&255;return(r&128)===128&&s!==4&&(i-=1<<s*8),i>>0};Vf.exports=Ft});var Zf=ze((PA,Jf)=>{var Bn=require("assert"),Si=Ts().Buffer,Rn=xi(),Rh=Ii(),wi=Rh.newInvalidAsn1Error,kh={size:1024,growthFactor:8};function Nh(n,t){Bn.ok(n),Bn.equal(typeof n,"object"),Bn.ok(t),Bn.equal(typeof t,"object");var e=Object.getOwnPropertyNames(n);return e.forEach(function(r){if(!t[r]){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i)}}),t}function Pt(n){n=Nh(kh,n||{}),this._buf=Si.alloc(n.size||1024),this._size=this._buf.length,this._offset=0,this._options=n,this._seq=[]}Object.defineProperty(Pt.prototype,"buffer",{get:function(){if(this._seq.length)throw wi(this._seq.length+" unended sequence(s)");return this._buf.slice(0,this._offset)}});Pt.prototype.writeByte=function(n){if(typeof n!="number")throw new TypeError("argument must be a Number");this._ensure(1),this._buf[this._offset++]=n};Pt.prototype.writeInt=function(n,t){if(typeof n!="number")throw new TypeError("argument must be a Number");typeof t!="number"&&(t=Rn.Integer);for(var e=4;(!(n&4286578688)||(n&4286578688)===-8388608)&&e>1;)e--,n<<=8;if(e>4)throw wi("BER ints cannot be > 0xffffffff");for(this._ensure(2+e),this._buf[this._offset++]=t,this._buf[this._offset++]=e;e-- >0;)this._buf[this._offset++]=(n&4278190080)>>>24,n<<=8};Pt.prototype.writeNull=function(){this.writeByte(Rn.Null),this.writeByte(0)};Pt.prototype.writeEnumeration=function(n,t){if(typeof n!="number")throw new TypeError("argument must be a Number");return typeof t!="number"&&(t=Rn.Enumeration),this.writeInt(n,t)};Pt.prototype.writeBoolean=function(n,t){if(typeof n!="boolean")throw new TypeError("argument must be a Boolean");typeof t!="number"&&(t=Rn.Boolean),this._ensure(3),this._buf[this._offset++]=t,this._buf[this._offset++]=1,this._buf[this._offset++]=n?255:0};Pt.prototype.writeString=function(n,t){if(typeof n!="string")throw new TypeError("argument must be a string (was: "+typeof n+")");typeof t!="number"&&(t=Rn.OctetString);var e=Si.byteLength(n);this.writeByte(t),this.writeLength(e),e&&(this._ensure(e),this._buf.write(n,this._offset),this._offset+=e)};Pt.prototype.writeBuffer=function(n,t){if(typeof t!="number")throw new TypeError("tag must be a number");if(!Si.isBuffer(n))throw new TypeError("argument must be a buffer");this.writeByte(t),this.writeLength(n.length),this._ensure(n.length),n.copy(this._buf,this._offset,0,n.length),this._offset+=n.length};Pt.prototype.writeStringArray=function(n){if(!n instanceof Array)throw new TypeError("argument must be an Array[String]");var t=this;n.forEach(function(e){t.writeString(e)})};Pt.prototype.writeOID=function(n,t){if(typeof n!="string")throw new TypeError("argument must be a string");if(typeof t!="number"&&(t=Rn.OID),!/^([0-9]+\.){3,}[0-9]+$/.test(n))throw new Error("argument is not a valid OID string");function e(o,f){f<128?o.push(f):f<16384?(o.push(f>>>7|128),o.push(f&127)):f<2097152?(o.push(f>>>14|128),o.push((f>>>7|128)&255),o.push(f&127)):f<268435456?(o.push(f>>>21|128),o.push((f>>>14|128)&255),o.push((f>>>7|128)&255),o.push(f&127)):(o.push((f>>>28|128)&255),o.push((f>>>21|128)&255),o.push((f>>>14|128)&255),o.push((f>>>7|128)&255),o.push(f&127))}var r=n.split("."),i=[];i.push(parseInt(r[0],10)*40+parseInt(r[1],10)),r.slice(2).forEach(function(o){e(i,parseInt(o,10))});var s=this;this._ensure(2+i.length),this.writeByte(t),this.writeLength(i.length),i.forEach(function(o){s.writeByte(o)})};Pt.prototype.writeLength=function(n){if(typeof n!="number")throw new TypeError("argument must be a Number");if(this._ensure(4),n<=127)this._buf[this._offset++]=n;else if(n<=255)this._buf[this._offset++]=129,this._buf[this._offset++]=n;else if(n<=65535)this._buf[this._offset++]=130,this._buf[this._offset++]=n>>8,this._buf[this._offset++]=n;else if(n<=16777215)this._buf[this._offset++]=131,this._buf[this._offset++]=n>>16,this._buf[this._offset++]=n>>8,this._buf[this._offset++]=n;else throw wi("Length too long (> 4 bytes)")};Pt.prototype.startSequence=function(n){typeof n!="number"&&(n=Rn.Sequence|Rn.Constructor),this.writeByte(n),this._seq.push(this._offset),this._ensure(3),this._offset+=3};Pt.prototype.endSequence=function(){var n=this._seq.pop(),t=n+3,e=this._offset-t;if(e<=127)this._shift(t,e,-2),this._buf[n]=e;else if(e<=255)this._shift(t,e,-1),this._buf[n]=129,this._buf[n+1]=e;else if(e<=65535)this._buf[n]=130,this._buf[n+1]=e>>8,this._buf[n+2]=e;else if(e<=16777215)this._shift(t,e,1),this._buf[n]=131,this._buf[n+1]=e>>16,this._buf[n+2]=e>>8,this._buf[n+3]=e;else throw wi("Sequence too long")};Pt.prototype._shift=function(n,t,e){Bn.ok(n!==void 0),Bn.ok(t!==void 0),Bn.ok(e),this._buf.copy(this._buf,n+e,n,n+t),this._offset+=e};Pt.prototype._ensure=function(n){if(Bn.ok(n),this._size-this._offset<n){var t=this._size*this._options.growthFactor;t-this._offset<n&&(t+=n);var e=Si.alloc(t);this._buf.copy(e,0,0,this._offset),this._buf=e,this._size=t}};Jf.exports=Pt});var ea=ze((DA,Bi)=>{var vs=Ii(),Ls=xi(),Th=zf(),vh=Zf();Bi.exports={Reader:Th,Writer:vh};for(mi in Ls)Ls.hasOwnProperty(mi)&&(Bi.exports[mi]=Ls[mi]);var mi;for(Ci in vs)vs.hasOwnProperty(Ci)&&(Bi.exports[Ci]=vs[Ci]);var Ci});var Qr=ze((QA,ta)=>{var Os=ea();ta.exports={Ber:Os,BerReader:Os.Reader,BerWriter:Os.Writer}});var na=ze((HA,Ri)=>{(function(n){"use strict";var t=function(d){var E,g=new Float64Array(16);if(d)for(E=0;E<d.length;E++)g[E]=d[E];return g},e=function(){throw new Error("no PRNG")},r=new Uint8Array(16),i=new Uint8Array(32);i[0]=9;var s=t(),o=t([1]),f=t([56129,1]),a=t([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),u=t([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),h=t([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),l=t([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),A=t([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function _(d,E,g,c){d[E]=g>>24&255,d[E+1]=g>>16&255,d[E+2]=g>>8&255,d[E+3]=g&255,d[E+4]=c>>24&255,d[E+5]=c>>16&255,d[E+6]=c>>8&255,d[E+7]=c&255}function x(d,E,g,c,p){var B,N=0;for(B=0;B<p;B++)N|=d[E+B]^g[c+B];return(1&N-1>>>8)-1}function b(d,E,g,c){return x(d,E,g,c,16)}function w(d,E,g,c){return x(d,E,g,c,32)}function C(d,E,g,c){for(var p=c[0]&255|(c[1]&255)<<8|(c[2]&255)<<16|(c[3]&255)<<24,B=g[0]&255|(g[1]&255)<<8|(g[2]&255)<<16|(g[3]&255)<<24,N=g[4]&255|(g[5]&255)<<8|(g[6]&255)<<16|(g[7]&255)<<24,G=g[8]&255|(g[9]&255)<<8|(g[10]&255)<<16|(g[11]&255)<<24,ie=g[12]&255|(g[13]&255)<<8|(g[14]&255)<<16|(g[15]&255)<<24,le=c[4]&255|(c[5]&255)<<8|(c[6]&255)<<16|(c[7]&255)<<24,ce=E[0]&255|(E[1]&255)<<8|(E[2]&255)<<16|(E[3]&255)<<24,tt=E[4]&255|(E[5]&255)<<8|(E[6]&255)<<16|(E[7]&255)<<24,he=E[8]&255|(E[9]&255)<<8|(E[10]&255)<<16|(E[11]&255)<<24,Te=E[12]&255|(E[13]&255)<<8|(E[14]&255)<<16|(E[15]&255)<<24,Le=c[8]&255|(c[9]&255)<<8|(c[10]&255)<<16|(c[11]&255)<<24,Qe=g[16]&255|(g[17]&255)<<8|(g[18]&255)<<16|(g[19]&255)<<24,De=g[20]&255|(g[21]&255)<<8|(g[22]&255)<<16|(g[23]&255)<<24,Oe=g[24]&255|(g[25]&255)<<8|(g[26]&255)<<16|(g[27]&255)<<24,Pe=g[28]&255|(g[29]&255)<<8|(g[30]&255)<<16|(g[31]&255)<<24,Ue=c[12]&255|(c[13]&255)<<8|(c[14]&255)<<16|(c[15]&255)<<24,de=p,be=B,ue=N,ge=G,_e=ie,ae=le,U=ce,D=tt,j=he,W=Te,Y=Le,ee=Qe,me=De,He=Oe,Me=Pe,Fe=Ue,I,We=0;We<20;We+=2)I=de+me|0,_e^=I<<7|I>>>32-7,I=_e+de|0,j^=I<<9|I>>>32-9,I=j+_e|0,me^=I<<13|I>>>32-13,I=me+j|0,de^=I<<18|I>>>32-18,I=ae+be|0,W^=I<<7|I>>>32-7,I=W+ae|0,He^=I<<9|I>>>32-9,I=He+W|0,be^=I<<13|I>>>32-13,I=be+He|0,ae^=I<<18|I>>>32-18,I=Y+U|0,Me^=I<<7|I>>>32-7,I=Me+Y|0,ue^=I<<9|I>>>32-9,I=ue+Me|0,U^=I<<13|I>>>32-13,I=U+ue|0,Y^=I<<18|I>>>32-18,I=Fe+ee|0,ge^=I<<7|I>>>32-7,I=ge+Fe|0,D^=I<<9|I>>>32-9,I=D+ge|0,ee^=I<<13|I>>>32-13,I=ee+D|0,Fe^=I<<18|I>>>32-18,I=de+ge|0,be^=I<<7|I>>>32-7,I=be+de|0,ue^=I<<9|I>>>32-9,I=ue+be|0,ge^=I<<13|I>>>32-13,I=ge+ue|0,de^=I<<18|I>>>32-18,I=ae+_e|0,U^=I<<7|I>>>32-7,I=U+ae|0,D^=I<<9|I>>>32-9,I=D+U|0,_e^=I<<13|I>>>32-13,I=_e+D|0,ae^=I<<18|I>>>32-18,I=Y+W|0,ee^=I<<7|I>>>32-7,I=ee+Y|0,j^=I<<9|I>>>32-9,I=j+ee|0,W^=I<<13|I>>>32-13,I=W+j|0,Y^=I<<18|I>>>32-18,I=Fe+Me|0,me^=I<<7|I>>>32-7,I=me+Fe|0,He^=I<<9|I>>>32-9,I=He+me|0,Me^=I<<13|I>>>32-13,I=Me+He|0,Fe^=I<<18|I>>>32-18;de=de+p|0,be=be+B|0,ue=ue+N|0,ge=ge+G|0,_e=_e+ie|0,ae=ae+le|0,U=U+ce|0,D=D+tt|0,j=j+he|0,W=W+Te|0,Y=Y+Le|0,ee=ee+Qe|0,me=me+De|0,He=He+Oe|0,Me=Me+Pe|0,Fe=Fe+Ue|0,d[0]=de>>>0&255,d[1]=de>>>8&255,d[2]=de>>>16&255,d[3]=de>>>24&255,d[4]=be>>>0&255,d[5]=be>>>8&255,d[6]=be>>>16&255,d[7]=be>>>24&255,d[8]=ue>>>0&255,d[9]=ue>>>8&255,d[10]=ue>>>16&255,d[11]=ue>>>24&255,d[12]=ge>>>0&255,d[13]=ge>>>8&255,d[14]=ge>>>16&255,d[15]=ge>>>24&255,d[16]=_e>>>0&255,d[17]=_e>>>8&255,d[18]=_e>>>16&255,d[19]=_e>>>24&255,d[20]=ae>>>0&255,d[21]=ae>>>8&255,d[22]=ae>>>16&255,d[23]=ae>>>24&255,d[24]=U>>>0&255,d[25]=U>>>8&255,d[26]=U>>>16&255,d[27]=U>>>24&255,d[28]=D>>>0&255,d[29]=D>>>8&255,d[30]=D>>>16&255,d[31]=D>>>24&255,d[32]=j>>>0&255,d[33]=j>>>8&255,d[34]=j>>>16&255,d[35]=j>>>24&255,d[36]=W>>>0&255,d[37]=W>>>8&255,d[38]=W>>>16&255,d[39]=W>>>24&255,d[40]=Y>>>0&255,d[41]=Y>>>8&255,d[42]=Y>>>16&255,d[43]=Y>>>24&255,d[44]=ee>>>0&255,d[45]=ee>>>8&255,d[46]=ee>>>16&255,d[47]=ee>>>24&255,d[48]=me>>>0&255,d[49]=me>>>8&255,d[50]=me>>>16&255,d[51]=me>>>24&255,d[52]=He>>>0&255,d[53]=He>>>8&255,d[54]=He>>>16&255,d[55]=He>>>24&255,d[56]=Me>>>0&255,d[57]=Me>>>8&255,d[58]=Me>>>16&255,d[59]=Me>>>24&255,d[60]=Fe>>>0&255,d[61]=Fe>>>8&255,d[62]=Fe>>>16&255,d[63]=Fe>>>24&255}function v(d,E,g,c){for(var p=c[0]&255|(c[1]&255)<<8|(c[2]&255)<<16|(c[3]&255)<<24,B=g[0]&255|(g[1]&255)<<8|(g[2]&255)<<16|(g[3]&255)<<24,N=g[4]&255|(g[5]&255)<<8|(g[6]&255)<<16|(g[7]&255)<<24,G=g[8]&255|(g[9]&255)<<8|(g[10]&255)<<16|(g[11]&255)<<24,ie=g[12]&255|(g[13]&255)<<8|(g[14]&255)<<16|(g[15]&255)<<24,le=c[4]&255|(c[5]&255)<<8|(c[6]&255)<<16|(c[7]&255)<<24,ce=E[0]&255|(E[1]&255)<<8|(E[2]&255)<<16|(E[3]&255)<<24,tt=E[4]&255|(E[5]&255)<<8|(E[6]&255)<<16|(E[7]&255)<<24,he=E[8]&255|(E[9]&255)<<8|(E[10]&255)<<16|(E[11]&255)<<24,Te=E[12]&255|(E[13]&255)<<8|(E[14]&255)<<16|(E[15]&255)<<24,Le=c[8]&255|(c[9]&255)<<8|(c[10]&255)<<16|(c[11]&255)<<24,Qe=g[16]&255|(g[17]&255)<<8|(g[18]&255)<<16|(g[19]&255)<<24,De=g[20]&255|(g[21]&255)<<8|(g[22]&255)<<16|(g[23]&255)<<24,Oe=g[24]&255|(g[25]&255)<<8|(g[26]&255)<<16|(g[27]&255)<<24,Pe=g[28]&255|(g[29]&255)<<8|(g[30]&255)<<16|(g[31]&255)<<24,Ue=c[12]&255|(c[13]&255)<<8|(c[14]&255)<<16|(c[15]&255)<<24,de=p,be=B,ue=N,ge=G,_e=ie,ae=le,U=ce,D=tt,j=he,W=Te,Y=Le,ee=Qe,me=De,He=Oe,Me=Pe,Fe=Ue,I,We=0;We<20;We+=2)I=de+me|0,_e^=I<<7|I>>>32-7,I=_e+de|0,j^=I<<9|I>>>32-9,I=j+_e|0,me^=I<<13|I>>>32-13,I=me+j|0,de^=I<<18|I>>>32-18,I=ae+be|0,W^=I<<7|I>>>32-7,I=W+ae|0,He^=I<<9|I>>>32-9,I=He+W|0,be^=I<<13|I>>>32-13,I=be+He|0,ae^=I<<18|I>>>32-18,I=Y+U|0,Me^=I<<7|I>>>32-7,I=Me+Y|0,ue^=I<<9|I>>>32-9,I=ue+Me|0,U^=I<<13|I>>>32-13,I=U+ue|0,Y^=I<<18|I>>>32-18,I=Fe+ee|0,ge^=I<<7|I>>>32-7,I=ge+Fe|0,D^=I<<9|I>>>32-9,I=D+ge|0,ee^=I<<13|I>>>32-13,I=ee+D|0,Fe^=I<<18|I>>>32-18,I=de+ge|0,be^=I<<7|I>>>32-7,I=be+de|0,ue^=I<<9|I>>>32-9,I=ue+be|0,ge^=I<<13|I>>>32-13,I=ge+ue|0,de^=I<<18|I>>>32-18,I=ae+_e|0,U^=I<<7|I>>>32-7,I=U+ae|0,D^=I<<9|I>>>32-9,I=D+U|0,_e^=I<<13|I>>>32-13,I=_e+D|0,ae^=I<<18|I>>>32-18,I=Y+W|0,ee^=I<<7|I>>>32-7,I=ee+Y|0,j^=I<<9|I>>>32-9,I=j+ee|0,W^=I<<13|I>>>32-13,I=W+j|0,Y^=I<<18|I>>>32-18,I=Fe+Me|0,me^=I<<7|I>>>32-7,I=me+Fe|0,He^=I<<9|I>>>32-9,I=He+me|0,Me^=I<<13|I>>>32-13,I=Me+He|0,Fe^=I<<18|I>>>32-18;d[0]=de>>>0&255,d[1]=de>>>8&255,d[2]=de>>>16&255,d[3]=de>>>24&255,d[4]=ae>>>0&255,d[5]=ae>>>8&255,d[6]=ae>>>16&255,d[7]=ae>>>24&255,d[8]=Y>>>0&255,d[9]=Y>>>8&255,d[10]=Y>>>16&255,d[11]=Y>>>24&255,d[12]=Fe>>>0&255,d[13]=Fe>>>8&255,d[14]=Fe>>>16&255,d[15]=Fe>>>24&255,d[16]=U>>>0&255,d[17]=U>>>8&255,d[18]=U>>>16&255,d[19]=U>>>24&255,d[20]=D>>>0&255,d[21]=D>>>8&255,d[22]=D>>>16&255,d[23]=D>>>24&255,d[24]=j>>>0&255,d[25]=j>>>8&255,d[26]=j>>>16&255,d[27]=j>>>24&255,d[28]=W>>>0&255,d[29]=W>>>8&255,d[30]=W>>>16&255,d[31]=W>>>24&255}function X(d,E,g,c){C(d,E,g,c)}function L(d,E,g,c){v(d,E,g,c)}var z=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function ne(d,E,g,c,p,B,N){var G=new Uint8Array(16),ie=new Uint8Array(64),le,ce;for(ce=0;ce<16;ce++)G[ce]=0;for(ce=0;ce<8;ce++)G[ce]=B[ce];for(;p>=64;){for(X(ie,G,N,z),ce=0;ce<64;ce++)d[E+ce]=g[c+ce]^ie[ce];for(le=1,ce=8;ce<16;ce++)le=le+(G[ce]&255)|0,G[ce]=le&255,le>>>=8;p-=64,E+=64,c+=64}if(p>0)for(X(ie,G,N,z),ce=0;ce<p;ce++)d[E+ce]=g[c+ce]^ie[ce];return 0}function J(d,E,g,c,p){var B=new Uint8Array(16),N=new Uint8Array(64),G,ie;for(ie=0;ie<16;ie++)B[ie]=0;for(ie=0;ie<8;ie++)B[ie]=c[ie];for(;g>=64;){for(X(N,B,p,z),ie=0;ie<64;ie++)d[E+ie]=N[ie];for(G=1,ie=8;ie<16;ie++)G=G+(B[ie]&255)|0,B[ie]=G&255,G>>>=8;g-=64,E+=64}if(g>0)for(X(N,B,p,z),ie=0;ie<g;ie++)d[E+ie]=N[ie];return 0}function y(d,E,g,c,p){var B=new Uint8Array(32);L(B,c,p,z);for(var N=new Uint8Array(8),G=0;G<8;G++)N[G]=c[G+16];return J(d,E,g,N,B)}function S(d,E,g,c,p,B,N){var G=new Uint8Array(32);L(G,B,N,z);for(var ie=new Uint8Array(8),le=0;le<8;le++)ie[le]=B[le+16];return ne(d,E,g,c,p,ie,G)}var O=function(d){this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0;var E,g,c,p,B,N,G,ie;E=d[0]&255|(d[1]&255)<<8,this.r[0]=E&8191,g=d[2]&255|(d[3]&255)<<8,this.r[1]=(E>>>13|g<<3)&8191,c=d[4]&255|(d[5]&255)<<8,this.r[2]=(g>>>10|c<<6)&7939,p=d[6]&255|(d[7]&255)<<8,this.r[3]=(c>>>7|p<<9)&8191,B=d[8]&255|(d[9]&255)<<8,this.r[4]=(p>>>4|B<<12)&255,this.r[5]=B>>>1&8190,N=d[10]&255|(d[11]&255)<<8,this.r[6]=(B>>>14|N<<2)&8191,G=d[12]&255|(d[13]&255)<<8,this.r[7]=(N>>>11|G<<5)&8065,ie=d[14]&255|(d[15]&255)<<8,this.r[8]=(G>>>8|ie<<8)&8191,this.r[9]=ie>>>5&127,this.pad[0]=d[16]&255|(d[17]&255)<<8,this.pad[1]=d[18]&255|(d[19]&255)<<8,this.pad[2]=d[20]&255|(d[21]&255)<<8,this.pad[3]=d[22]&255|(d[23]&255)<<8,this.pad[4]=d[24]&255|(d[25]&255)<<8,this.pad[5]=d[26]&255|(d[27]&255)<<8,this.pad[6]=d[28]&255|(d[29]&255)<<8,this.pad[7]=d[30]&255|(d[31]&255)<<8};O.prototype.blocks=function(d,E,g){for(var c=this.fin?0:2048,p,B,N,G,ie,le,ce,tt,he,Te,Le,Qe,De,Oe,Pe,Ue,de,be,ue,ge=this.h[0],_e=this.h[1],ae=this.h[2],U=this.h[3],D=this.h[4],j=this.h[5],W=this.h[6],Y=this.h[7],ee=this.h[8],me=this.h[9],He=this.r[0],Me=this.r[1],Fe=this.r[2],I=this.r[3],We=this.r[4],nt=this.r[5],rt=this.r[6],qe=this.r[7],Je=this.r[8],Ze=this.r[9];g>=16;)p=d[E+0]&255|(d[E+1]&255)<<8,ge+=p&8191,B=d[E+2]&255|(d[E+3]&255)<<8,_e+=(p>>>13|B<<3)&8191,N=d[E+4]&255|(d[E+5]&255)<<8,ae+=(B>>>10|N<<6)&8191,G=d[E+6]&255|(d[E+7]&255)<<8,U+=(N>>>7|G<<9)&8191,ie=d[E+8]&255|(d[E+9]&255)<<8,D+=(G>>>4|ie<<12)&8191,j+=ie>>>1&8191,le=d[E+10]&255|(d[E+11]&255)<<8,W+=(ie>>>14|le<<2)&8191,ce=d[E+12]&255|(d[E+13]&255)<<8,Y+=(le>>>11|ce<<5)&8191,tt=d[E+14]&255|(d[E+15]&255)<<8,ee+=(ce>>>8|tt<<8)&8191,me+=tt>>>5|c,he=0,Te=he,Te+=ge*He,Te+=_e*(5*Ze),Te+=ae*(5*Je),Te+=U*(5*qe),Te+=D*(5*rt),he=Te>>>13,Te&=8191,Te+=j*(5*nt),Te+=W*(5*We),Te+=Y*(5*I),Te+=ee*(5*Fe),Te+=me*(5*Me),he+=Te>>>13,Te&=8191,Le=he,Le+=ge*Me,Le+=_e*He,Le+=ae*(5*Ze),Le+=U*(5*Je),Le+=D*(5*qe),he=Le>>>13,Le&=8191,Le+=j*(5*rt),Le+=W*(5*nt),Le+=Y*(5*We),Le+=ee*(5*I),Le+=me*(5*Fe),he+=Le>>>13,Le&=8191,Qe=he,Qe+=ge*Fe,Qe+=_e*Me,Qe+=ae*He,Qe+=U*(5*Ze),Qe+=D*(5*Je),he=Qe>>>13,Qe&=8191,Qe+=j*(5*qe),Qe+=W*(5*rt),Qe+=Y*(5*nt),Qe+=ee*(5*We),Qe+=me*(5*I),he+=Qe>>>13,Qe&=8191,De=he,De+=ge*I,De+=_e*Fe,De+=ae*Me,De+=U*He,De+=D*(5*Ze),he=De>>>13,De&=8191,De+=j*(5*Je),De+=W*(5*qe),De+=Y*(5*rt),De+=ee*(5*nt),De+=me*(5*We),he+=De>>>13,De&=8191,Oe=he,Oe+=ge*We,Oe+=_e*I,Oe+=ae*Fe,Oe+=U*Me,Oe+=D*He,he=Oe>>>13,Oe&=8191,Oe+=j*(5*Ze),Oe+=W*(5*Je),Oe+=Y*(5*qe),Oe+=ee*(5*rt),Oe+=me*(5*nt),he+=Oe>>>13,Oe&=8191,Pe=he,Pe+=ge*nt,Pe+=_e*We,Pe+=ae*I,Pe+=U*Fe,Pe+=D*Me,he=Pe>>>13,Pe&=8191,Pe+=j*He,Pe+=W*(5*Ze),Pe+=Y*(5*Je),Pe+=ee*(5*qe),Pe+=me*(5*rt),he+=Pe>>>13,Pe&=8191,Ue=he,Ue+=ge*rt,Ue+=_e*nt,Ue+=ae*We,Ue+=U*I,Ue+=D*Fe,he=Ue>>>13,Ue&=8191,Ue+=j*Me,Ue+=W*He,Ue+=Y*(5*Ze),Ue+=ee*(5*Je),Ue+=me*(5*qe),he+=Ue>>>13,Ue&=8191,de=he,de+=ge*qe,de+=_e*rt,de+=ae*nt,de+=U*We,de+=D*I,he=de>>>13,de&=8191,de+=j*Fe,de+=W*Me,de+=Y*He,de+=ee*(5*Ze),de+=me*(5*Je),he+=de>>>13,de&=8191,be=he,be+=ge*Je,be+=_e*qe,be+=ae*rt,be+=U*nt,be+=D*We,he=be>>>13,be&=8191,be+=j*I,be+=W*Fe,be+=Y*Me,be+=ee*He,be+=me*(5*Ze),he+=be>>>13,be&=8191,ue=he,ue+=ge*Ze,ue+=_e*Je,ue+=ae*qe,ue+=U*rt,ue+=D*nt,he=ue>>>13,ue&=8191,ue+=j*We,ue+=W*I,ue+=Y*Fe,ue+=ee*Me,ue+=me*He,he+=ue>>>13,ue&=8191,he=(he<<2)+he|0,he=he+Te|0,Te=he&8191,he=he>>>13,Le+=he,ge=Te,_e=Le,ae=Qe,U=De,D=Oe,j=Pe,W=Ue,Y=de,ee=be,me=ue,E+=16,g-=16;this.h[0]=ge,this.h[1]=_e,this.h[2]=ae,this.h[3]=U,this.h[4]=D,this.h[5]=j,this.h[6]=W,this.h[7]=Y,this.h[8]=ee,this.h[9]=me},O.prototype.finish=function(d,E){var g=new Uint16Array(10),c,p,B,N;if(this.leftover){for(N=this.leftover,this.buffer[N++]=1;N<16;N++)this.buffer[N]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(c=this.h[1]>>>13,this.h[1]&=8191,N=2;N<10;N++)this.h[N]+=c,c=this.h[N]>>>13,this.h[N]&=8191;for(this.h[0]+=c*5,c=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=c,c=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=c,g[0]=this.h[0]+5,c=g[0]>>>13,g[0]&=8191,N=1;N<10;N++)g[N]=this.h[N]+c,c=g[N]>>>13,g[N]&=8191;for(g[9]-=1<<13,p=(c^1)-1,N=0;N<10;N++)g[N]&=p;for(p=~p,N=0;N<10;N++)this.h[N]=this.h[N]&p|g[N];for(this.h[0]=(this.h[0]|this.h[1]<<13)&65535,this.h[1]=(this.h[1]>>>3|this.h[2]<<10)&65535,this.h[2]=(this.h[2]>>>6|this.h[3]<<7)&65535,this.h[3]=(this.h[3]>>>9|this.h[4]<<4)&65535,this.h[4]=(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14)&65535,this.h[5]=(this.h[6]>>>2|this.h[7]<<11)&65535,this.h[6]=(this.h[7]>>>5|this.h[8]<<8)&65535,this.h[7]=(this.h[8]>>>8|this.h[9]<<5)&65535,B=this.h[0]+this.pad[0],this.h[0]=B&65535,N=1;N<8;N++)B=(this.h[N]+this.pad[N]|0)+(B>>>16)|0,this.h[N]=B&65535;d[E+0]=this.h[0]>>>0&255,d[E+1]=this.h[0]>>>8&255,d[E+2]=this.h[1]>>>0&255,d[E+3]=this.h[1]>>>8&255,d[E+4]=this.h[2]>>>0&255,d[E+5]=this.h[2]>>>8&255,d[E+6]=this.h[3]>>>0&255,d[E+7]=this.h[3]>>>8&255,d[E+8]=this.h[4]>>>0&255,d[E+9]=this.h[4]>>>8&255,d[E+10]=this.h[5]>>>0&255,d[E+11]=this.h[5]>>>8&255,d[E+12]=this.h[6]>>>0&255,d[E+13]=this.h[6]>>>8&255,d[E+14]=this.h[7]>>>0&255,d[E+15]=this.h[7]>>>8&255},O.prototype.update=function(d,E,g){var c,p;if(this.leftover){for(p=16-this.leftover,p>g&&(p=g),c=0;c<p;c++)this.buffer[this.leftover+c]=d[E+c];if(g-=p,E+=p,this.leftover+=p,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(g>=16&&(p=g-g%16,this.blocks(d,E,p),E+=p,g-=p),g){for(c=0;c<g;c++)this.buffer[this.leftover+c]=d[E+c];this.leftover+=g}};function q(d,E,g,c,p,B){var N=new O(B);return N.update(g,c,p),N.finish(d,E),0}function H(d,E,g,c,p,B){var N=new Uint8Array(16);return q(N,0,g,c,p,B),b(d,E,N,0)}function se(d,E,g,c,p){var B;if(g<32)return-1;for(S(d,0,E,0,g,c,p),q(d,16,d,32,g-32,d),B=0;B<16;B++)d[B]=0;return 0}function te(d,E,g,c,p){var B,N=new Uint8Array(32);if(g<32||(y(N,0,32,c,p),H(E,16,E,32,g-32,N)!==0))return-1;for(S(d,0,E,0,g,c,p),B=0;B<32;B++)d[B]=0;return 0}function Z(d,E){var g;for(g=0;g<16;g++)d[g]=E[g]|0}function re(d){var E,g,c=1;for(E=0;E<16;E++)g=d[E]+c+65535,c=Math.floor(g/65536),d[E]=g-c*65536;d[0]+=c-1+37*(c-1)}function oe(d,E,g){for(var c,p=~(g-1),B=0;B<16;B++)c=p&(d[B]^E[B]),d[B]^=c,E[B]^=c}function T(d,E){var g,c,p,B=t(),N=t();for(g=0;g<16;g++)N[g]=E[g];for(re(N),re(N),re(N),c=0;c<2;c++){for(B[0]=N[0]-65517,g=1;g<15;g++)B[g]=N[g]-65535-(B[g-1]>>16&1),B[g-1]&=65535;B[15]=N[15]-32767-(B[14]>>16&1),p=B[15]>>16&1,B[14]&=65535,oe(N,B,1-p)}for(g=0;g<16;g++)d[2*g]=N[g]&255,d[2*g+1]=N[g]>>8}function M(d,E){var g=new Uint8Array(32),c=new Uint8Array(32);return T(g,d),T(c,E),w(g,0,c,0)}function F(d){var E=new Uint8Array(32);return T(E,d),E[0]&1}function V(d,E){var g;for(g=0;g<16;g++)d[g]=E[2*g]+(E[2*g+1]<<8);d[15]&=32767}function Ae(d,E,g){for(var c=0;c<16;c++)d[c]=E[c]+g[c]}function pe(d,E,g){for(var c=0;c<16;c++)d[c]=E[c]-g[c]}function Ee(d,E,g){var c,p,B=0,N=0,G=0,ie=0,le=0,ce=0,tt=0,he=0,Te=0,Le=0,Qe=0,De=0,Oe=0,Pe=0,Ue=0,de=0,be=0,ue=0,ge=0,_e=0,ae=0,U=0,D=0,j=0,W=0,Y=0,ee=0,me=0,He=0,Me=0,Fe=0,I=g[0],We=g[1],nt=g[2],rt=g[3],qe=g[4],Je=g[5],Ze=g[6],St=g[7],at=g[8],It=g[9],xt=g[10],yt=g[11],Bt=g[12],Lt=g[13],Ot=g[14],Ut=g[15];c=E[0],B+=c*I,N+=c*We,G+=c*nt,ie+=c*rt,le+=c*qe,ce+=c*Je,tt+=c*Ze,he+=c*St,Te+=c*at,Le+=c*It,Qe+=c*xt,De+=c*yt,Oe+=c*Bt,Pe+=c*Lt,Ue+=c*Ot,de+=c*Ut,c=E[1],N+=c*I,G+=c*We,ie+=c*nt,le+=c*rt,ce+=c*qe,tt+=c*Je,he+=c*Ze,Te+=c*St,Le+=c*at,Qe+=c*It,De+=c*xt,Oe+=c*yt,Pe+=c*Bt,Ue+=c*Lt,de+=c*Ot,be+=c*Ut,c=E[2],G+=c*I,ie+=c*We,le+=c*nt,ce+=c*rt,tt+=c*qe,he+=c*Je,Te+=c*Ze,Le+=c*St,Qe+=c*at,De+=c*It,Oe+=c*xt,Pe+=c*yt,Ue+=c*Bt,de+=c*Lt,be+=c*Ot,ue+=c*Ut,c=E[3],ie+=c*I,le+=c*We,ce+=c*nt,tt+=c*rt,he+=c*qe,Te+=c*Je,Le+=c*Ze,Qe+=c*St,De+=c*at,Oe+=c*It,Pe+=c*xt,Ue+=c*yt,de+=c*Bt,be+=c*Lt,ue+=c*Ot,ge+=c*Ut,c=E[4],le+=c*I,ce+=c*We,tt+=c*nt,he+=c*rt,Te+=c*qe,Le+=c*Je,Qe+=c*Ze,De+=c*St,Oe+=c*at,Pe+=c*It,Ue+=c*xt,de+=c*yt,be+=c*Bt,ue+=c*Lt,ge+=c*Ot,_e+=c*Ut,c=E[5],ce+=c*I,tt+=c*We,he+=c*nt,Te+=c*rt,Le+=c*qe,Qe+=c*Je,De+=c*Ze,Oe+=c*St,Pe+=c*at,Ue+=c*It,de+=c*xt,be+=c*yt,ue+=c*Bt,ge+=c*Lt,_e+=c*Ot,ae+=c*Ut,c=E[6],tt+=c*I,he+=c*We,Te+=c*nt,Le+=c*rt,Qe+=c*qe,De+=c*Je,Oe+=c*Ze,Pe+=c*St,Ue+=c*at,de+=c*It,be+=c*xt,ue+=c*yt,ge+=c*Bt,_e+=c*Lt,ae+=c*Ot,U+=c*Ut,c=E[7],he+=c*I,Te+=c*We,Le+=c*nt,Qe+=c*rt,De+=c*qe,Oe+=c*Je,Pe+=c*Ze,Ue+=c*St,de+=c*at,be+=c*It,ue+=c*xt,ge+=c*yt,_e+=c*Bt,ae+=c*Lt,U+=c*Ot,D+=c*Ut,c=E[8],Te+=c*I,Le+=c*We,Qe+=c*nt,De+=c*rt,Oe+=c*qe,Pe+=c*Je,Ue+=c*Ze,de+=c*St,be+=c*at,ue+=c*It,ge+=c*xt,_e+=c*yt,ae+=c*Bt,U+=c*Lt,D+=c*Ot,j+=c*Ut,c=E[9],Le+=c*I,Qe+=c*We,De+=c*nt,Oe+=c*rt,Pe+=c*qe,Ue+=c*Je,de+=c*Ze,be+=c*St,ue+=c*at,ge+=c*It,_e+=c*xt,ae+=c*yt,U+=c*Bt,D+=c*Lt,j+=c*Ot,W+=c*Ut,c=E[10],Qe+=c*I,De+=c*We,Oe+=c*nt,Pe+=c*rt,Ue+=c*qe,de+=c*Je,be+=c*Ze,ue+=c*St,ge+=c*at,_e+=c*It,ae+=c*xt,U+=c*yt,D+=c*Bt,j+=c*Lt,W+=c*Ot,Y+=c*Ut,c=E[11],De+=c*I,Oe+=c*We,Pe+=c*nt,Ue+=c*rt,de+=c*qe,be+=c*Je,ue+=c*Ze,ge+=c*St,_e+=c*at,ae+=c*It,U+=c*xt,D+=c*yt,j+=c*Bt,W+=c*Lt,Y+=c*Ot,ee+=c*Ut,c=E[12],Oe+=c*I,Pe+=c*We,Ue+=c*nt,de+=c*rt,be+=c*qe,ue+=c*Je,ge+=c*Ze,_e+=c*St,ae+=c*at,U+=c*It,D+=c*xt,j+=c*yt,W+=c*Bt,Y+=c*Lt,ee+=c*Ot,me+=c*Ut,c=E[13],Pe+=c*I,Ue+=c*We,de+=c*nt,be+=c*rt,ue+=c*qe,ge+=c*Je,_e+=c*Ze,ae+=c*St,U+=c*at,D+=c*It,j+=c*xt,W+=c*yt,Y+=c*Bt,ee+=c*Lt,me+=c*Ot,He+=c*Ut,c=E[14],Ue+=c*I,de+=c*We,be+=c*nt,ue+=c*rt,ge+=c*qe,_e+=c*Je,ae+=c*Ze,U+=c*St,D+=c*at,j+=c*It,W+=c*xt,Y+=c*yt,ee+=c*Bt,me+=c*Lt,He+=c*Ot,Me+=c*Ut,c=E[15],de+=c*I,be+=c*We,ue+=c*nt,ge+=c*rt,_e+=c*qe,ae+=c*Je,U+=c*Ze,D+=c*St,j+=c*at,W+=c*It,Y+=c*xt,ee+=c*yt,me+=c*Bt,He+=c*Lt,Me+=c*Ot,Fe+=c*Ut,B+=38*be,N+=38*ue,G+=38*ge,ie+=38*_e,le+=38*ae,ce+=38*U,tt+=38*D,he+=38*j,Te+=38*W,Le+=38*Y,Qe+=38*ee,De+=38*me,Oe+=38*He,Pe+=38*Me,Ue+=38*Fe,p=1,c=B+p+65535,p=Math.floor(c/65536),B=c-p*65536,c=N+p+65535,p=Math.floor(c/65536),N=c-p*65536,c=G+p+65535,p=Math.floor(c/65536),G=c-p*65536,c=ie+p+65535,p=Math.floor(c/65536),ie=c-p*65536,c=le+p+65535,p=Math.floor(c/65536),le=c-p*65536,c=ce+p+65535,p=Math.floor(c/65536),ce=c-p*65536,c=tt+p+65535,p=Math.floor(c/65536),tt=c-p*65536,c=he+p+65535,p=Math.floor(c/65536),he=c-p*65536,c=Te+p+65535,p=Math.floor(c/65536),Te=c-p*65536,c=Le+p+65535,p=Math.floor(c/65536),Le=c-p*65536,c=Qe+p+65535,p=Math.floor(c/65536),Qe=c-p*65536,c=De+p+65535,p=Math.floor(c/65536),De=c-p*65536,c=Oe+p+65535,p=Math.floor(c/65536),Oe=c-p*65536,c=Pe+p+65535,p=Math.floor(c/65536),Pe=c-p*65536,c=Ue+p+65535,p=Math.floor(c/65536),Ue=c-p*65536,c=de+p+65535,p=Math.floor(c/65536),de=c-p*65536,B+=p-1+37*(p-1),p=1,c=B+p+65535,p=Math.floor(c/65536),B=c-p*65536,c=N+p+65535,p=Math.floor(c/65536),N=c-p*65536,c=G+p+65535,p=Math.floor(c/65536),G=c-p*65536,c=ie+p+65535,p=Math.floor(c/65536),ie=c-p*65536,c=le+p+65535,p=Math.floor(c/65536),le=c-p*65536,c=ce+p+65535,p=Math.floor(c/65536),ce=c-p*65536,c=tt+p+65535,p=Math.floor(c/65536),tt=c-p*65536,c=he+p+65535,p=Math.floor(c/65536),he=c-p*65536,c=Te+p+65535,p=Math.floor(c/65536),Te=c-p*65536,c=Le+p+65535,p=Math.floor(c/65536),Le=c-p*65536,c=Qe+p+65535,p=Math.floor(c/65536),Qe=c-p*65536,c=De+p+65535,p=Math.floor(c/65536),De=c-p*65536,c=Oe+p+65535,p=Math.floor(c/65536),Oe=c-p*65536,c=Pe+p+65535,p=Math.floor(c/65536),Pe=c-p*65536,c=Ue+p+65535,p=Math.floor(c/65536),Ue=c-p*65536,c=de+p+65535,p=Math.floor(c/65536),de=c-p*65536,B+=p-1+37*(p-1),d[0]=B,d[1]=N,d[2]=G,d[3]=ie,d[4]=le,d[5]=ce,d[6]=tt,d[7]=he,d[8]=Te,d[9]=Le,d[10]=Qe,d[11]=De,d[12]=Oe,d[13]=Pe,d[14]=Ue,d[15]=de}function dt(d,E){Ee(d,E,E)}function vt(d,E){var g=t(),c;for(c=0;c<16;c++)g[c]=E[c];for(c=253;c>=0;c--)dt(g,g),c!==2&&c!==4&&Ee(g,g,E);for(c=0;c<16;c++)d[c]=g[c]}function Rr(d,E){var g=t(),c;for(c=0;c<16;c++)g[c]=E[c];for(c=250;c>=0;c--)dt(g,g),c!==1&&Ee(g,g,E);for(c=0;c<16;c++)d[c]=g[c]}function jn(d,E,g){var c=new Uint8Array(32),p=new Float64Array(80),B,N,G=t(),ie=t(),le=t(),ce=t(),tt=t(),he=t();for(N=0;N<31;N++)c[N]=E[N];for(c[31]=E[31]&127|64,c[0]&=248,V(p,g),N=0;N<16;N++)ie[N]=p[N],ce[N]=G[N]=le[N]=0;for(G[0]=ce[0]=1,N=254;N>=0;--N)B=c[N>>>3]>>>(N&7)&1,oe(G,ie,B),oe(le,ce,B),Ae(tt,G,le),pe(G,G,le),Ae(le,ie,ce),pe(ie,ie,ce),dt(ce,tt),dt(he,G),Ee(G,le,G),Ee(le,ie,tt),Ae(tt,G,le),pe(G,G,le),dt(ie,G),pe(le,ce,he),Ee(G,le,f),Ae(G,G,ce),Ee(le,le,G),Ee(G,ce,he),Ee(ce,ie,p),dt(ie,tt),oe(G,ie,B),oe(le,ce,B);for(N=0;N<16;N++)p[N+16]=G[N],p[N+32]=le[N],p[N+48]=ie[N],p[N+64]=ce[N];var Te=p.subarray(32),Le=p.subarray(16);return vt(Te,Te),Ee(Le,Le,Te),T(d,Le),0}function Vn(d,E){return jn(d,E,i)}function En(d,E){return e(E,32),Vn(d,E)}function zn(d,E,g){var c=new Uint8Array(32);return jn(c,g,E),L(d,r,c,z)}var kr=se,li=te;function Nr(d,E,g,c,p,B){var N=new Uint8Array(32);return zn(N,p,B),kr(d,E,g,c,N)}function Jn(d,E,g,c,p,B){var N=new Uint8Array(32);return zn(N,p,B),li(d,E,g,c,N)}var Zn=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function K(d,E,g,c){for(var p=new Int32Array(16),B=new Int32Array(16),N,G,ie,le,ce,tt,he,Te,Le,Qe,De,Oe,Pe,Ue,de,be,ue,ge,_e,ae,U,D,j,W,Y,ee,me=d[0],He=d[1],Me=d[2],Fe=d[3],I=d[4],We=d[5],nt=d[6],rt=d[7],qe=E[0],Je=E[1],Ze=E[2],St=E[3],at=E[4],It=E[5],xt=E[6],yt=E[7],Bt=0;c>=128;){for(_e=0;_e<16;_e++)ae=8*_e+Bt,p[_e]=g[ae+0]<<24|g[ae+1]<<16|g[ae+2]<<8|g[ae+3],B[_e]=g[ae+4]<<24|g[ae+5]<<16|g[ae+6]<<8|g[ae+7];for(_e=0;_e<80;_e++)if(N=me,G=He,ie=Me,le=Fe,ce=I,tt=We,he=nt,Te=rt,Le=qe,Qe=Je,De=Ze,Oe=St,Pe=at,Ue=It,de=xt,be=yt,U=rt,D=yt,j=D&65535,W=D>>>16,Y=U&65535,ee=U>>>16,U=(I>>>14|at<<32-14)^(I>>>18|at<<32-18)^(at>>>41-32|I<<32-(41-32)),D=(at>>>14|I<<32-14)^(at>>>18|I<<32-18)^(I>>>41-32|at<<32-(41-32)),j+=D&65535,W+=D>>>16,Y+=U&65535,ee+=U>>>16,U=I&We^~I&nt,D=at&It^~at&xt,j+=D&65535,W+=D>>>16,Y+=U&65535,ee+=U>>>16,U=Zn[_e*2],D=Zn[_e*2+1],j+=D&65535,W+=D>>>16,Y+=U&65535,ee+=U>>>16,U=p[_e%16],D=B[_e%16],j+=D&65535,W+=D>>>16,Y+=U&65535,ee+=U>>>16,W+=j>>>16,Y+=W>>>16,ee+=Y>>>16,ue=Y&65535|ee<<16,ge=j&65535|W<<16,U=ue,D=ge,j=D&65535,W=D>>>16,Y=U&65535,ee=U>>>16,U=(me>>>28|qe<<32-28)^(qe>>>34-32|me<<32-(34-32))^(qe>>>39-32|me<<32-(39-32)),D=(qe>>>28|me<<32-28)^(me>>>34-32|qe<<32-(34-32))^(me>>>39-32|qe<<32-(39-32)),j+=D&65535,W+=D>>>16,Y+=U&65535,ee+=U>>>16,U=me&He^me&Me^He&Me,D=qe&Je^qe&Ze^Je&Ze,j+=D&65535,W+=D>>>16,Y+=U&65535,ee+=U>>>16,W+=j>>>16,Y+=W>>>16,ee+=Y>>>16,Te=Y&65535|ee<<16,be=j&65535|W<<16,U=le,D=Oe,j=D&65535,W=D>>>16,Y=U&65535,ee=U>>>16,U=ue,D=ge,j+=D&65535,W+=D>>>16,Y+=U&65535,ee+=U>>>16,W+=j>>>16,Y+=W>>>16,ee+=Y>>>16,le=Y&65535|ee<<16,Oe=j&65535|W<<16,He=N,Me=G,Fe=ie,I=le,We=ce,nt=tt,rt=he,me=Te,Je=Le,Ze=Qe,St=De,at=Oe,It=Pe,xt=Ue,yt=de,qe=be,_e%16===15)for(ae=0;ae<16;ae++)U=p[ae],D=B[ae],j=D&65535,W=D>>>16,Y=U&65535,ee=U>>>16,U=p[(ae+9)%16],D=B[(ae+9)%16],j+=D&65535,W+=D>>>16,Y+=U&65535,ee+=U>>>16,ue=p[(ae+1)%16],ge=B[(ae+1)%16],U=(ue>>>1|ge<<32-1)^(ue>>>8|ge<<32-8)^ue>>>7,D=(ge>>>1|ue<<32-1)^(ge>>>8|ue<<32-8)^(ge>>>7|ue<<32-7),j+=D&65535,W+=D>>>16,Y+=U&65535,ee+=U>>>16,ue=p[(ae+14)%16],ge=B[(ae+14)%16],U=(ue>>>19|ge<<32-19)^(ge>>>61-32|ue<<32-(61-32))^ue>>>6,D=(ge>>>19|ue<<32-19)^(ue>>>61-32|ge<<32-(61-32))^(ge>>>6|ue<<32-6),j+=D&65535,W+=D>>>16,Y+=U&65535,ee+=U>>>16,W+=j>>>16,Y+=W>>>16,ee+=Y>>>16,p[ae]=Y&65535|ee<<16,B[ae]=j&65535|W<<16;U=me,D=qe,j=D&65535,W=D>>>16,Y=U&65535,ee=U>>>16,U=d[0],D=E[0],j+=D&65535,W+=D>>>16,Y+=U&65535,ee+=U>>>16,W+=j>>>16,Y+=W>>>16,ee+=Y>>>16,d[0]=me=Y&65535|ee<<16,E[0]=qe=j&65535|W<<16,U=He,D=Je,j=D&65535,W=D>>>16,Y=U&65535,ee=U>>>16,U=d[1],D=E[1],j+=D&65535,W+=D>>>16,Y+=U&65535,ee+=U>>>16,W+=j>>>16,Y+=W>>>16,ee+=Y>>>16,d[1]=He=Y&65535|ee<<16,E[1]=Je=j&65535|W<<16,U=Me,D=Ze,j=D&65535,W=D>>>16,Y=U&65535,ee=U>>>16,U=d[2],D=E[2],j+=D&65535,W+=D>>>16,Y+=U&65535,ee+=U>>>16,W+=j>>>16,Y+=W>>>16,ee+=Y>>>16,d[2]=Me=Y&65535|ee<<16,E[2]=Ze=j&65535|W<<16,U=Fe,D=St,j=D&65535,W=D>>>16,Y=U&65535,ee=U>>>16,U=d[3],D=E[3],j+=D&65535,W+=D>>>16,Y+=U&65535,ee+=U>>>16,W+=j>>>16,Y+=W>>>16,ee+=Y>>>16,d[3]=Fe=Y&65535|ee<<16,E[3]=St=j&65535|W<<16,U=I,D=at,j=D&65535,W=D>>>16,Y=U&65535,ee=U>>>16,U=d[4],D=E[4],j+=D&65535,W+=D>>>16,Y+=U&65535,ee+=U>>>16,W+=j>>>16,Y+=W>>>16,ee+=Y>>>16,d[4]=I=Y&65535|ee<<16,E[4]=at=j&65535|W<<16,U=We,D=It,j=D&65535,W=D>>>16,Y=U&65535,ee=U>>>16,U=d[5],D=E[5],j+=D&65535,W+=D>>>16,Y+=U&65535,ee+=U>>>16,W+=j>>>16,Y+=W>>>16,ee+=Y>>>16,d[5]=We=Y&65535|ee<<16,E[5]=It=j&65535|W<<16,U=nt,D=xt,j=D&65535,W=D>>>16,Y=U&65535,ee=U>>>16,U=d[6],D=E[6],j+=D&65535,W+=D>>>16,Y+=U&65535,ee+=U>>>16,W+=j>>>16,Y+=W>>>16,ee+=Y>>>16,d[6]=nt=Y&65535|ee<<16,E[6]=xt=j&65535|W<<16,U=rt,D=yt,j=D&65535,W=D>>>16,Y=U&65535,ee=U>>>16,U=d[7],D=E[7],j+=D&65535,W+=D>>>16,Y+=U&65535,ee+=U>>>16,W+=j>>>16,Y+=W>>>16,ee+=Y>>>16,d[7]=rt=Y&65535|ee<<16,E[7]=yt=j&65535|W<<16,Bt+=128,c-=128}return c}function fe(d,E,g){var c=new Int32Array(8),p=new Int32Array(8),B=new Uint8Array(256),N,G=g;for(c[0]=1779033703,c[1]=3144134277,c[2]=1013904242,c[3]=2773480762,c[4]=1359893119,c[5]=2600822924,c[6]=528734635,c[7]=1541459225,p[0]=4089235720,p[1]=2227873595,p[2]=4271175723,p[3]=1595750129,p[4]=2917565137,p[5]=725511199,p[6]=4215389547,p[7]=327033209,K(c,p,E,g),g%=128,N=0;N<g;N++)B[N]=E[G-g+N];for(B[g]=128,g=256-128*(g<112?1:0),B[g-9]=0,_(B,g-8,G/536870912|0,G<<3),K(c,p,B,g),N=0;N<8;N++)_(d,8*N,c[N],p[N]);return 0}function xe(d,E){var g=t(),c=t(),p=t(),B=t(),N=t(),G=t(),ie=t(),le=t(),ce=t();pe(g,d[1],d[0]),pe(ce,E[1],E[0]),Ee(g,g,ce),Ae(c,d[0],d[1]),Ae(ce,E[0],E[1]),Ee(c,c,ce),Ee(p,d[3],E[3]),Ee(p,p,u),Ee(B,d[2],E[2]),Ae(B,B,B),pe(N,c,g),pe(G,B,p),Ae(ie,B,p),Ae(le,c,g),Ee(d[0],N,G),Ee(d[1],le,ie),Ee(d[2],ie,G),Ee(d[3],N,le)}function Ne(d,E,g){var c;for(c=0;c<4;c++)oe(d[c],E[c],g)}function je(d,E){var g=t(),c=t(),p=t();vt(p,E[2]),Ee(g,E[0],p),Ee(c,E[1],p),T(d,c),d[31]^=F(g)<<7}function wt(d,E,g){var c,p;for(Z(d[0],s),Z(d[1],o),Z(d[2],o),Z(d[3],s),p=255;p>=0;--p)c=g[p/8|0]>>(p&7)&1,Ne(d,E,c),xe(E,d),xe(d,d),Ne(d,E,c)}function an(d,E){var g=[t(),t(),t(),t()];Z(g[0],h),Z(g[1],l),Z(g[2],o),Ee(g[3],h,l),wt(d,g,E)}function $t(d,E,g){var c=new Uint8Array(64),p=[t(),t(),t(),t()],B;for(g||e(E,32),fe(c,E,32),c[0]&=248,c[31]&=127,c[31]|=64,an(p,c),je(d,p),B=0;B<32;B++)E[B+32]=d[B];return 0}var er=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function st(d,E){var g,c,p,B;for(c=63;c>=32;--c){for(g=0,p=c-32,B=c-12;p<B;++p)E[p]+=g-16*E[c]*er[p-(c-32)],g=E[p]+128>>8,E[p]-=g*256;E[p]+=g,E[c]=0}for(g=0,p=0;p<32;p++)E[p]+=g-(E[31]>>4)*er[p],g=E[p]>>8,E[p]&=255;for(p=0;p<32;p++)E[p]-=g*er[p];for(c=0;c<32;c++)E[c+1]+=E[c]>>8,d[c]=E[c]&255}function Rt(d){var E=new Float64Array(64),g;for(g=0;g<64;g++)E[g]=d[g];for(g=0;g<64;g++)d[g]=0;st(d,E)}function Ct(d,E,g,c){var p=new Uint8Array(64),B=new Uint8Array(64),N=new Uint8Array(64),G,ie,le=new Float64Array(64),ce=[t(),t(),t(),t()];fe(p,c,32),p[0]&=248,p[31]&=127,p[31]|=64;var tt=g+64;for(G=0;G<g;G++)d[64+G]=E[G];for(G=0;G<32;G++)d[32+G]=p[32+G];for(fe(N,d.subarray(32),g+32),Rt(N),an(ce,N),je(d,ce),G=32;G<64;G++)d[G]=c[G];for(fe(B,d,g+64),Rt(B),G=0;G<64;G++)le[G]=0;for(G=0;G<32;G++)le[G]=N[G];for(G=0;G<32;G++)for(ie=0;ie<32;ie++)le[G+ie]+=B[G]*p[ie];return st(d.subarray(32),le),tt}function pt(d,E){var g=t(),c=t(),p=t(),B=t(),N=t(),G=t(),ie=t();return Z(d[2],o),V(d[1],E),dt(p,d[1]),Ee(B,p,a),pe(p,p,d[2]),Ae(B,d[2],B),dt(N,B),dt(G,N),Ee(ie,G,N),Ee(g,ie,p),Ee(g,g,B),Rr(g,g),Ee(g,g,p),Ee(g,g,B),Ee(g,g,B),Ee(d[0],g,B),dt(c,d[0]),Ee(c,c,B),M(c,p)&&Ee(d[0],d[0],A),dt(c,d[0]),Ee(c,c,B),M(c,p)?-1:(F(d[0])===E[31]>>7&&pe(d[0],s,d[0]),Ee(d[3],d[0],d[1]),0)}function ht(d,E,g,c){var p,B,N=new Uint8Array(32),G=new Uint8Array(64),ie=[t(),t(),t(),t()],le=[t(),t(),t(),t()];if(B=-1,g<64||pt(le,c))return-1;for(p=0;p<g;p++)d[p]=E[p];for(p=0;p<32;p++)d[p+32]=c[p];if(fe(G,d,g),Rt(G),wt(ie,le,G),an(le,E.subarray(32)),xe(ie,le),je(N,ie),g-=64,w(E,0,N,0)){for(p=0;p<g;p++)d[p]=0;return-1}for(p=0;p<g;p++)d[p]=E[p+64];return B=g,B}var zt=32,bt=24,Hn=32,tr=16,Tr=32,di=32,vr=32,Lr=32,_s=32,wf=bt,ku=Hn,Nu=tr,_n=64,Fn=32,nr=64,ps=32,bs=64;n.lowlevel={crypto_core_hsalsa20:L,crypto_stream_xor:S,crypto_stream:y,crypto_stream_salsa20_xor:ne,crypto_stream_salsa20:J,crypto_onetimeauth:q,crypto_onetimeauth_verify:H,crypto_verify_16:b,crypto_verify_32:w,crypto_secretbox:se,crypto_secretbox_open:te,crypto_scalarmult:jn,crypto_scalarmult_base:Vn,crypto_box_beforenm:zn,crypto_box_afternm:kr,crypto_box:Nr,crypto_box_open:Jn,crypto_box_keypair:En,crypto_hash:fe,crypto_sign:Ct,crypto_sign_keypair:$t,crypto_sign_open:ht,crypto_secretbox_KEYBYTES:zt,crypto_secretbox_NONCEBYTES:bt,crypto_secretbox_ZEROBYTES:Hn,crypto_secretbox_BOXZEROBYTES:tr,crypto_scalarmult_BYTES:Tr,crypto_scalarmult_SCALARBYTES:di,crypto_box_PUBLICKEYBYTES:vr,crypto_box_SECRETKEYBYTES:Lr,crypto_box_BEFORENMBYTES:_s,crypto_box_NONCEBYTES:wf,crypto_box_ZEROBYTES:ku,crypto_box_BOXZEROBYTES:Nu,crypto_sign_BYTES:_n,crypto_sign_PUBLICKEYBYTES:Fn,crypto_sign_SECRETKEYBYTES:nr,crypto_sign_SEEDBYTES:ps,crypto_hash_BYTES:bs};function mf(d,E){if(d.length!==zt)throw new Error("bad key size");if(E.length!==bt)throw new Error("bad nonce size")}function Tu(d,E){if(d.length!==vr)throw new Error("bad public key size");if(E.length!==Lr)throw new Error("bad secret key size")}function Xt(){var d,E;for(E=0;E<arguments.length;E++)if((d=Object.prototype.toString.call(arguments[E]))!=="[object Uint8Array]")throw new TypeError("unexpected type "+d+", use Uint8Array")}function Cf(d){for(var E=0;E<d.length;E++)d[E]=0}n.util||(n.util={},n.util.decodeUTF8=n.util.encodeUTF8=n.util.encodeBase64=n.util.decodeBase64=function(){throw new Error("nacl.util moved into separate package: https://github.com/dchest/tweetnacl-util-js")}),n.randomBytes=function(d){var E=new Uint8Array(d);return e(E,d),E},n.secretbox=function(d,E,g){Xt(d,E,g),mf(g,E);for(var c=new Uint8Array(Hn+d.length),p=new Uint8Array(c.length),B=0;B<d.length;B++)c[B+Hn]=d[B];return se(p,c,c.length,E,g),p.subarray(tr)},n.secretbox.open=function(d,E,g){Xt(d,E,g),mf(g,E);for(var c=new Uint8Array(tr+d.length),p=new Uint8Array(c.length),B=0;B<d.length;B++)c[B+tr]=d[B];return c.length<32||te(p,c,c.length,E,g)!==0?!1:p.subarray(Hn)},n.secretbox.keyLength=zt,n.secretbox.nonceLength=bt,n.secretbox.overheadLength=tr,n.scalarMult=function(d,E){if(Xt(d,E),d.length!==di)throw new Error("bad n size");if(E.length!==Tr)throw new Error("bad p size");var g=new Uint8Array(Tr);return jn(g,d,E),g},n.scalarMult.base=function(d){if(Xt(d),d.length!==di)throw new Error("bad n size");var E=new Uint8Array(Tr);return Vn(E,d),E},n.scalarMult.scalarLength=di,n.scalarMult.groupElementLength=Tr,n.box=function(d,E,g,c){var p=n.box.before(g,c);return n.secretbox(d,E,p)},n.box.before=function(d,E){Xt(d,E),Tu(d,E);var g=new Uint8Array(_s);return zn(g,d,E),g},n.box.after=n.secretbox,n.box.open=function(d,E,g,c){var p=n.box.before(g,c);return n.secretbox.open(d,E,p)},n.box.open.after=n.secretbox.open,n.box.keyPair=function(){var d=new Uint8Array(vr),E=new Uint8Array(Lr);return En(d,E),{publicKey:d,secretKey:E}},n.box.keyPair.fromSecretKey=function(d){if(Xt(d),d.length!==Lr)throw new Error("bad secret key size");var E=new Uint8Array(vr);return Vn(E,d),{publicKey:E,secretKey:new Uint8Array(d)}},n.box.publicKeyLength=vr,n.box.secretKeyLength=Lr,n.box.sharedKeyLength=_s,n.box.nonceLength=wf,n.box.overheadLength=n.secretbox.overheadLength,n.sign=function(d,E){if(Xt(d,E),E.length!==nr)throw new Error("bad secret key size");var g=new Uint8Array(_n+d.length);return Ct(g,d,d.length,E),g},n.sign.open=function(d,E){if(arguments.length!==2)throw new Error("nacl.sign.open accepts 2 arguments; did you mean to use nacl.sign.detached.verify?");if(Xt(d,E),E.length!==Fn)throw new Error("bad public key size");var g=new Uint8Array(d.length),c=ht(g,d,d.length,E);if(c<0)return null;for(var p=new Uint8Array(c),B=0;B<p.length;B++)p[B]=g[B];return p},n.sign.detached=function(d,E){for(var g=n.sign(d,E),c=new Uint8Array(_n),p=0;p<c.length;p++)c[p]=g[p];return c},n.sign.detached.verify=function(d,E,g){if(Xt(d,E,g),E.length!==_n)throw new Error("bad signature size");if(g.length!==Fn)throw new Error("bad public key size");var c=new Uint8Array(_n+d.length),p=new Uint8Array(_n+d.length),B;for(B=0;B<_n;B++)c[B]=E[B];for(B=0;B<d.length;B++)c[B+_n]=d[B];return ht(p,c,c.length,g)>=0},n.sign.keyPair=function(){var d=new Uint8Array(Fn),E=new Uint8Array(nr);return $t(d,E),{publicKey:d,secretKey:E}},n.sign.keyPair.fromSecretKey=function(d){if(Xt(d),d.length!==nr)throw new Error("bad secret key size");for(var E=new Uint8Array(Fn),g=0;g<E.length;g++)E[g]=d[32+g];return{publicKey:E,secretKey:new Uint8Array(d)}},n.sign.keyPair.fromSeed=function(d){if(Xt(d),d.length!==ps)throw new Error("bad seed size");for(var E=new Uint8Array(Fn),g=new Uint8Array(nr),c=0;c<32;c++)g[c]=d[c];return $t(E,g,!0),{publicKey:E,secretKey:g}},n.sign.publicKeyLength=Fn,n.sign.secretKeyLength=nr,n.sign.seedLength=ps,n.sign.signatureLength=_n,n.hash=function(d){Xt(d);var E=new Uint8Array(bs);return fe(E,d,d.length),E},n.hash.hashLength=bs,n.verify=function(d,E){return Xt(d,E),d.length===0||E.length===0||d.length!==E.length?!1:x(d,0,E,0,d.length)===0},n.setPRNG=function(d){e=d},function(){var d=typeof self<"u"?self.crypto||self.msCrypto:null;if(d&&d.getRandomValues){var E=65536;n.setPRNG(function(g,c){var p,B=new Uint8Array(c);for(p=0;p<c;p+=E)d.getRandomValues(B.subarray(p,p+Math.min(c-p,E)));for(p=0;p<c;p++)g[p]=B[p];Cf(B)})}else typeof require<"u"&&(d=require("crypto"),d&&d.randomBytes&&n.setPRNG(function(g,c){var p,B=d.randomBytes(c);for(p=0;p<c;p++)g[p]=B[p];Cf(B)}))}()})(typeof Ri<"u"&&Ri.exports?Ri.exports:self.nacl=self.nacl||{})});var Qs=ze((FA,ra)=>{"use strict";var Us=na().lowlevel.crypto_hash,In=0,Wn=function(){this.S=[new Uint32Array([3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946]),new Uint32Array([1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055]),new Uint32Array([3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504]),new Uint32Array([976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462])],this.P=new Uint32Array([608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731])};function Ni(n,t,e){return(n[0][t[e+3]]+n[1][t[e+2]]^n[2][t[e+1]])+n[3][t[e]]}Wn.prototype.encipher=function(n,t){t===void 0&&(t=new Uint8Array(n.buffer),n.byteOffset!==0&&(t=t.subarray(n.byteOffset))),n[0]^=this.P[0];for(var e=1;e<16;e+=2)n[1]^=Ni(this.S,t,0)^this.P[e],n[0]^=Ni(this.S,t,4)^this.P[e+1];var r=n[0];n[0]=n[1]^this.P[17],n[1]=r};Wn.prototype.decipher=function(n){var t=new Uint8Array(n.buffer);n.byteOffset!==0&&(t=t.subarray(n.byteOffset)),n[0]^=this.P[17];for(var e=16;e>0;e-=2)n[1]^=Ni(this.S,t,0)^this.P[e],n[0]^=Ni(this.S,t,4)^this.P[e-1];var r=n[0];n[0]=n[1]^this.P[0],n[1]=r};function Kn(n,t){var e,r=0;for(e=0;e<4;e++,In++)In>=t&&(In=0),r=r<<8|n[In];return r}Wn.prototype.expand0state=function(n,t){var e=new Uint32Array(2),r,i,s=new Uint8Array(e.buffer);for(r=0,In=0;r<18;r++)this.P[r]^=Kn(n,t);for(In=0,r=0;r<18;r+=2)this.encipher(e,s),this.P[r]=e[0],this.P[r+1]=e[1];for(r=0;r<4;r++)for(i=0;i<256;i+=2)this.encipher(e,s),this.S[r][i]=e[0],this.S[r][i+1]=e[1]};Wn.prototype.expandstate=function(n,t,e,r){var i=new Uint32Array(2),s,o;for(s=0,In=0;s<18;s++)this.P[s]^=Kn(e,r);for(s=0,In=0;s<18;s+=2)i[0]^=Kn(n,t),i[1]^=Kn(n,t),this.encipher(i),this.P[s]=i[0],this.P[s+1]=i[1];for(s=0;s<4;s++)for(o=0;o<256;o+=2)i[0]^=Kn(n,t),i[1]^=Kn(n,t),this.encipher(i),this.S[s][o]=i[0],this.S[s][o+1]=i[1];In=0};Wn.prototype.enc=function(n,t){for(var e=0;e<t;e++)this.encipher(n.subarray(e*2))};Wn.prototype.dec=function(n,t){for(var e=0;e<t;e++)this.decipher(n.subarray(e*2))};var ki=8,Ps=32;function Ds(n,t,e){var r=new Wn,i=new Uint32Array(ki),s,o=new Uint8Array([79,120,121,99,104,114,111,109,97,116,105,99,66,108,111,119,102,105,115,104,83,119,97,116,68,121,110,97,109,105,116,101]);for(r.expandstate(t,64,n,64),s=0;s<64;s++)r.expand0state(t,64),r.expand0state(n,64);for(s=0;s<ki;s++)i[s]=Kn(o,o.byteLength);for(s=0;s<64;s++)r.enc(i,i.byteLength/8);for(s=0;s<ki;s++)e[4*s+3]=i[s]>>>24,e[4*s+2]=i[s]>>>16,e[4*s+1]=i[s]>>>8,e[4*s+0]=i[s]}function Lh(n,t,e,r,i,s,o){var f=new Uint8Array(64),a=new Uint8Array(64),u=new Uint8Array(Ps),h=new Uint8Array(Ps),l=new Uint8Array(r+4),A,_,x,b,w,C,v=s;if(o<1||t===0||r===0||s===0||s>u.byteLength*u.byteLength||r>1<<20)return-1;for(b=Math.floor((s+u.byteLength-1)/u.byteLength),x=Math.floor((s+b-1)/b),A=0;A<r;A++)l[A]=e[A];for(Us(f,n,t),C=1;s>0;C++){for(l[r+0]=C>>>24,l[r+1]=C>>>16,l[r+2]=C>>>8,l[r+3]=C,Us(a,l,r+4),Ds(f,a,h),A=u.byteLength;A--;)u[A]=h[A];for(A=1;A<o;A++)for(Us(a,h,h.byteLength),Ds(f,a,h),_=0;_<u.byteLength;_++)u[_]^=h[_];for(x=Math.min(x,s),A=0;A<x&&(w=A*b+(C-1),!(w>=v));A++)i[w]=u[A];s-=A}return 0}ra.exports={BLOCKS:ki,HASHSIZE:Ps,hash:Ds,pbkdf:Lh}});var sa=ze((MA,ia)=>{"use strict";var Oh=require("../build/Release/cpufeatures.node");ia.exports=Oh.getCPUInfo});var yn=ze((qA,vi)=>{"use strict";var xn=require("crypto"),ur;try{ur=sa()()}catch{}var{bindingAvailable:oa,CIPHER_INFO:Uh,MAC_INFO:Ph}=Nn(),fa=(()=>{if(typeof xn.sign=="function"&&typeof xn.verify=="function"){let n=`-----BEGIN PRIVATE KEY-----\r
MC4CAQAwBQYDK2VwBCIEIHKj+sVa9WcD/q2DJUJaf43Kptc8xYuUQA4bOFj9vC8T\r
-----END PRIVATE KEY-----`,t=Buffer.from("a"),e,r;try{e=xn.sign(null,t,n),r=xn.verify(null,t,n,e)}catch{}return Buffer.isBuffer(e)&&e.length===64&&r===!0}return!1})(),aa=typeof xn.diffieHellman=="function"&&typeof xn.generateKeyPairSync=="function"&&typeof xn.createPublicKey=="function",Ti=["ecdh-sha2-nistp256","ecdh-sha2-nistp384","ecdh-sha2-nistp521","diffie-hellman-group-exchange-sha256","diffie-hellman-group14-sha256","diffie-hellman-group15-sha512","diffie-hellman-group16-sha512","diffie-hellman-group17-sha512","diffie-hellman-group18-sha512"];aa&&(Ti.unshift("curve25519-sha256"),Ti.unshift("curve25519-sha256@libssh.org"));var Dh=Ti.concat(["diffie-hellman-group-exchange-sha1","diffie-hellman-group14-sha1","diffie-hellman-group1-sha1"]),Hs=["ecdsa-sha2-nistp256","ecdsa-sha2-nistp384","ecdsa-sha2-nistp521","rsa-sha2-512","rsa-sha2-256","ssh-rsa"];fa&&Hs.unshift("ssh-ed25519");var Qh=Hs.concat(["ssh-dss"]),ca=(()=>{let n=xn.getCiphers();return t=>n.includes(Uh[t].sslName)})(),kn=["aes128-gcm@openssh.com","aes256-gcm@openssh.com","aes128-ctr","aes192-ctr","aes256-ctr"];ur&&ur.flags&&!ur.flags.aes?oa?kn.unshift("chacha20-poly1305@openssh.com"):kn.push("chacha20-poly1305@openssh.com"):oa&&ur&&ur.arch==="x86"?kn.splice(4,0,"chacha20-poly1305@openssh.com"):kn.push("chacha20-poly1305@openssh.com");kn=kn.filter(ca);var Hh=kn.concat(["aes256-cbc","aes192-cbc","aes128-cbc","blowfish-cbc","3des-cbc","aes128-gcm","aes256-gcm","arcfour256","arcfour128","cast128-cbc","arcfour"].filter(ca)),ua=(()=>{let n=xn.getHashes();return t=>n.includes(Ph[t].sslName)})(),ha=["hmac-sha2-256-etm@openssh.com","hmac-sha2-512-etm@openssh.com","hmac-sha1-etm@openssh.com","hmac-sha2-256","hmac-sha2-512","hmac-sha1"].filter(ua),Fh=ha.concat(["hmac-md5","hmac-sha2-256-96","hmac-sha2-512-96","hmac-ripemd160","hmac-sha1-96","hmac-md5-96"].filter(ua)),la=["none","zlib@openssh.com","zlib"],Mh=la.concat([]),cr={BAD_DHGEX:1<<0,OLD_EXIT:1<<1,DYN_RPORT_BUG:1<<2,BUG_DHGEX_LARGE:1<<3,IMPLY_RSA_SHA2_SIGALGS:1<<4};vi.exports={MESSAGE:{DISCONNECT:1,IGNORE:2,UNIMPLEMENTED:3,DEBUG:4,SERVICE_REQUEST:5,SERVICE_ACCEPT:6,EXT_INFO:7,KEXINIT:20,NEWKEYS:21,KEXDH_INIT:30,KEXDH_REPLY:31,KEXDH_GEX_GROUP:31,KEXDH_GEX_INIT:32,KEXDH_GEX_REPLY:33,KEXDH_GEX_REQUEST:34,KEXECDH_INIT:30,KEXECDH_REPLY:31,USERAUTH_REQUEST:50,USERAUTH_FAILURE:51,USERAUTH_SUCCESS:52,USERAUTH_BANNER:53,USERAUTH_PASSWD_CHANGEREQ:60,USERAUTH_PK_OK:60,USERAUTH_INFO_REQUEST:60,USERAUTH_INFO_RESPONSE:61,GLOBAL_REQUEST:80,REQUEST_SUCCESS:81,REQUEST_FAILURE:82,CHANNEL_OPEN:90,CHANNEL_OPEN_CONFIRMATION:91,CHANNEL_OPEN_FAILURE:92,CHANNEL_WINDOW_ADJUST:93,CHANNEL_DATA:94,CHANNEL_EXTENDED_DATA:95,CHANNEL_EOF:96,CHANNEL_CLOSE:97,CHANNEL_REQUEST:98,CHANNEL_SUCCESS:99,CHANNEL_FAILURE:100},DISCONNECT_REASON:{HOST_NOT_ALLOWED_TO_CONNECT:1,PROTOCOL_ERROR:2,KEY_EXCHANGE_FAILED:3,RESERVED:4,MAC_ERROR:5,COMPRESSION_ERROR:6,SERVICE_NOT_AVAILABLE:7,PROTOCOL_VERSION_NOT_SUPPORTED:8,HOST_KEY_NOT_VERIFIABLE:9,CONNECTION_LOST:10,BY_APPLICATION:11,TOO_MANY_CONNECTIONS:12,AUTH_CANCELED_BY_USER:13,NO_MORE_AUTH_METHODS_AVAILABLE:14,ILLEGAL_USER_NAME:15},DISCONNECT_REASON_STR:void 0,CHANNEL_OPEN_FAILURE:{ADMINISTRATIVELY_PROHIBITED:1,CONNECT_FAILED:2,UNKNOWN_CHANNEL_TYPE:3,RESOURCE_SHORTAGE:4},TERMINAL_MODE:{TTY_OP_END:0,VINTR:1,VQUIT:2,VERASE:3,VKILL:4,VEOF:5,VEOL:6,VEOL2:7,VSTART:8,VSTOP:9,VSUSP:10,VDSUSP:11,VREPRINT:12,VWERASE:13,VLNEXT:14,VFLUSH:15,VSWTCH:16,VSTATUS:17,VDISCARD:18,IGNPAR:30,PARMRK:31,INPCK:32,ISTRIP:33,INLCR:34,IGNCR:35,ICRNL:36,IUCLC:37,IXON:38,IXANY:39,IXOFF:40,IMAXBEL:41,ISIG:50,ICANON:51,XCASE:52,ECHO:53,ECHOE:54,ECHOK:55,ECHONL:56,NOFLSH:57,TOSTOP:58,IEXTEN:59,ECHOCTL:60,ECHOKE:61,PENDIN:62,OPOST:70,OLCUC:71,ONLCR:72,OCRNL:73,ONOCR:74,ONLRET:75,CS7:90,CS8:91,PARENB:92,PARODD:93,TTY_OP_ISPEED:128,TTY_OP_OSPEED:129},CHANNEL_EXTENDED_DATATYPE:{STDERR:1},SIGNALS:["ABRT","ALRM","FPE","HUP","ILL","INT","QUIT","SEGV","TERM","USR1","USR2","KILL","PIPE"].reduce((n,t)=>({...n,[t]:1}),{}),COMPAT:cr,COMPAT_CHECKS:[["Cisco-1.25",cr.BAD_DHGEX],[/^Cisco-1[.]/,cr.BUG_DHGEX_LARGE],[/^[0-9.]+$/,cr.OLD_EXIT],[/^OpenSSH_5[.][0-9]+/,cr.DYN_RPORT_BUG],[/^OpenSSH_7[.]4/,cr.IMPLY_RSA_SHA2_SIGALGS]],DEFAULT_KEX:Ti,SUPPORTED_KEX:Dh,DEFAULT_SERVER_HOST_KEY:Hs,SUPPORTED_SERVER_HOST_KEY:Qh,DEFAULT_CIPHER:kn,SUPPORTED_CIPHER:Hh,DEFAULT_MAC:ha,SUPPORTED_MAC:Fh,DEFAULT_COMPRESSION:la,SUPPORTED_COMPRESSION:Mh,curve25519Supported:aa,eddsaSupported:fa};vi.exports.DISCONNECT_REASON_BY_VALUE=Array.from(Object.entries(vi.exports.DISCONNECT_REASON)).reduce((n,[t,e])=>({...n,[e]:t}),{})});var rn=ze((KA,Ea)=>{"use strict";var tn=Qr().Ber,Li,ga=Buffer[Symbol.species],qh=Object.getPrototypeOf(Uint8Array.prototype).fill;function da(n,t){return n[t++]*16777216+n[t++]*65536+n[t++]*256+n[t]}function Hr(n,t,e,r,i){i||(i=0),r>n.length&&(r=n.length);let s=r-e,o=t.length-i;return s>o&&(s=o),t.set(new Uint8Array(n.buffer,n.byteOffset+e,s),i),s}function Fr(n,t,e){return e===void 0&&(e=n.length),new ga(n.buffer,n.byteOffset+t,e-t)}function Ms(){let n=0,t,e={init:(r,i)=>{t=r,n=typeof i=="number"?i:0},pos:()=>n,length:()=>t?t.length:0,avail:()=>t&&n<t.length?t.length-n:0,clear:()=>{t=void 0},readUInt32BE:()=>{if(!(!t||n+3>=t.length))return t[n++]*16777216+t[n++]*65536+t[n++]*256+t[n++]},readUInt64BE:r=>{if(!(!t||n+7>=t.length))switch(r){case"always":return BigInt(`0x${t.hexSlice(n,n+=8)}`);case"maybe":if(t[n]>31)return BigInt(`0x${t.hexSlice(n,n+=8)}`);default:return t[n++]*72057594037927940+t[n++]*281474976710656+t[n++]*1099511627776+t[n++]*4294967296+t[n++]*16777216+t[n++]*65536+t[n++]*256+t[n++]}},skip:r=>{t&&r>0&&(n+=r)},skipString:()=>{let r=e.readUInt32BE();if(r!==void 0)return n+=r,n<=t.length?r:void 0},readByte:()=>{if(t&&n<t.length)return t[n++]},readBool:()=>{if(t&&n<t.length)return!!t[n++]},readList:()=>{let r=e.readString(!0);if(r!==void 0)return r?r.split(","):[]},readString:(r,i)=>{typeof r=="number"&&(i=r,r=void 0);let s=e.readUInt32BE();if(s!==void 0&&!(t.length-n<s||typeof i=="number"&&s>i))return r?Buffer.isBuffer(r)?Hr(t,r,n,n+=s):t.utf8Slice(n,n+=s):Fr(t,n,n+=s)},readRaw:r=>{if(t){if(typeof r!="number")return Fr(t,n,n+=t.length-n);if(t.length-n>=r)return Fr(t,n,n+=r)}}};return e}function Aa(n,t,e){let r=new Error(n);return typeof t=="boolean"?(e=t,r.level="protocol"):r.level=t||"protocol",r.fatal=!!e,r}function Fs(n,t,e){return n[e++]=t>>>24,n[e++]=t>>>16,n[e++]=t>>>8,n[e++]=t,e}var Oi=Ms();Ea.exports={bufferCopy:Hr,bufferSlice:Fr,FastBuffer:ga,bufferFill:(n,t,e,r)=>qh.call(n,t,e,r),makeError:Aa,doFatalError:(n,t,e,r)=>{let i;return Li===void 0&&({DISCONNECT_REASON:Li}=yn()),t instanceof Error?(i=t,typeof e!="number"?r=Li.PROTOCOL_ERROR:r=e):i=Aa(t,e,!0),typeof r!="number"&&(r=Li.PROTOCOL_ERROR),n.disconnect(r),n._destruct(),n._onError(i),1/0},readUInt32BE:da,writeUInt32BE:Fs,writeUInt32LE:(n,t,e)=>(n[e++]=t,n[e++]=t>>>8,n[e++]=t>>>16,n[e++]=t>>>24,e),makeBufferParser:Ms,bufferParser:Ms(),readString:(n,t,e,r)=>{typeof e=="number"&&(r=e,e=void 0),t===void 0&&(t=0);let i=n.length-t;if(t<0||t>=n.length||i<4)return;let s=da(n,t);if(i<4+s||typeof r=="number"&&s>r)return;t+=4;let o=t+s;return n._pos=o,e?Buffer.isBuffer(e)?Hr(n,e,t,o):n.utf8Slice(t,o):Fr(n,t,o)},sigSSHToASN1:(n,t)=>{switch(t){case"ssh-dss":{if(n.length>40)return n;let e=new tn.Writer;e.startSequence();let r=n.slice(0,20),i=n.slice(20);if(r[0]&128){let s=Buffer.allocUnsafe(21);s[0]=0,r.copy(s,1),r=s}else r[0]===0&&!(r[1]&128)&&(r=r.slice(1));if(i[0]&128){let s=Buffer.allocUnsafe(21);s[0]=0,i.copy(s,1),i=s}else i[0]===0&&!(i[1]&128)&&(i=i.slice(1));return e.writeBuffer(r,tn.Integer),e.writeBuffer(i,tn.Integer),e.endSequence(),e.buffer}case"ecdsa-sha2-nistp256":case"ecdsa-sha2-nistp384":case"ecdsa-sha2-nistp521":{Oi.init(n,0);let e=Oi.readString(),r=Oi.readString();if(Oi.clear(),e===void 0||r===void 0)return;let i=new tn.Writer;return i.startSequence(),i.writeBuffer(e,tn.Integer),i.writeBuffer(r,tn.Integer),i.endSequence(),i.buffer}default:return n}},convertSignature:(n,t)=>{switch(t){case"ssh-dss":{if(n.length<=40)return n;let e=new tn.Reader(n);e.readSequence();let r=e.readString(tn.Integer,!0),i=e.readString(tn.Integer,!0),s=0,o=0;if(r.length<20){let a=Buffer.allocUnsafe(20);a.set(r,1),r=a,r[0]=0}if(i.length<20){let a=Buffer.allocUnsafe(20);a.set(i,1),i=a,i[0]=0}r.length>20&&r[0]===0&&(s=1),i.length>20&&i[0]===0&&(o=1);let f=Buffer.allocUnsafe(r.length-s+(i.length-o));return Hr(r,f,s,r.length,0),Hr(i,f,o,i.length,r.length-s),f}case"ecdsa-sha2-nistp256":case"ecdsa-sha2-nistp384":case"ecdsa-sha2-nistp521":{if(n[0]===0)return n;let e=new tn.Reader(n);e.readSequence();let r=e.readString(tn.Integer,!0),i=e.readString(tn.Integer,!0);if(r===null||i===null)return;let s=Buffer.allocUnsafe(4+r.length+4+i.length);return Fs(s,r.length,0),s.set(r,4),Fs(s,i.length,4+r.length),s.set(i,4+4+r.length),s}}return n},sendPacket:(n,t,e)=>!e&&n._kexinit!==void 0?(n._queue===void 0&&(n._queue=[]),n._queue.push(t),n._debug&&n._debug("Outbound: ... packet queued"),!1):(n._cipher.encrypt(t),!0)}});var _a=ze((Ui,Ks)=>{var qs=function(){var n=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(n=n||__filename),function(t){t=t||{};var e;e||(e=typeof t<"u"?t:{});var r,i;e.ready=new Promise(function(K,fe){r=K,i=fe});var s={},o;for(o in e)e.hasOwnProperty(o)&&(s[o]=e[o]);var f=typeof window=="object",a=typeof importScripts=="function",u=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",h="",l,A,_,x,b;u?(h=a?require("path").dirname(h)+"/":__dirname+"/",l=function(K,fe){var xe=En(K);return xe?fe?xe:xe.toString():(x||(x=require("fs")),b||(b=require("path")),K=b.normalize(K),x.readFileSync(K,fe?null:"utf8"))},_=function(K){return K=l(K,!0),K.buffer||(K=new Uint8Array(K)),z(K.buffer),K},A=function(K,fe,xe){var Ne=En(K);Ne&&fe(Ne),x||(x=require("fs")),b||(b=require("path")),K=b.normalize(K),x.readFile(K,function(je,wt){je?xe(je):fe(wt.buffer)})},1<process.argv.length&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),e.inspect=function(){return"[Emscripten Module object]"}):(f||a)&&(a?h=self.location.href:typeof document<"u"&&document.currentScript&&(h=document.currentScript.src),n&&(h=n),h.indexOf("blob:")!==0?h=h.substr(0,h.lastIndexOf("/")+1):h="",l=function(K){try{var fe=new XMLHttpRequest;return fe.open("GET",K,!1),fe.send(null),fe.responseText}catch(je){if(K=En(K)){fe=[];for(var xe=0;xe<K.length;xe++){var Ne=K[xe];255<Ne&&(jn&&z(!1,"Character code "+Ne+" ("+String.fromCharCode(Ne)+")  at offset "+xe+" not in 0x00-0xFF."),Ne&=255),fe.push(String.fromCharCode(Ne))}return fe.join("")}throw je}},a&&(_=function(K){try{var fe=new XMLHttpRequest;return fe.open("GET",K,!1),fe.responseType="arraybuffer",fe.send(null),new Uint8Array(fe.response)}catch(xe){if(K=En(K))return K;throw xe}}),A=function(K,fe,xe){var Ne=new XMLHttpRequest;Ne.open("GET",K,!0),Ne.responseType="arraybuffer",Ne.onload=function(){if(Ne.status==200||Ne.status==0&&Ne.response)fe(Ne.response);else{var je=En(K);je?fe(je.buffer):xe()}},Ne.onerror=xe,Ne.send(null)}),e.print||console.log.bind(console);var w=e.printErr||console.warn.bind(console);for(o in s)s.hasOwnProperty(o)&&(e[o]=s[o]);s=null;var C;e.wasmBinary&&(C=e.wasmBinary);var v=e.noExitRuntime||!0;typeof WebAssembly!="object"&&V("no native wasm support detected");var X,L=!1;function z(K,fe){K||V("Assertion failed: "+fe)}function ne(K){var fe=e["_"+K];return z(fe,"Cannot call unknown function "+K+", make sure it is exported"),fe}function J(K,fe,xe,Ne){var je={string:function(st){var Rt=0;if(st!=null&&st!==0){var Ct=(st.length<<2)+1;Rt=Nr(Ct);var pt=Rt,ht=q;if(0<Ct){Ct=pt+Ct-1;for(var zt=0;zt<st.length;++zt){var bt=st.charCodeAt(zt);if(55296<=bt&&57343>=bt){var Hn=st.charCodeAt(++zt);bt=65536+((bt&1023)<<10)|Hn&1023}if(127>=bt){if(pt>=Ct)break;ht[pt++]=bt}else{if(2047>=bt){if(pt+1>=Ct)break;ht[pt++]=192|bt>>6}else{if(65535>=bt){if(pt+2>=Ct)break;ht[pt++]=224|bt>>12}else{if(pt+3>=Ct)break;ht[pt++]=240|bt>>18,ht[pt++]=128|bt>>12&63}ht[pt++]=128|bt>>6&63}ht[pt++]=128|bt&63}}ht[pt]=0}}return Rt},array:function(st){var Rt=Nr(st.length);return O.set(st,Rt),Rt}},wt=ne(K),an=[];if(K=0,Ne)for(var $t=0;$t<Ne.length;$t++){var er=je[xe[$t]];er?(K===0&&(K=kr()),an[$t]=er(Ne[$t])):an[$t]=Ne[$t]}return xe=wt.apply(null,an),xe=function(st){if(fe==="string")if(st){for(var Rt=q,Ct=st+NaN,pt=st;Rt[pt]&&!(pt>=Ct);)++pt;if(16<pt-st&&Rt.subarray&&y)st=y.decode(Rt.subarray(st,pt));else{for(Ct="";st<pt;){var ht=Rt[st++];if(ht&128){var zt=Rt[st++]&63;if((ht&224)==192)Ct+=String.fromCharCode((ht&31)<<6|zt);else{var bt=Rt[st++]&63;ht=(ht&240)==224?(ht&15)<<12|zt<<6|bt:(ht&7)<<18|zt<<12|bt<<6|Rt[st++]&63,65536>ht?Ct+=String.fromCharCode(ht):(ht-=65536,Ct+=String.fromCharCode(55296|ht>>10,56320|ht&1023))}}else Ct+=String.fromCharCode(ht)}st=Ct}}else st="";else st=fe==="boolean"?!!st:st;return st}(xe),K!==0&&li(K),xe}var y=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,S,O,q;function H(){var K=X.buffer;S=K,e.HEAP8=O=new Int8Array(K),e.HEAP16=new Int16Array(K),e.HEAP32=new Int32Array(K),e.HEAPU8=q=new Uint8Array(K),e.HEAPU16=new Uint16Array(K),e.HEAPU32=new Uint32Array(K),e.HEAPF32=new Float32Array(K),e.HEAPF64=new Float64Array(K)}var se,te=[],Z=[],re=[];function oe(){var K=e.preRun.shift();te.unshift(K)}var T=0,M=null,F=null;e.preloadedImages={},e.preloadedAudios={};function V(K){throw e.onAbort&&e.onAbort(K),w(K),L=!0,K=new WebAssembly.RuntimeError("abort("+K+"). Build with -s ASSERTIONS=1 for more info."),i(K),K}var Ae="data:application/octet-stream;base64,",pe;if(pe="data:application/octet-stream;base64,AGFzbQEAAAABIAZgAX8Bf2ADf39/AGABfwBgAABgAAF/YAZ/f39/f38AAgcBAWEBYQAAAwsKAAEDAQAAAgQFAgQFAXABAQEFBwEBgAKAgAIGCQF/AUGAjMACCwclCQFiAgABYwADAWQACQFlAAgBZgAHAWcABgFoAAUBaQAKAWoBAAqGTQpPAQJ/QYAIKAIAIgEgAEEDakF8cSICaiEAAkAgAkEAIAAgAU0bDQAgAD8AQRB0SwRAIAAQAEUNAQtBgAggADYCACABDwtBhAhBMDYCAEF/C4wFAg5+Cn8gACgCJCEUIAAoAiAhFSAAKAIcIREgACgCGCESIAAoAhQhEyACQRBPBEAgAC0ATEVBGHQhFyAAKAIEIhZBBWytIQ8gACgCCCIYQQVsrSENIAAoAgwiGUEFbK0hCyAAKAIQIhpBBWytIQkgADUCACEIIBqtIRAgGa0hDiAYrSEMIBatIQoDQCASIAEtAAMiEiABLQAEQQh0ciABLQAFQRB0ciABLQAGIhZBGHRyQQJ2Qf///x9xaq0iAyAOfiABLwAAIAEtAAJBEHRyIBNqIBJBGHRBgICAGHFqrSIEIBB+fCARIAEtAAdBCHQgFnIgAS0ACEEQdHIgAS0ACSIRQRh0ckEEdkH///8fcWqtIgUgDH58IAEtAApBCHQgEXIgAS0AC0EQdHIgAS0ADEEYdHJBBnYgFWqtIgYgCn58IBQgF2ogAS8ADSABLQAPQRB0cmqtIgcgCH58IAMgDH4gBCAOfnwgBSAKfnwgBiAIfnwgByAJfnwgAyAKfiAEIAx+fCAFIAh+fCAGIAl+fCAHIAt+fCADIAh+IAQgCn58IAUgCX58IAYgC358IAcgDX58IAMgCX4gBCAIfnwgBSALfnwgBiANfnwgByAPfnwiA0IaiEL/////D4N8IgRCGohC/////w+DfCIFQhqIQv////8Pg3wiBkIaiEL/////D4N8IgdCGoinQQVsIAOnQf///x9xaiITQRp2IASnQf///x9xaiESIAWnQf///x9xIREgBqdB////H3EhFSAHp0H///8fcSEUIBNB////H3EhEyABQRBqIQEgAkEQayICQQ9LDQALCyAAIBQ2AiQgACAVNgIgIAAgETYCHCAAIBI2AhggACATNgIUCwMAAQu2BAEGfwJAIAAoAjgiBARAIABBPGohBQJAIAJBECAEayIDIAIgA0kbIgZFDQAgBkEDcSEHAkAgBkEBa0EDSQRAQQAhAwwBCyAGQXxxIQhBACEDA0AgBSADIARqaiABIANqLQAAOgAAIAUgA0EBciIEIAAoAjhqaiABIARqLQAAOgAAIAUgA0ECciIEIAAoAjhqaiABIARqLQAAOgAAIAUgA0EDciIEIAAoAjhqaiABIARqLQAAOgAAIANBBGohAyAAKAI4IQQgCEEEayIIDQALCyAHRQ0AA0AgBSADIARqaiABIANqLQAAOgAAIANBAWohAyAAKAI4IQQgB0EBayIHDQALCyAAIAQgBmoiAzYCOCADQRBJDQEgACAFQRAQAiAAQQA2AjggAiAGayECIAEgBmohAQsgAkEQTwRAIAAgASACQXBxIgMQAiACQQ9xIQIgASADaiEBCyACRQ0AIAJBA3EhBCAAQTxqIQVBACEDIAJBAWtBA08EQCACQXxxIQcDQCAFIAAoAjggA2pqIAEgA2otAAA6AAAgBSADQQFyIgYgACgCOGpqIAEgBmotAAA6AAAgBSADQQJyIgYgACgCOGpqIAEgBmotAAA6AAAgBSADQQNyIgYgACgCOGpqIAEgBmotAAA6AAAgA0EEaiEDIAdBBGsiBw0ACwsgBARAA0AgBSAAKAI4IANqaiABIANqLQAAOgAAIANBAWohAyAEQQFrIgQNAAsLIAAgACgCOCACajYCOAsLoS0BDH8jAEEQayIMJAACQAJAAkACQAJAAkACQAJAAkACQAJAAkAgAEH0AU0EQEGICCgCACIFQRAgAEELakF4cSAAQQtJGyIIQQN2IgJ2IgFBA3EEQCABQX9zQQFxIAJqIgNBA3QiAUG4CGooAgAiBEEIaiEAAkAgBCgCCCICIAFBsAhqIgFGBEBBiAggBUF+IAN3cTYCAAwBCyACIAE2AgwgASACNgIICyAEIANBA3QiAUEDcjYCBCABIARqIgEgASgCBEEBcjYCBAwNCyAIQZAIKAIAIgpNDQEgAQRAAkBBAiACdCIAQQAgAGtyIAEgAnRxIgBBACAAa3FBAWsiACAAQQx2QRBxIgJ2IgFBBXZBCHEiACACciABIAB2IgFBAnZBBHEiAHIgASAAdiIBQQF2QQJxIgByIAEgAHYiAUEBdkEBcSIAciABIAB2aiIDQQN0IgBBuAhqKAIAIgQoAggiASAAQbAIaiIARgRAQYgIIAVBfiADd3EiBTYCAAwBCyABIAA2AgwgACABNgIICyAEQQhqIQAgBCAIQQNyNgIEIAQgCGoiAiADQQN0IgEgCGsiA0EBcjYCBCABIARqIAM2AgAgCgRAIApBA3YiAUEDdEGwCGohB0GcCCgCACEEAn8gBUEBIAF0IgFxRQRAQYgIIAEgBXI2AgAgBwwBCyAHKAIICyEBIAcgBDYCCCABIAQ2AgwgBCAHNgIMIAQgATYCCAtBnAggAjYCAEGQCCADNgIADA0LQYwIKAIAIgZFDQEgBkEAIAZrcUEBayIAIABBDHZBEHEiAnYiAUEFdkEIcSIAIAJyIAEgAHYiAUECdkEEcSIAciABIAB2IgFBAXZBAnEiAHIgASAAdiIBQQF2QQFxIgByIAEgAHZqQQJ0QbgKaigCACIBKAIEQXhxIAhrIQMgASECA0ACQCACKAIQIgBFBEAgAigCFCIARQ0BCyAAKAIEQXhxIAhrIgIgAyACIANJIgIbIQMgACABIAIbIQEgACECDAELCyABIAhqIgkgAU0NAiABKAIYIQsgASABKAIMIgRHBEAgASgCCCIAQZgIKAIASRogACAENgIMIAQgADYCCAwMCyABQRRqIgIoAgAiAEUEQCABKAIQIgBFDQQgAUEQaiECCwNAIAIhByAAIgRBFGoiAigCACIADQAgBEEQaiECIAQoAhAiAA0ACyAHQQA2AgAMCwtBfyEIIABBv39LDQAgAEELaiIAQXhxIQhBjAgoAgAiCUUNAEEAIAhrIQMCQAJAAkACf0EAIAhBgAJJDQAaQR8gCEH///8HSw0AGiAAQQh2IgAgAEGA/j9qQRB2QQhxIgJ0IgAgAEGA4B9qQRB2QQRxIgF0IgAgAEGAgA9qQRB2QQJxIgB0QQ92IAEgAnIgAHJrIgBBAXQgCCAAQRVqdkEBcXJBHGoLIgVBAnRBuApqKAIAIgJFBEBBACEADAELQQAhACAIQQBBGSAFQQF2ayAFQR9GG3QhAQNAAkAgAigCBEF4cSAIayIHIANPDQAgAiEEIAciAw0AQQAhAyACIQAMAwsgACACKAIUIgcgByACIAFBHXZBBHFqKAIQIgJGGyAAIAcbIQAgAUEBdCEBIAINAAsLIAAgBHJFBEBBACEEQQIgBXQiAEEAIABrciAJcSIARQ0DIABBACAAa3FBAWsiACAAQQx2QRBxIgJ2IgFBBXZBCHEiACACciABIAB2IgFBAnZBBHEiAHIgASAAdiIBQQF2QQJxIgByIAEgAHYiAUEBdkEBcSIAciABIAB2akECdEG4CmooAgAhAAsgAEUNAQsDQCAAKAIEQXhxIAhrIgEgA0khAiABIAMgAhshAyAAIAQgAhshBCAAKAIQIgEEfyABBSAAKAIUCyIADQALCyAERQ0AIANBkAgoAgAgCGtPDQAgBCAIaiIGIARNDQEgBCgCGCEFIAQgBCgCDCIBRwRAIAQoAggiAEGYCCgCAEkaIAAgATYCDCABIAA2AggMCgsgBEEUaiICKAIAIgBFBEAgBCgCECIARQ0EIARBEGohAgsDQCACIQcgACIBQRRqIgIoAgAiAA0AIAFBEGohAiABKAIQIgANAAsgB0EANgIADAkLIAhBkAgoAgAiAk0EQEGcCCgCACEDAkAgAiAIayIBQRBPBEBBkAggATYCAEGcCCADIAhqIgA2AgAgACABQQFyNgIEIAIgA2ogATYCACADIAhBA3I2AgQMAQtBnAhBADYCAEGQCEEANgIAIAMgAkEDcjYCBCACIANqIgAgACgCBEEBcjYCBAsgA0EIaiEADAsLIAhBlAgoAgAiBkkEQEGUCCAGIAhrIgE2AgBBoAhBoAgoAgAiAiAIaiIANgIAIAAgAUEBcjYCBCACIAhBA3I2AgQgAkEIaiEADAsLQQAhACAIQS9qIgkCf0HgCygCAARAQegLKAIADAELQewLQn83AgBB5AtCgKCAgICABDcCAEHgCyAMQQxqQXBxQdiq1aoFczYCAEH0C0EANgIAQcQLQQA2AgBBgCALIgFqIgVBACABayIHcSICIAhNDQpBwAsoAgAiBARAQbgLKAIAIgMgAmoiASADTQ0LIAEgBEsNCwtBxAstAABBBHENBQJAAkBBoAgoAgAiAwRAQcgLIQADQCADIAAoAgAiAU8EQCABIAAoAgRqIANLDQMLIAAoAggiAA0ACwtBABABIgFBf0YNBiACIQVB5AsoAgAiA0EBayIAIAFxBEAgAiABayAAIAFqQQAgA2txaiEFCyAFIAhNDQYgBUH+////B0sNBkHACygCACIEBEBBuAsoAgAiAyAFaiIAIANNDQcgACAESw0HCyAFEAEiACABRw0BDAgLIAUgBmsgB3EiBUH+////B0sNBSAFEAEiASAAKAIAIAAoAgRqRg0EIAEhAAsCQCAAQX9GDQAgCEEwaiAFTQ0AQegLKAIAIgEgCSAFa2pBACABa3EiAUH+////B0sEQCAAIQEMCAsgARABQX9HBEAgASAFaiEFIAAhAQwIC0EAIAVrEAEaDAULIAAiAUF/Rw0GDAQLAAtBACEEDAcLQQAhAQwFCyABQX9HDQILQcQLQcQLKAIAQQRyNgIACyACQf7///8HSw0BIAIQASEBQQAQASEAIAFBf0YNASAAQX9GDQEgACABTQ0BIAAgAWsiBSAIQShqTQ0BC0G4C0G4CygCACAFaiIANgIAQbwLKAIAIABJBEBBvAsgADYCAAsCQAJAAkBBoAgoAgAiBwRAQcgLIQADQCABIAAoAgAiAyAAKAIEIgJqRg0CIAAoAggiAA0ACwwCC0GYCCgCACIAQQAgACABTRtFBEBBmAggATYCAAtBACEAQcwLIAU2AgBByAsgATYCAEGoCEF/NgIAQawIQeALKAIANgIAQdQLQQA2AgADQCAAQQN0IgNBuAhqIANBsAhqIgI2AgAgA0G8CGogAjYCACAAQQFqIgBBIEcNAAtBlAggBUEoayIDQXggAWtBB3FBACABQQhqQQdxGyIAayICNgIAQaAIIAAgAWoiADYCACAAIAJBAXI2AgQgASADakEoNgIEQaQIQfALKAIANgIADAILIAAtAAxBCHENACADIAdLDQAgASAHTQ0AIAAgAiAFajYCBEGgCCAHQXggB2tBB3FBACAHQQhqQQdxGyIAaiICNgIAQZQIQZQIKAIAIAVqIgEgAGsiADYCACACIABBAXI2AgQgASAHakEoNgIEQaQIQfALKAIANgIADAELQZgIKAIAIAFLBEBBmAggATYCAAsgASAFaiECQcgLIQACQAJAAkACQAJAAkADQCACIAAoAgBHBEAgACgCCCIADQEMAgsLIAAtAAxBCHFFDQELQcgLIQADQCAHIAAoAgAiAk8EQCACIAAoAgRqIgQgB0sNAwsgACgCCCEADAALAAsgACABNgIAIAAgACgCBCAFajYCBCABQXggAWtBB3FBACABQQhqQQdxG2oiCSAIQQNyNgIEIAJBeCACa0EHcUEAIAJBCGpBB3EbaiIFIAggCWoiBmshAiAFIAdGBEBBoAggBjYCAEGUCEGUCCgCACACaiIANgIAIAYgAEEBcjYCBAwDCyAFQZwIKAIARgRAQZwIIAY2AgBBkAhBkAgoAgAgAmoiADYCACAGIABBAXI2AgQgACAGaiAANgIADAMLIAUoAgQiAEEDcUEBRgRAIABBeHEhBwJAIABB/wFNBEAgBSgCCCIDIABBA3YiAEEDdEGwCGpGGiADIAUoAgwiAUYEQEGICEGICCgCAEF+IAB3cTYCAAwCCyADIAE2AgwgASADNgIIDAELIAUoAhghCAJAIAUgBSgCDCIBRwRAIAUoAggiACABNgIMIAEgADYCCAwBCwJAIAVBFGoiACgCACIDDQAgBUEQaiIAKAIAIgMNAEEAIQEMAQsDQCAAIQQgAyIBQRRqIgAoAgAiAw0AIAFBEGohACABKAIQIgMNAAsgBEEANgIACyAIRQ0AAkAgBSAFKAIcIgNBAnRBuApqIgAoAgBGBEAgACABNgIAIAENAUGMCEGMCCgCAEF+IAN3cTYCAAwCCyAIQRBBFCAIKAIQIAVGG2ogATYCACABRQ0BCyABIAg2AhggBSgCECIABEAgASAANgIQIAAgATYCGAsgBSgCFCIARQ0AIAEgADYCFCAAIAE2AhgLIAUgB2ohBSACIAdqIQILIAUgBSgCBEF+cTYCBCAGIAJBAXI2AgQgAiAGaiACNgIAIAJB/wFNBEAgAkEDdiIAQQN0QbAIaiECAn9BiAgoAgAiAUEBIAB0IgBxRQRAQYgIIAAgAXI2AgAgAgwBCyACKAIICyEAIAIgBjYCCCAAIAY2AgwgBiACNgIMIAYgADYCCAwDC0EfIQAgAkH///8HTQRAIAJBCHYiACAAQYD+P2pBEHZBCHEiA3QiACAAQYDgH2pBEHZBBHEiAXQiACAAQYCAD2pBEHZBAnEiAHRBD3YgASADciAAcmsiAEEBdCACIABBFWp2QQFxckEcaiEACyAGIAA2AhwgBkIANwIQIABBAnRBuApqIQQCQEGMCCgCACIDQQEgAHQiAXFFBEBBjAggASADcjYCACAEIAY2AgAgBiAENgIYDAELIAJBAEEZIABBAXZrIABBH0YbdCEAIAQoAgAhAQNAIAEiAygCBEF4cSACRg0DIABBHXYhASAAQQF0IQAgAyABQQRxaiIEKAIQIgENAAsgBCAGNgIQIAYgAzYCGAsgBiAGNgIMIAYgBjYCCAwCC0GUCCAFQShrIgNBeCABa0EHcUEAIAFBCGpBB3EbIgBrIgI2AgBBoAggACABaiIANgIAIAAgAkEBcjYCBCABIANqQSg2AgRBpAhB8AsoAgA2AgAgByAEQScgBGtBB3FBACAEQSdrQQdxG2pBL2siACAAIAdBEGpJGyICQRs2AgQgAkHQCykCADcCECACQcgLKQIANwIIQdALIAJBCGo2AgBBzAsgBTYCAEHICyABNgIAQdQLQQA2AgAgAkEYaiEAA0AgAEEHNgIEIABBCGohASAAQQRqIQAgASAESQ0ACyACIAdGDQMgAiACKAIEQX5xNgIEIAcgAiAHayIEQQFyNgIEIAIgBDYCACAEQf8BTQRAIARBA3YiAEEDdEGwCGohAgJ/QYgIKAIAIgFBASAAdCIAcUUEQEGICCAAIAFyNgIAIAIMAQsgAigCCAshACACIAc2AgggACAHNgIMIAcgAjYCDCAHIAA2AggMBAtBHyEAIAdCADcCECAEQf///wdNBEAgBEEIdiIAIABBgP4/akEQdkEIcSICdCIAIABBgOAfakEQdkEEcSIBdCIAIABBgIAPakEQdkECcSIAdEEPdiABIAJyIAByayIAQQF0IAQgAEEVanZBAXFyQRxqIQALIAcgADYCHCAAQQJ0QbgKaiEDAkBBjAgoAgAiAkEBIAB0IgFxRQRAQYwIIAEgAnI2AgAgAyAHNgIAIAcgAzYCGAwBCyAEQQBBGSAAQQF2ayAAQR9GG3QhACADKAIAIQEDQCABIgIoAgRBeHEgBEYNBCAAQR12IQEgAEEBdCEAIAIgAUEEcWoiAygCECIBDQALIAMgBzYCECAHIAI2AhgLIAcgBzYCDCAHIAc2AggMAwsgAygCCCIAIAY2AgwgAyAGNgIIIAZBADYCGCAGIAM2AgwgBiAANgIICyAJQQhqIQAMBQsgAigCCCIAIAc2AgwgAiAHNgIIIAdBADYCGCAHIAI2AgwgByAANgIIC0GUCCgCACIAIAhNDQBBlAggACAIayIBNgIAQaAIQaAIKAIAIgIgCGoiADYCACAAIAFBAXI2AgQgAiAIQQNyNgIEIAJBCGohAAwDC0GECEEwNgIAQQAhAAwCCwJAIAVFDQACQCAEKAIcIgJBAnRBuApqIgAoAgAgBEYEQCAAIAE2AgAgAQ0BQYwIIAlBfiACd3EiCTYCAAwCCyAFQRBBFCAFKAIQIARGG2ogATYCACABRQ0BCyABIAU2AhggBCgCECIABEAgASAANgIQIAAgATYCGAsgBCgCFCIARQ0AIAEgADYCFCAAIAE2AhgLAkAgA0EPTQRAIAQgAyAIaiIAQQNyNgIEIAAgBGoiACAAKAIEQQFyNgIEDAELIAQgCEEDcjYCBCAGIANBAXI2AgQgAyAGaiADNgIAIANB/wFNBEAgA0EDdiIAQQN0QbAIaiECAn9BiAgoAgAiAUEBIAB0IgBxRQRAQYgIIAAgAXI2AgAgAgwBCyACKAIICyEAIAIgBjYCCCAAIAY2AgwgBiACNgIMIAYgADYCCAwBC0EfIQAgA0H///8HTQRAIANBCHYiACAAQYD+P2pBEHZBCHEiAnQiACAAQYDgH2pBEHZBBHEiAXQiACAAQYCAD2pBEHZBAnEiAHRBD3YgASACciAAcmsiAEEBdCADIABBFWp2QQFxckEcaiEACyAGIAA2AhwgBkIANwIQIABBAnRBuApqIQICQAJAIAlBASAAdCIBcUUEQEGMCCABIAlyNgIAIAIgBjYCACAGIAI2AhgMAQsgA0EAQRkgAEEBdmsgAEEfRht0IQAgAigCACEIA0AgCCIBKAIEQXhxIANGDQIgAEEddiECIABBAXQhACABIAJBBHFqIgIoAhAiCA0ACyACIAY2AhAgBiABNgIYCyAGIAY2AgwgBiAGNgIIDAELIAEoAggiACAGNgIMIAEgBjYCCCAGQQA2AhggBiABNgIMIAYgADYCCAsgBEEIaiEADAELAkAgC0UNAAJAIAEoAhwiAkECdEG4CmoiACgCACABRgRAIAAgBDYCACAEDQFBjAggBkF+IAJ3cTYCAAwCCyALQRBBFCALKAIQIAFGG2ogBDYCACAERQ0BCyAEIAs2AhggASgCECIABEAgBCAANgIQIAAgBDYCGAsgASgCFCIARQ0AIAQgADYCFCAAIAQ2AhgLAkAgA0EPTQRAIAEgAyAIaiIAQQNyNgIEIAAgAWoiACAAKAIEQQFyNgIEDAELIAEgCEEDcjYCBCAJIANBAXI2AgQgAyAJaiADNgIAIAoEQCAKQQN2IgBBA3RBsAhqIQRBnAgoAgAhAgJ/QQEgAHQiACAFcUUEQEGICCAAIAVyNgIAIAQMAQsgBCgCCAshACAEIAI2AgggACACNgIMIAIgBDYCDCACIAA2AggLQZwIIAk2AgBBkAggAzYCAAsgAUEIaiEACyAMQRBqJAAgAAsQACMAIABrQXBxIgAkACAACwYAIAAkAAsEACMAC4AJAgh/BH4jAEGQAWsiBiQAIAYgBS0AA0EYdEGAgIAYcSAFLwAAIAUtAAJBEHRycjYCACAGIAUoAANBAnZBg/7/H3E2AgQgBiAFKAAGQQR2Qf+B/x9xNgIIIAYgBSgACUEGdkH//8AfcTYCDCAFLwANIQggBS0ADyEJIAZCADcCFCAGQgA3AhwgBkEANgIkIAYgCCAJQRB0QYCAPHFyNgIQIAYgBSgAEDYCKCAGIAUoABQ2AiwgBiAFKAAYNgIwIAUoABwhBSAGQQA6AEwgBkEANgI4IAYgBTYCNCAGIAEgAhAEIAQEQCAGIAMgBBAECyAGKAI4IgEEQCAGQTxqIgIgAWpBAToAACABQQFqQQ9NBEAgASAGakE9aiEEAkBBDyABayIDRQ0AIAMgBGoiAUEBa0EAOgAAIARBADoAACADQQNJDQAgAUECa0EAOgAAIARBADoAASABQQNrQQA6AAAgBEEAOgACIANBB0kNACABQQRrQQA6AAAgBEEAOgADIANBCUkNACAEQQAgBGtBA3EiAWoiBEEANgIAIAQgAyABa0F8cSIBaiIDQQRrQQA2AgAgAUEJSQ0AIARBADYCCCAEQQA2AgQgA0EIa0EANgIAIANBDGtBADYCACABQRlJDQAgBEEANgIYIARBADYCFCAEQQA2AhAgBEEANgIMIANBEGtBADYCACADQRRrQQA2AgAgA0EYa0EANgIAIANBHGtBADYCACABIARBBHFBGHIiAWsiA0EgSQ0AIAEgBGohAQNAIAFCADcDGCABQgA3AxAgAUIANwMIIAFCADcDACABQSBqIQEgA0EgayIDQR9LDQALCwsgBkEBOgBMIAYgAkEQEAILIAY1AjQhECAGNQIwIREgBjUCLCEOIAAgBjUCKCAGKAIkIAYoAiAgBigCHCAGKAIYIgNBGnZqIgJBGnZqIgFBGnZqIgtBgICAYHIgAUH///8fcSINIAJB////H3EiCCAGKAIUIAtBGnZBBWxqIgFB////H3EiCUEFaiIFQRp2IANB////H3EgAUEadmoiA2oiAUEadmoiAkEadmoiBEEadmoiDEEfdSIHIANxIAEgDEEfdkEBayIDQf///x9xIgpxciIBQRp0IAUgCnEgByAJcXJyrXwiDzwAACAAIA9CGIg8AAMgACAPQhCIPAACIAAgD0IIiDwAASAAIA4gByAIcSACIApxciICQRR0IAFBBnZyrXwgD0IgiHwiDjwABCAAIA5CGIg8AAcgACAOQhCIPAAGIAAgDkIIiDwABSAAIBEgByANcSAEIApxciIBQQ50IAJBDHZyrXwgDkIgiHwiDjwACCAAIA5CGIg8AAsgACAOQhCIPAAKIAAgDkIIiDwACSAAIBAgAyAMcSAHIAtxckEIdCABQRJ2cq18IA5CIIh8Ig48AAwgACAOQhiIPAAPIAAgDkIQiDwADiAAIA5CCIg8AA0gBkIANwIwIAZCADcCKCAGQgA3AiAgBkIANwIYIAZCADcCECAGQgA3AgggBkIANwIAIAZBkAFqJAALpwwBB38CQCAARQ0AIABBCGsiAyAAQQRrKAIAIgFBeHEiAGohBQJAIAFBAXENACABQQNxRQ0BIAMgAygCACIBayIDQZgIKAIASQ0BIAAgAWohACADQZwIKAIARwRAIAFB/wFNBEAgAygCCCICIAFBA3YiBEEDdEGwCGpGGiACIAMoAgwiAUYEQEGICEGICCgCAEF+IAR3cTYCAAwDCyACIAE2AgwgASACNgIIDAILIAMoAhghBgJAIAMgAygCDCIBRwRAIAMoAggiAiABNgIMIAEgAjYCCAwBCwJAIANBFGoiAigCACIEDQAgA0EQaiICKAIAIgQNAEEAIQEMAQsDQCACIQcgBCIBQRRqIgIoAgAiBA0AIAFBEGohAiABKAIQIgQNAAsgB0EANgIACyAGRQ0BAkAgAyADKAIcIgJBAnRBuApqIgQoAgBGBEAgBCABNgIAIAENAUGMCEGMCCgCAEF+IAJ3cTYCAAwDCyAGQRBBFCAGKAIQIANGG2ogATYCACABRQ0CCyABIAY2AhggAygCECICBEAgASACNgIQIAIgATYCGAsgAygCFCICRQ0BIAEgAjYCFCACIAE2AhgMAQsgBSgCBCIBQQNxQQNHDQBBkAggADYCACAFIAFBfnE2AgQgAyAAQQFyNgIEIAAgA2ogADYCAA8LIAMgBU8NACAFKAIEIgFBAXFFDQACQCABQQJxRQRAIAVBoAgoAgBGBEBBoAggAzYCAEGUCEGUCCgCACAAaiIANgIAIAMgAEEBcjYCBCADQZwIKAIARw0DQZAIQQA2AgBBnAhBADYCAA8LIAVBnAgoAgBGBEBBnAggAzYCAEGQCEGQCCgCACAAaiIANgIAIAMgAEEBcjYCBCAAIANqIAA2AgAPCyABQXhxIABqIQACQCABQf8BTQRAIAUoAggiAiABQQN2IgRBA3RBsAhqRhogAiAFKAIMIgFGBEBBiAhBiAgoAgBBfiAEd3E2AgAMAgsgAiABNgIMIAEgAjYCCAwBCyAFKAIYIQYCQCAFIAUoAgwiAUcEQCAFKAIIIgJBmAgoAgBJGiACIAE2AgwgASACNgIIDAELAkAgBUEUaiICKAIAIgQNACAFQRBqIgIoAgAiBA0AQQAhAQwBCwNAIAIhByAEIgFBFGoiAigCACIEDQAgAUEQaiECIAEoAhAiBA0ACyAHQQA2AgALIAZFDQACQCAFIAUoAhwiAkECdEG4CmoiBCgCAEYEQCAEIAE2AgAgAQ0BQYwIQYwIKAIAQX4gAndxNgIADAILIAZBEEEUIAYoAhAgBUYbaiABNgIAIAFFDQELIAEgBjYCGCAFKAIQIgIEQCABIAI2AhAgAiABNgIYCyAFKAIUIgJFDQAgASACNgIUIAIgATYCGAsgAyAAQQFyNgIEIAAgA2ogADYCACADQZwIKAIARw0BQZAIIAA2AgAPCyAFIAFBfnE2AgQgAyAAQQFyNgIEIAAgA2ogADYCAAsgAEH/AU0EQCAAQQN2IgFBA3RBsAhqIQACf0GICCgCACICQQEgAXQiAXFFBEBBiAggASACcjYCACAADAELIAAoAggLIQIgACADNgIIIAIgAzYCDCADIAA2AgwgAyACNgIIDwtBHyECIANCADcCECAAQf///wdNBEAgAEEIdiIBIAFBgP4/akEQdkEIcSIBdCICIAJBgOAfakEQdkEEcSICdCIEIARBgIAPakEQdkECcSIEdEEPdiABIAJyIARyayIBQQF0IAAgAUEVanZBAXFyQRxqIQILIAMgAjYCHCACQQJ0QbgKaiEBAkACQAJAQYwIKAIAIgRBASACdCIHcUUEQEGMCCAEIAdyNgIAIAEgAzYCACADIAE2AhgMAQsgAEEAQRkgAkEBdmsgAkEfRht0IQIgASgCACEBA0AgASIEKAIEQXhxIABGDQIgAkEddiEBIAJBAXQhAiAEIAFBBHFqIgdBEGooAgAiAQ0ACyAHIAM2AhAgAyAENgIYCyADIAM2AgwgAyADNgIIDAELIAQoAggiACADNgIMIAQgAzYCCCADQQA2AhggAyAENgIMIAMgADYCCAtBqAhBqAgoAgBBAWsiAEF/IAAbNgIACwsLCQEAQYEICwIGUA==",!pe.startsWith(Ae)){var Ee=pe;pe=e.locateFile?e.locateFile(Ee,h):h+Ee}function dt(){var K=pe;try{if(K==pe&&C)return new Uint8Array(C);var fe=En(K);if(fe)return fe;if(_)return _(K);throw"both async and sync fetching of the wasm failed"}catch(xe){V(xe)}}function vt(){if(!C&&(f||a)){if(typeof fetch=="function"&&!pe.startsWith("file://"))return fetch(pe,{credentials:"same-origin"}).then(function(K){if(!K.ok)throw"failed to load wasm binary file at '"+pe+"'";return K.arrayBuffer()}).catch(function(){return dt()});if(A)return new Promise(function(K,fe){A(pe,function(xe){K(new Uint8Array(xe))},fe)})}return Promise.resolve().then(function(){return dt()})}function Rr(K){for(;0<K.length;){var fe=K.shift();if(typeof fe=="function")fe(e);else{var xe=fe.m;typeof xe=="number"?fe.l===void 0?se.get(xe)():se.get(xe)(fe.l):xe(fe.l===void 0?null:fe.l)}}}var jn=!1,Vn=typeof atob=="function"?atob:function(K){var fe="",xe=0;K=K.replace(/[^A-Za-z0-9\+\/=]/g,"");do{var Ne="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(K.charAt(xe++)),je="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(K.charAt(xe++)),wt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(K.charAt(xe++)),an="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(K.charAt(xe++));Ne=Ne<<2|je>>4,je=(je&15)<<4|wt>>2;var $t=(wt&3)<<6|an;fe+=String.fromCharCode(Ne),wt!==64&&(fe+=String.fromCharCode(je)),an!==64&&(fe+=String.fromCharCode($t))}while(xe<K.length);return fe};function En(K){if(K.startsWith(Ae)){if(K=K.slice(Ae.length),typeof u=="boolean"&&u){var fe=Buffer.from(K,"base64");fe=new Uint8Array(fe.buffer,fe.byteOffset,fe.byteLength)}else try{var xe=Vn(K),Ne=new Uint8Array(xe.length);for(K=0;K<xe.length;++K)Ne[K]=xe.charCodeAt(K);fe=Ne}catch{throw Error("Converting base64 string to bytes failed.")}return fe}}var zn={a:function(K){var fe=q.length;if(K>>>=0,2147483648<K)return!1;for(var xe=1;4>=xe;xe*=2){var Ne=fe*(1+.2/xe);Ne=Math.min(Ne,K+100663296),Ne=Math.max(K,Ne),0<Ne%65536&&(Ne+=65536-Ne%65536);e:{try{X.grow(Math.min(2147483648,Ne)-S.byteLength+65535>>>16),H();var je=1;break e}catch{}je=void 0}if(je)return!0}return!1}};(function(){function K(je){e.asm=je.exports,X=e.asm.b,H(),se=e.asm.j,Z.unshift(e.asm.c),T--,e.monitorRunDependencies&&e.monitorRunDependencies(T),T==0&&(M!==null&&(clearInterval(M),M=null),F&&(je=F,F=null,je()))}function fe(je){K(je.instance)}function xe(je){return vt().then(function(wt){return WebAssembly.instantiate(wt,Ne)}).then(je,function(wt){w("failed to asynchronously prepare wasm: "+wt),V(wt)})}var Ne={a:zn};if(T++,e.monitorRunDependencies&&e.monitorRunDependencies(T),e.instantiateWasm)try{return e.instantiateWasm(Ne,K)}catch(je){return w("Module.instantiateWasm callback failed with error: "+je),!1}return function(){return C||typeof WebAssembly.instantiateStreaming!="function"||pe.startsWith(Ae)||pe.startsWith("file://")||typeof fetch!="function"?xe(fe):fetch(pe,{credentials:"same-origin"}).then(function(je){return WebAssembly.instantiateStreaming(je,Ne).then(fe,function(wt){return w("wasm streaming compile failed: "+wt),w("falling back to ArrayBuffer instantiation"),xe(fe)})})}().catch(i),{}})(),e.___wasm_call_ctors=function(){return(e.___wasm_call_ctors=e.asm.c).apply(null,arguments)},e._poly1305_auth=function(){return(e._poly1305_auth=e.asm.d).apply(null,arguments)};var kr=e.stackSave=function(){return(kr=e.stackSave=e.asm.e).apply(null,arguments)},li=e.stackRestore=function(){return(li=e.stackRestore=e.asm.f).apply(null,arguments)},Nr=e.stackAlloc=function(){return(Nr=e.stackAlloc=e.asm.g).apply(null,arguments)};e._malloc=function(){return(e._malloc=e.asm.h).apply(null,arguments)},e._free=function(){return(e._free=e.asm.i).apply(null,arguments)},e.cwrap=function(K,fe,xe,Ne){xe=xe||[];var je=xe.every(function(wt){return wt==="number"});return fe!=="string"&&je&&!Ne?ne(K):function(){return J(K,fe,xe,arguments)}};var Jn;F=function K(){Jn||Zn(),Jn||(F=K)};function Zn(){function K(){if(!Jn&&(Jn=!0,e.calledRun=!0,!L)){if(Rr(Z),r(e),e.onRuntimeInitialized&&e.onRuntimeInitialized(),e.postRun)for(typeof e.postRun=="function"&&(e.postRun=[e.postRun]);e.postRun.length;){var fe=e.postRun.shift();re.unshift(fe)}Rr(re)}}if(!(0<T)){if(e.preRun)for(typeof e.preRun=="function"&&(e.preRun=[e.preRun]);e.preRun.length;)oe();Rr(te),0<T||(e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),K()},1)):K())}}if(e.run=Zn,e.preInit)for(typeof e.preInit=="function"&&(e.preInit=[e.preInit]);0<e.preInit.length;)e.preInit.pop()();return Zn(),t.ready}}();typeof Ui=="object"&&typeof Ks=="object"?Ks.exports=qs:typeof define=="function"&&define.amd?define([],function(){return qs}):typeof Ui=="object"&&(Ui.createPoly1305=qs)});var Nn=ze((WA,ya)=>{"use strict";var{createCipheriv:lr,createDecipheriv:Pi,createHmac:Ws,randomFillSync:Gn,timingSafeEqual:Gs}=require("crypto"),{readUInt32BE:qr,writeUInt32BE:jt}=rn(),Tn=Buffer[Symbol.species],pa=2**32-1,ba=Buffer.alloc(0),hr=Buffer.alloc(4),Di=new Map,Yn=35e3,Ys,fo,ao,co,uo,ho,lo;try{Ys=require("./crypto/build/Release/sshcrypto.node"),{AESGCMCipher:fo,ChaChaPolyCipher:ao,GenericCipher:co,AESGCMDecipher:uo,ChaChaPolyDecipher:ho,GenericDecipher:lo}=Ys}catch{}var Tt=1<<0,Kh=(()=>{function n(t,e,r,i,s,o,f){return{sslName:t,blockLen:e,keyLen:r,ivLen:i!==0||f&Tt?i:e,authLen:s,discardLen:o,stream:!!(f&Tt)}}return{"chacha20-poly1305@openssh.com":n("chacha20",8,64,0,16,0,Tt),"aes128-gcm":n("aes-128-gcm",16,16,12,16,0,Tt),"aes256-gcm":n("aes-256-gcm",16,32,12,16,0,Tt),"aes128-gcm@openssh.com":n("aes-128-gcm",16,16,12,16,0,Tt),"aes256-gcm@openssh.com":n("aes-256-gcm",16,32,12,16,0,Tt),"aes128-cbc":n("aes-128-cbc",16,16,0,0,0,0),"aes192-cbc":n("aes-192-cbc",16,24,0,0,0,0),"aes256-cbc":n("aes-256-cbc",16,32,0,0,0,0),"rijndael-cbc@lysator.liu.se":n("aes-256-cbc",16,32,0,0,0,0),"3des-cbc":n("des-ede3-cbc",8,24,0,0,0,0),"blowfish-cbc":n("bf-cbc",8,16,0,0,0,0),"idea-cbc":n("idea-cbc",8,16,0,0,0,0),"cast128-cbc":n("cast-cbc",8,16,0,0,0,0),"aes128-ctr":n("aes-128-ctr",16,16,16,0,0,Tt),"aes192-ctr":n("aes-192-ctr",16,24,16,0,0,Tt),"aes256-ctr":n("aes-256-ctr",16,32,16,0,0,Tt),"3des-ctr":n("des-ede3",8,24,8,0,0,Tt),"blowfish-ctr":n("bf-ecb",8,16,8,0,0,Tt),"cast128-ctr":n("cast5-ecb",8,16,8,0,0,Tt),arcfour:n("rc4",8,16,0,0,1536,Tt),arcfour128:n("rc4",8,16,0,0,1536,Tt),arcfour256:n("rc4",8,32,0,0,1536,Tt),arcfour512:n("rc4",8,64,0,0,1536,Tt)}})(),Wh=(()=>{function n(t,e,r,i){return{sslName:t,len:e,actualLen:r,isETM:i}}return{"hmac-md5":n("md5",16,16,!1),"hmac-md5-96":n("md5",16,12,!1),"hmac-ripemd160":n("ripemd160",20,20,!1),"hmac-sha1":n("sha1",20,20,!1),"hmac-sha1-etm@openssh.com":n("sha1",20,20,!0),"hmac-sha1-96":n("sha1",20,12,!1),"hmac-sha2-256":n("sha256",32,32,!1),"hmac-sha2-256-etm@openssh.com":n("sha256",32,32,!0),"hmac-sha2-256-96":n("sha256",32,12,!1),"hmac-sha2-512":n("sha512",64,64,!1),"hmac-sha2-512-etm@openssh.com":n("sha512",64,64,!0),"hmac-sha2-512-96":n("sha512",64,12,!1)}})(),$s=class{constructor(t,e){this.outSeqno=t,this._onWrite=e,this._dead=!1}free(){this._dead=!0}allocPacket(t){let e=5+t,r=8-(e&8-1);r<4&&(r+=8),e+=r;let i=Buffer.allocUnsafe(e);return jt(i,e-4,0),i[4]=r,Gn(i,5+t,r),i}encrypt(t){this._dead||(this._onWrite(t),this.outSeqno=this.outSeqno+1>>>0)}},Ia=Buffer.alloc(32),Kt=Buffer.alloc(16),Mr,Kr,Ao,Xs=class{constructor(t){let e=t.outbound;this.outSeqno=e.seqno,this._onWrite=e.onWrite,this._encKeyMain=e.cipherKey.slice(0,32),this._encKeyPktLen=e.cipherKey.slice(32),this._dead=!1}free(){this._dead=!0}allocPacket(t){let e=5+t,r=8-(e-4&8-1);r<4&&(r+=8),e+=r;let i=Buffer.allocUnsafe(e);return jt(i,e-4,0),i[4]=r,Gn(i,5+t,r),i}encrypt(t){if(this._dead)return;Kt[0]=0,jt(Kt,this.outSeqno,12);let e=lr("chacha20",this._encKeyMain,Kt).update(Ia),r=lr("chacha20",this._encKeyPktLen,Kt).update(t.slice(0,4));this._onWrite(r),Kt[0]=1;let i=lr("chacha20",this._encKeyMain,Kt).update(t.slice(4));this._onWrite(i),Ao(Kr,r,r.length,i,i.length,e);let s=Buffer.allocUnsafe(16);s.set(new Uint8Array(Mr.HEAPU8.buffer,Kr,16),0),this._onWrite(s),this.outSeqno=this.outSeqno+1>>>0}},js=class{constructor(t){let e=t.outbound;this.outSeqno=e.seqno,this._onWrite=e.onWrite,this._instance=new ao(e.cipherKey),this._dead=!1}free(){this._dead=!0,this._instance.free()}allocPacket(t){let e=5+t,r=8-(e-4&8-1);r<4&&(r+=8),e+=r;let i=Buffer.allocUnsafe(e+16);return jt(i,e-4,0),i[4]=r,Gn(i,5+t,r),i}encrypt(t){this._dead||(this._instance.encrypt(t,this.outSeqno),this._onWrite(t),this.outSeqno=this.outSeqno+1>>>0)}},Vs=class{constructor(t){let e=t.outbound;this.outSeqno=e.seqno,this._onWrite=e.onWrite,this._encSSLName=e.cipherInfo.sslName,this._encKey=e.cipherKey,this._encIV=e.cipherIV,this._dead=!1}free(){this._dead=!0}allocPacket(t){let e=5+t,r=16-(e-4&16-1);r<4&&(r+=16),e+=r;let i=Buffer.allocUnsafe(e);return jt(i,e-4,0),i[4]=r,Gn(i,5+t,r),i}encrypt(t){if(this._dead)return;let e=lr(this._encSSLName,this._encKey,this._encIV);e.setAutoPadding(!1);let r=t.slice(0,4);e.setAAD(r),this._onWrite(r);let i=e.update(t.slice(4));this._onWrite(i);let s=e.final();s.length&&this._onWrite(s);let o=e.getAuthTag();this._onWrite(o),xa(this._encIV),this.outSeqno=this.outSeqno+1>>>0}},zs=class{constructor(t){let e=t.outbound;this.outSeqno=e.seqno,this._onWrite=e.onWrite,this._instance=new fo(e.cipherInfo.sslName,e.cipherKey,e.cipherIV),this._dead=!1}free(){this._dead=!0,this._instance.free()}allocPacket(t){let e=5+t,r=16-(e-4&16-1);r<4&&(r+=16),e+=r;let i=Buffer.allocUnsafe(e+16);return jt(i,e-4,0),i[4]=r,Gn(i,5+t,r),i}encrypt(t){this._dead||(this._instance.encrypt(t),this._onWrite(t),this.outSeqno=this.outSeqno+1>>>0)}},Js=class{constructor(t){let e=t.outbound;this.outSeqno=e.seqno,this._onWrite=e.onWrite,this._encBlockLen=e.cipherInfo.blockLen,this._cipherInstance=lr(e.cipherInfo.sslName,e.cipherKey,e.cipherIV),this._macSSLName=e.macInfo.sslName,this._macKey=e.macKey,this._macActualLen=e.macInfo.actualLen,this._macETM=e.macInfo.isETM,this._aadLen=this._macETM?4:0,this._dead=!1;let r=e.cipherInfo.discardLen;if(r){let i=Di.get(r);i===void 0&&(i=Buffer.alloc(r),Di.set(r,i)),this._cipherInstance.update(i)}}free(){this._dead=!0}allocPacket(t){let e=this._encBlockLen,r=4+1+t,i=e-(r-this._aadLen&e-1);i<4&&(i+=e),r+=i;let s=Buffer.allocUnsafe(r);return jt(s,r-4,0),s[4]=i,Gn(s,5+t,i),s}encrypt(t){if(this._dead)return;let e;if(this._macETM){let i=new Uint8Array(t.buffer,t.byteOffset,4),s=this._cipherInstance.update(new Uint8Array(t.buffer,t.byteOffset+4,t.length-4));this._onWrite(i),this._onWrite(s),e=Ws(this._macSSLName,this._macKey),jt(hr,this.outSeqno,0),e.update(hr),e.update(i),e.update(s)}else{let i=this._cipherInstance.update(t);this._onWrite(i),e=Ws(this._macSSLName,this._macKey),jt(hr,this.outSeqno,0),e.update(hr),e.update(t)}let r=e.digest();r.length>this._macActualLen&&(r=r.slice(0,this._macActualLen)),this._onWrite(r),this.outSeqno=this.outSeqno+1>>>0}},Zs=class{constructor(t){let e=t.outbound;this.outSeqno=e.seqno,this._onWrite=e.onWrite,this._encBlockLen=e.cipherInfo.blockLen,this._macLen=e.macInfo.len,this._macActualLen=e.macInfo.actualLen,this._aadLen=e.macInfo.isETM?4:0,this._instance=new co(e.cipherInfo.sslName,e.cipherKey,e.cipherIV,e.macInfo.sslName,e.macKey,e.macInfo.isETM),this._dead=!1}free(){this._dead=!0,this._instance.free()}allocPacket(t){let e=this._encBlockLen,r=4+1+t,i=e-(r-this._aadLen&e-1);i<4&&(i+=e),r+=i;let s=Buffer.allocUnsafe(r+this._macLen);return jt(s,r-4,0),s[4]=i,Gn(s,5+t,i),s}encrypt(t){this._dead||(this._instance.encrypt(t,this.outSeqno),this._macActualLen<this._macLen&&(t=new Tn(t.buffer,t.byteOffset,t.length-(this._macLen-this._macActualLen))),this._onWrite(t),this.outSeqno=this.outSeqno+1>>>0)}},eo=class{constructor(t,e){this.inSeqno=t,this._onPayload=e,this._len=0,this._lenBytes=0,this._packet=null,this._packetPos=0}free(){}decrypt(t,e,r){for(;e<r;){if(this._lenBytes<4){let s=Math.min(4-this._lenBytes,r-e);for(this._lenBytes+=s;s--;)this._len=(this._len<<8)+t[e++];if(this._lenBytes<4)return;if(this._len>Yn||this._len<8||4+this._len&7)throw new Error("Bad packet length");if(e>=r)return}if(this._packetPos<this._len){let s=Math.min(this._len-this._packetPos,r-e),o;if(e!==0||s!==r?o=new Uint8Array(t.buffer,t.byteOffset+e,s):o=t,s===this._len?this._packet=o:(this._packet||(this._packet=Buffer.allocUnsafe(this._len)),this._packet.set(o,this._packetPos)),e+=s,this._packetPos+=s,this._packetPos<this._len)return}let i=this._packet?new Tn(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1):ba;this.inSeqno=this.inSeqno+1>>>0,this._len=0,this._lenBytes=0,this._packet=null,this._packetPos=0;{let s=this._onPayload(i);if(s!==void 0)return s===!1?e:s}}}},to=class{constructor(t){let e=t.inbound;this.inSeqno=e.seqno,this._onPayload=e.onPayload,this._decKeyMain=e.decipherKey.slice(0,32),this._decKeyPktLen=e.decipherKey.slice(32),this._len=0,this._lenBuf=Buffer.alloc(4),this._lenPos=0,this._packet=null,this._pktLen=0,this._mac=Buffer.allocUnsafe(16),this._calcMac=Buffer.allocUnsafe(16),this._macPos=0}free(){}decrypt(t,e,r){for(;e<r;){if(this._lenPos<4){let f=Math.min(4-this._lenPos,r-e);for(;f--;)this._lenBuf[this._lenPos++]=t[e++];if(this._lenPos<4)return;Kt[0]=0,jt(Kt,this.inSeqno,12);let a=Pi("chacha20",this._decKeyPktLen,Kt).update(this._lenBuf);if(this._len=qr(a,0),this._len>Yn||this._len<8||this._len&7)throw new Error("Bad packet length")}if(this._pktLen<this._len){if(e>=r)return;let f=Math.min(this._len-this._pktLen,r-e),a;if(e!==0||f!==r?a=new Uint8Array(t.buffer,t.byteOffset+e,f):a=t,f===this._len?this._packet=a:(this._packet||(this._packet=Buffer.allocUnsafe(this._len)),this._packet.set(a,this._pktLen)),e+=f,this._pktLen+=f,this._pktLen<this._len||e>=r)return}{let f=Math.min(16-this._macPos,r-e);if(e!==0||f!==r?this._mac.set(new Uint8Array(t.buffer,t.byteOffset+e,f),this._macPos):this._mac.set(t,this._macPos),e+=f,this._macPos+=f,this._macPos<16)return}Kt[0]=0,jt(Kt,this.inSeqno,12);let i=lr("chacha20",this._decKeyMain,Kt).update(Ia);if(Ao(Kr,this._lenBuf,4,this._packet,this._packet.length,i),this._calcMac.set(new Uint8Array(Mr.HEAPU8.buffer,Kr,16),0),!Gs(this._calcMac,this._mac))throw new Error("Invalid MAC");Kt[0]=1;let s=Pi("chacha20",this._decKeyMain,Kt).update(this._packet),o=new Tn(s.buffer,s.byteOffset+1,s.length-s[0]-1);this.inSeqno=this.inSeqno+1>>>0,this._len=0,this._lenPos=0,this._packet=null,this._pktLen=0,this._macPos=0;{let f=this._onPayload(o);if(f!==void 0)return f===!1?e:f}}}},no=class{constructor(t){let e=t.inbound;this.inSeqno=e.seqno,this._onPayload=e.onPayload,this._instance=new ho(e.decipherKey),this._len=0,this._lenBuf=Buffer.alloc(4),this._lenPos=0,this._packet=null,this._pktLen=0,this._mac=Buffer.allocUnsafe(16),this._macPos=0}free(){this._instance.free()}decrypt(t,e,r){for(;e<r;){if(this._lenPos<4){let s=Math.min(4-this._lenPos,r-e);for(;s--;)this._lenBuf[this._lenPos++]=t[e++];if(this._lenPos<4)return;if(this._len=this._instance.decryptLen(this._lenBuf,this.inSeqno),this._len>Yn||this._len<8||this._len&7)throw new Error("Bad packet length");if(e>=r)return}if(this._pktLen<this._len){let s=Math.min(this._len-this._pktLen,r-e),o;if(e!==0||s!==r?o=new Uint8Array(t.buffer,t.byteOffset+e,s):o=t,s===this._len?this._packet=o:(this._packet||(this._packet=Buffer.allocUnsafe(this._len)),this._packet.set(o,this._pktLen)),e+=s,this._pktLen+=s,this._pktLen<this._len||e>=r)return}{let s=Math.min(16-this._macPos,r-e);if(e!==0||s!==r?this._mac.set(new Uint8Array(t.buffer,t.byteOffset+e,s),this._macPos):this._mac.set(t,this._macPos),e+=s,this._macPos+=s,this._macPos<16)return}this._instance.decrypt(this._packet,this._mac,this.inSeqno);let i=new Tn(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1);this.inSeqno=this.inSeqno+1>>>0,this._len=0,this._lenPos=0,this._packet=null,this._pktLen=0,this._macPos=0;{let s=this._onPayload(i);if(s!==void 0)return s===!1?e:s}}}},ro=class{constructor(t){let e=t.inbound;this.inSeqno=e.seqno,this._onPayload=e.onPayload,this._decipherInstance=null,this._decipherSSLName=e.decipherInfo.sslName,this._decipherKey=e.decipherKey,this._decipherIV=e.decipherIV,this._len=0,this._lenBytes=0,this._packet=null,this._packetPos=0,this._pktLen=0,this._tag=Buffer.allocUnsafe(16),this._tagPos=0}free(){}decrypt(t,e,r){for(;e<r;){if(this._lenBytes<4){let s=Math.min(4-this._lenBytes,r-e);for(this._lenBytes+=s;s--;)this._len=(this._len<<8)+t[e++];if(this._lenBytes<4)return;if(this._len+20>Yn||this._len<16||this._len&15)throw new Error("Bad packet length");this._decipherInstance=Pi(this._decipherSSLName,this._decipherKey,this._decipherIV),this._decipherInstance.setAutoPadding(!1),this._decipherInstance.setAAD(Gh(this._len))}if(this._pktLen<this._len){if(e>=r)return;let s=Math.min(this._len-this._pktLen,r-e),o;if(e!==0||s!==r?o=this._decipherInstance.update(new Uint8Array(t.buffer,t.byteOffset+e,s)):o=this._decipherInstance.update(t),o.length&&(s===this._len?this._packet=o:(this._packet||(this._packet=Buffer.allocUnsafe(this._len)),this._packet.set(o,this._packetPos)),this._packetPos+=o.length),e+=s,this._pktLen+=s,this._pktLen<this._len||e>=r)return}{let s=Math.min(16-this._tagPos,r-e);if(e!==0||s!==r?this._tag.set(new Uint8Array(t.buffer,t.byteOffset+e,s),this._tagPos):this._tag.set(t,this._tagPos),e+=s,this._tagPos+=s,this._tagPos<16)return}{this._decipherInstance.setAuthTag(this._tag);let s=this._decipherInstance.final();s.length&&(this._packet?this._packet.set(s,this._packetPos):this._packet=s)}let i=this._packet?new Tn(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1):ba;this.inSeqno=this.inSeqno+1>>>0,xa(this._decipherIV),this._len=0,this._lenBytes=0,this._packet=null,this._packetPos=0,this._pktLen=0,this._tagPos=0;{let s=this._onPayload(i);if(s!==void 0)return s===!1?e:s}}}},io=class{constructor(t){let e=t.inbound;this.inSeqno=e.seqno,this._onPayload=e.onPayload,this._instance=new uo(e.decipherInfo.sslName,e.decipherKey,e.decipherIV),this._len=0,this._lenBytes=0,this._packet=null,this._pktLen=0,this._tag=Buffer.allocUnsafe(16),this._tagPos=0}free(){}decrypt(t,e,r){for(;e<r;){if(this._lenBytes<4){let s=Math.min(4-this._lenBytes,r-e);for(this._lenBytes+=s;s--;)this._len=(this._len<<8)+t[e++];if(this._lenBytes<4)return;if(this._len+20>Yn||this._len<16||this._len&15)throw new Error(`Bad packet length: ${this._len}`)}if(this._pktLen<this._len){if(e>=r)return;let s=Math.min(this._len-this._pktLen,r-e),o;if(e!==0||s!==r?o=new Uint8Array(t.buffer,t.byteOffset+e,s):o=t,s===this._len?this._packet=o:(this._packet||(this._packet=Buffer.allocUnsafe(this._len)),this._packet.set(o,this._pktLen)),e+=s,this._pktLen+=s,this._pktLen<this._len||e>=r)return}{let s=Math.min(16-this._tagPos,r-e);if(e!==0||s!==r?this._tag.set(new Uint8Array(t.buffer,t.byteOffset+e,s),this._tagPos):this._tag.set(t,this._tagPos),e+=s,this._tagPos+=s,this._tagPos<16)return}this._instance.decrypt(this._packet,this._len,this._tag);let i=new Tn(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1);this.inSeqno=this.inSeqno+1>>>0,this._len=0,this._lenBytes=0,this._packet=null,this._pktLen=0,this._tagPos=0;{let s=this._onPayload(i);if(s!==void 0)return s===!1?e:s}}}},so=class{constructor(t){let e=t.inbound;this.inSeqno=e.seqno,this._onPayload=e.onPayload,this._decipherInstance=Pi(e.decipherInfo.sslName,e.decipherKey,e.decipherIV),this._decipherInstance.setAutoPadding(!1),this._block=Buffer.allocUnsafe(e.macInfo.isETM?4:e.decipherInfo.blockLen),this._blockSize=e.decipherInfo.blockLen,this._blockPos=0,this._len=0,this._packet=null,this._packetPos=0,this._pktLen=0,this._mac=Buffer.allocUnsafe(e.macInfo.actualLen),this._macPos=0,this._macSSLName=e.macInfo.sslName,this._macKey=e.macKey,this._macActualLen=e.macInfo.actualLen,this._macETM=e.macInfo.isETM,this._macInstance=null;let r=e.decipherInfo.discardLen;if(r){let i=Di.get(r);i===void 0&&(i=Buffer.alloc(r),Di.set(r,i)),this._decipherInstance.update(i)}}free(){}decrypt(t,e,r){for(;e<r;){if(this._blockPos<this._block.length){let o=Math.min(this._block.length-this._blockPos,r-e);if(e!==0||o!==r||o<t.length?this._block.set(new Uint8Array(t.buffer,t.byteOffset+e,o),this._blockPos):this._block.set(t,this._blockPos),e+=o,this._blockPos+=o,this._blockPos<this._block.length)return;let f,a;if(this._macETM?this._len=a=qr(this._block,0):(f=this._decipherInstance.update(this._block),this._len=qr(f,0),a=4+this._len-this._blockSize),this._len>Yn||this._len<5||a&this._blockSize-1)throw new Error("Bad packet length");if(this._macInstance=Ws(this._macSSLName,this._macKey),jt(hr,this.inSeqno,0),this._macInstance.update(hr),this._macETM?this._macInstance.update(this._block):(this._macInstance.update(new Uint8Array(f.buffer,f.byteOffset,4)),this._pktLen=f.length-4,this._packetPos=this._pktLen,this._packet=Buffer.allocUnsafe(this._len),this._packet.set(new Uint8Array(f.buffer,f.byteOffset+4,this._packetPos),0)),e>=r)return}if(this._pktLen<this._len){let o=Math.min(this._len-this._pktLen,r-e),f;e!==0||o!==r?f=new Uint8Array(t.buffer,t.byteOffset+e,o):f=t,this._macETM&&this._macInstance.update(f);let a=this._decipherInstance.update(f);if(a.length&&(o===this._len?this._packet=a:(this._packet||(this._packet=Buffer.allocUnsafe(this._len)),this._packet.set(a,this._packetPos)),this._packetPos+=a.length),e+=o,this._pktLen+=o,this._pktLen<this._len||e>=r)return}{let o=Math.min(this._macActualLen-this._macPos,r-e);if(e!==0||o!==r?this._mac.set(new Uint8Array(t.buffer,t.byteOffset+e,o),this._macPos):this._mac.set(t,this._macPos),e+=o,this._macPos+=o,this._macPos<this._macActualLen)return}this._macETM||this._macInstance.update(this._packet);let i=this._macInstance.digest();if(this._macActualLen<i.length&&(i=new Uint8Array(i.buffer,i.byteOffset,this._macActualLen)),!Yh(i,this._mac))throw new Error("Invalid MAC");let s=new Tn(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1);this.inSeqno=this.inSeqno+1>>>0,this._blockPos=0,this._len=0,this._packet=null,this._packetPos=0,this._pktLen=0,this._macPos=0,this._macInstance=null;{let o=this._onPayload(s);if(o!==void 0)return o===!1?e:o}}}},oo=class{constructor(t){let e=t.inbound;this.inSeqno=e.seqno,this._onPayload=e.onPayload,this._instance=new lo(e.decipherInfo.sslName,e.decipherKey,e.decipherIV,e.macInfo.sslName,e.macKey,e.macInfo.isETM,e.macInfo.actualLen),this._block=Buffer.allocUnsafe(e.macInfo.isETM||e.decipherInfo.stream?4:e.decipherInfo.blockLen),this._blockPos=0,this._len=0,this._packet=null,this._pktLen=0,this._mac=Buffer.allocUnsafe(e.macInfo.actualLen),this._macPos=0,this._macActualLen=e.macInfo.actualLen,this._macETM=e.macInfo.isETM}free(){this._instance.free()}decrypt(t,e,r){for(;e<r;){if(this._blockPos<this._block.length){let s=Math.min(this._block.length-this._blockPos,r-e);if(e!==0||s!==r||s<t.length?this._block.set(new Uint8Array(t.buffer,t.byteOffset+e,s),this._blockPos):this._block.set(t,this._blockPos),e+=s,this._blockPos+=s,this._blockPos<this._block.length)return;let o;if(this._macETM?this._len=o=qr(this._block,0):(this._instance.decryptBlock(this._block),this._len=qr(this._block,0),o=4+this._len-this._block.length),this._len>Yn||this._len<5||o&this._block.length-1)throw new Error("Bad packet length");if(this._macETM||(this._pktLen=this._block.length-4,this._pktLen&&(this._packet=Buffer.allocUnsafe(this._len),this._packet.set(new Uint8Array(this._block.buffer,this._block.byteOffset+4,this._pktLen),0))),e>=r)return}if(this._pktLen<this._len){let s=Math.min(this._len-this._pktLen,r-e),o;if(e!==0||s!==r?o=new Uint8Array(t.buffer,t.byteOffset+e,s):o=t,s===this._len?this._packet=o:(this._packet||(this._packet=Buffer.allocUnsafe(this._len)),this._packet.set(o,this._pktLen)),e+=s,this._pktLen+=s,this._pktLen<this._len||e>=r)return}{let s=Math.min(this._macActualLen-this._macPos,r-e);if(e!==0||s!==r?this._mac.set(new Uint8Array(t.buffer,t.byteOffset+e,s),this._macPos):this._mac.set(t,this._macPos),e+=s,this._macPos+=s,this._macPos<this._macActualLen)return}this._instance.decrypt(this._packet,this.inSeqno,this._block,this._mac);let i=new Tn(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1);this.inSeqno=this.inSeqno+1>>>0,this._blockPos=0,this._len=0,this._packet=null,this._pktLen=0,this._macPos=0,this._macInstance=null;{let s=this._onPayload(i);if(s!==void 0)return s===!1?e:s}}}};function xa(n){++n[11]>>>8&&++n[10]>>>8&&++n[9]>>>8&&++n[8]>>>8&&++n[7]>>>8&&++n[6]>>>8&&++n[5]>>>8&&++n[4]>>>8}var Gh=(()=>{let n=Buffer.alloc(4);return t=>(n[0]=t>>>24,n[1]=t>>>16,n[2]=t>>>8,n[3]=t,n)})();function Yh(n,t){return n.length!==t.length?(Gs(n,n),!1):Gs(n,t)}function $h(n){if(typeof n!="object"||n===null)throw new Error("Invalid config");if(typeof n.outbound!="object"||n.outbound===null)throw new Error("Invalid outbound");let t=n.outbound;if(typeof t.onWrite!="function")throw new Error("Invalid outbound.onWrite");if(typeof t.cipherInfo!="object"||t.cipherInfo===null)throw new Error("Invalid outbound.cipherInfo");if(!Buffer.isBuffer(t.cipherKey)||t.cipherKey.length!==t.cipherInfo.keyLen)throw new Error("Invalid outbound.cipherKey");if(t.cipherInfo.ivLen&&(!Buffer.isBuffer(t.cipherIV)||t.cipherIV.length!==t.cipherInfo.ivLen))throw new Error("Invalid outbound.cipherIV");if(typeof t.seqno!="number"||t.seqno<0||t.seqno>pa)throw new Error("Invalid outbound.seqno");let e=!!t.forceNative;switch(t.cipherInfo.sslName){case"aes-128-gcm":case"aes-256-gcm":return fo&&!e?new zs(n):new Vs(n);case"chacha20":return ao&&!e?new js(n):new Xs(n);default:{if(typeof t.macInfo!="object"||t.macInfo===null)throw new Error("Invalid outbound.macInfo");if(!Buffer.isBuffer(t.macKey)||t.macKey.length!==t.macInfo.len)throw new Error("Invalid outbound.macKey");return co&&!e?new Zs(n):new Js(n)}}}function Xh(n){if(typeof n!="object"||n===null)throw new Error("Invalid config");if(typeof n.inbound!="object"||n.inbound===null)throw new Error("Invalid inbound");let t=n.inbound;if(typeof t.onPayload!="function")throw new Error("Invalid inbound.onPayload");if(typeof t.decipherInfo!="object"||t.decipherInfo===null)throw new Error("Invalid inbound.decipherInfo");if(!Buffer.isBuffer(t.decipherKey)||t.decipherKey.length!==t.decipherInfo.keyLen)throw new Error("Invalid inbound.decipherKey");if(t.decipherInfo.ivLen&&(!Buffer.isBuffer(t.decipherIV)||t.decipherIV.length!==t.decipherInfo.ivLen))throw new Error("Invalid inbound.decipherIV");if(typeof t.seqno!="number"||t.seqno<0||t.seqno>pa)throw new Error("Invalid inbound.seqno");let e=!!t.forceNative;switch(t.decipherInfo.sslName){case"aes-128-gcm":case"aes-256-gcm":return uo&&!e?new io(n):new ro(n);case"chacha20":return ho&&!e?new no(n):new to(n);default:{if(typeof t.macInfo!="object"||t.macInfo===null)throw new Error("Invalid inbound.macInfo");if(!Buffer.isBuffer(t.macKey)||t.macKey.length!==t.macInfo.len)throw new Error("Invalid inbound.macKey");return lo&&!e?new oo(n):new so(n)}}}ya.exports={CIPHER_INFO:Kh,MAC_INFO:Wh,bindingAvailable:!!Ys,init:(()=>new Promise(async(n,t)=>{try{Mr=await _a()(),Kr=Mr._malloc(16),Ao=Mr.cwrap("poly1305_auth",null,["number","array","number","array","number","array"])}catch(e){return t(e)}n()}))(),NullCipher:$s,createCipher:$h,NullDecipher:eo,createDecipher:Xh}});var Ln=ze((GA,va)=>{"use strict";var{createDecipheriv:Eo,createECDH:jh,createHash:Gr,createHmac:Vh,createSign:zh,createVerify:Jh,getCiphers:Zh,sign:Sa,verify:wa}=require("crypto"),el=Zh(),{Ber:Re}=Qr(),tl=Qs().pbkdf,{CIPHER_INFO:Yr}=Nn(),{eddsaSupported:_o,SUPPORTED_CIPHER:nl}=yn(),{bufferSlice:$n,makeBufferParser:rl,readString:Ce,readUInt32BE:Wr,writeUInt32BE:kt}=rn(),Sn=Symbol("Hash Algorithm"),sn=Symbol("Private key PEM"),dn=Symbol("Public key PEM"),vn=Symbol("Public key SSH"),dr=Symbol("Decrypted Key"),go=Object.create(null);{let n=Object.keys(Yr);for(let t=0;t<n.length;++t){let e=Yr[n[t]].sslName;!e||go[e]||(go[e]=Yr[n[t]])}}var Qi=rl();function on(n,t){t=t.base64Slice(0,t.length);let e=t.replace(/.{64}/g,`$&
`);return t.length&63&&(e+=`
`),`-----BEGIN ${n} KEY-----
${e}-----END ${n} KEY-----`}function $r(n,t){let e=Buffer.allocUnsafe(n.length+t.length);return e.set(n,0),e.set(t,n.length),e}function po(n,t){let e=n.length,r=n._pos||0;for(let i=0;i<t;++i){let s=e-r;if(r>=e||s<4)return!1;let o=Wr(n,r);if(s<4+o)return!1;r+=4+o}return n._pos=r,!0}function Xr(n,t){let e=new Re.Writer;return e.startSequence(),e.startSequence(),e.writeOID("1.2.840.113549.1.1.1"),e.writeNull(),e.endSequence(),e.startSequence(Re.BitString),e.writeByte(0),e.startSequence(),e.writeBuffer(n,Re.Integer),e.writeBuffer(t,Re.Integer),e.endSequence(),e.endSequence(),e.endSequence(),on("PUBLIC",e.buffer)}function jr(n,t){let e=Buffer.allocUnsafe(15+t.length+4+n.length);kt(e,7,0),e.utf8Write("ssh-rsa",4,7);let r=4+7;return kt(e,t.length,r),e.set(t,r+=4),kt(e,n.length,r+=t.length),e.set(n,r+4),e}var ma=(()=>{function n(r,i,s,o,f,a,u,h){let l=new Re.Writer;return l.startSequence(),l.writeInt(0,Re.Integer),l.writeBuffer(r,Re.Integer),l.writeBuffer(i,Re.Integer),l.writeBuffer(s,Re.Integer),l.writeBuffer(o,Re.Integer),l.writeBuffer(f,Re.Integer),l.writeBuffer(a,Re.Integer),l.writeBuffer(u,Re.Integer),l.writeBuffer(h,Re.Integer),l.endSequence(),l.buffer}function t(r){return BigInt(`0x${r.hexSlice(0,r.length)}`)}function e(r){let i=r.toString(16);if(i.length&1)i=`0${i}`;else{let s=i.charCodeAt(0);(s===56||s===57||s>=97&&s<=102)&&(i=`00${i}`)}return Buffer.from(i,"hex")}return function(i,s,o,f,a,u){let h=t(o),l=e(h%(t(a)-1n)),A=e(h%(t(u)-1n));return on("RSA PRIVATE",n(i,s,o,a,u,l,A,f))}})();function Vr(n,t,e,r){let i=new Re.Writer;return i.startSequence(),i.startSequence(),i.writeOID("1.2.840.10040.4.1"),i.startSequence(),i.writeBuffer(n,Re.Integer),i.writeBuffer(t,Re.Integer),i.writeBuffer(e,Re.Integer),i.endSequence(),i.endSequence(),i.startSequence(Re.BitString),i.writeByte(0),i.writeBuffer(r,Re.Integer),i.endSequence(),i.endSequence(),on("PUBLIC",i.buffer)}function zr(n,t,e,r){let i=Buffer.allocUnsafe(15+n.length+4+t.length+4+e.length+4+r.length);kt(i,7,0),i.utf8Write("ssh-dss",4,7);let s=4+7;return kt(i,n.length,s),i.set(n,s+=4),kt(i,t.length,s+=n.length),i.set(t,s+=4),kt(i,e.length,s+=t.length),i.set(e,s+=4),kt(i,r.length,s+=e.length),i.set(r,s+4),i}function Ca(n,t,e,r,i){let s=new Re.Writer;return s.startSequence(),s.writeInt(0,Re.Integer),s.writeBuffer(n,Re.Integer),s.writeBuffer(t,Re.Integer),s.writeBuffer(e,Re.Integer),s.writeBuffer(r,Re.Integer),s.writeBuffer(i,Re.Integer),s.endSequence(),on("DSA PRIVATE",s.buffer)}function Ba(n){let t=new Re.Writer;return t.startSequence(),t.startSequence(),t.writeOID("1.3.101.112"),t.endSequence(),t.startSequence(Re.BitString),t.writeByte(0),t._ensure(n.length),t._buf.set(n,t._offset),t._offset+=n.length,t.endSequence(),t.endSequence(),on("PUBLIC",t.buffer)}function Ra(n){let t=Buffer.allocUnsafe(19+n.length);return kt(t,11,0),t.utf8Write("ssh-ed25519",4,11),kt(t,n.length,15),t.set(n,19),t}function il(n){let t=new Re.Writer;return t.startSequence(),t.writeInt(0,Re.Integer),t.startSequence(),t.writeOID("1.3.101.112"),t.endSequence(),t.startSequence(Re.OctetString),t.writeBuffer(n,Re.OctetString),t.endSequence(),t.endSequence(),on("PRIVATE",t.buffer)}function bo(n,t){let e=new Re.Writer;return e.startSequence(),e.startSequence(),e.writeOID("1.2.840.10045.2.1"),e.writeOID(n),e.endSequence(),e.startSequence(Re.BitString),e.writeByte(0),e._ensure(t.length),e._buf.set(t,e._offset),e._offset+=t.length,e.endSequence(),e.endSequence(),on("PUBLIC",e.buffer)}function Io(n,t){let e;switch(n){case"1.2.840.10045.3.1.7":e="nistp256";break;case"1.3.132.0.34":e="nistp384";break;case"1.3.132.0.35":e="nistp521";break;default:return}let r=Buffer.allocUnsafe(4+19+4+8+4+t.length);return kt(r,19,0),r.utf8Write(`ecdsa-sha2-${e}`,4,19),kt(r,8,23),r.utf8Write(e,27,8),kt(r,t.length,35),r.set(t,39),r}function sl(n,t,e){let r=new Re.Writer;return r.startSequence(),r.writeInt(1,Re.Integer),r.writeBuffer(e,Re.OctetString),r.startSequence(160),r.writeOID(n),r.endSequence(),r.startSequence(161),r.startSequence(Re.BitString),r.writeByte(0),r._ensure(t.length),r._buf.set(t,r._offset),r._offset+=t.length,r.endSequence(),r.endSequence(),r.endSequence(),on("EC PRIVATE",r.buffer)}function ol(n,t){let e=jh(n);return e.setPrivateKey(t),e.getPublicKey()}var Jr={sign:(()=>typeof Sa=="function"?function(t,e){let r=this[sn];if(r===null)return new Error("No private key available");(!e||typeof e!="string")&&(e=this[Sn]);try{return Sa(e,t,r)}catch(i){return i}}:function(t,e){let r=this[sn];if(r===null)return new Error("No private key available");(!e||typeof e!="string")&&(e=this[Sn]);let i=zh(e);i.update(t);try{return i.sign(r)}catch(s){return s}})(),verify:(()=>typeof wa=="function"?function(t,e,r){let i=this[dn];if(i===null)return new Error("No public key available");(!r||typeof r!="string")&&(r=this[Sn]);try{return wa(r,t,i,e)}catch(s){return s}}:function(t,e,r){let i=this[dn];if(i===null)return new Error("No public key available");(!r||typeof r!="string")&&(r=this[Sn]);let s=Jh(r);s.update(t);try{return s.verify(i,e)}catch(o){return o}})(),isPrivateKey:function(){return this[sn]!==null},getPrivatePEM:function(){return this[sn]},getPublicPEM:function(){return this[dn]},getPublicSSH:function(){return this[vn]},equals:function(t){let e=Ta(t);return e instanceof Error?!1:this.type===e.type&&this[sn]===e[sn]&&this[dn]===e[dn]&&this[vn]===e[vn]}};function Hi(n,t,e,r,i,s,o){this.type=n,this.comment=t,this[sn]=e,this[dn]=r,this[vn]=i,this[Sn]=s,this[dr]=o}Hi.prototype=Jr;{let t=function(e,r,i){let s=[];if(e.length<8)return new Error("Malformed OpenSSH private key");let o=Wr(e,0),f=Wr(e,4);if(o!==f)return i?new Error("OpenSSH key integrity check failed -- bad passphrase?"):new Error("OpenSSH key integrity check failed");e._pos=8;let a,u;for(a=0;a<r;++a){let l,A,_,x,b=Ce(e,e._pos,!0);if(b===void 0)return new Error("Malformed OpenSSH private key");switch(b){case"ssh-rsa":{let C=Ce(e,e._pos);if(C===void 0)return new Error("Malformed OpenSSH private key");let v=Ce(e,e._pos);if(v===void 0)return new Error("Malformed OpenSSH private key");let X=Ce(e,e._pos);if(X===void 0)return new Error("Malformed OpenSSH private key");let L=Ce(e,e._pos);if(L===void 0)return new Error("Malformed OpenSSH private key");let z=Ce(e,e._pos);if(z===void 0)return new Error("Malformed OpenSSH private key");let ne=Ce(e,e._pos);if(ne===void 0)return new Error("Malformed OpenSSH private key");_=Xr(C,v),x=jr(C,v),A=ma(C,v,X,L,z,ne),l="sha1";break}case"ssh-dss":{let C=Ce(e,e._pos);if(C===void 0)return new Error("Malformed OpenSSH private key");let v=Ce(e,e._pos);if(v===void 0)return new Error("Malformed OpenSSH private key");let X=Ce(e,e._pos);if(X===void 0)return new Error("Malformed OpenSSH private key");let L=Ce(e,e._pos);if(L===void 0)return new Error("Malformed OpenSSH private key");let z=Ce(e,e._pos);if(z===void 0)return new Error("Malformed OpenSSH private key");_=Vr(C,v,X,L),x=zr(C,v,X,L),A=Ca(C,v,X,L,z),l="sha1";break}case"ssh-ed25519":{if(!_o)return new Error(`Unsupported OpenSSH private key type: ${b}`);let C=Ce(e,e._pos);if(C===void 0||C.length!==32)return new Error("Malformed OpenSSH private key");let v=Ce(e,e._pos);if(v===void 0||v.length!==64)return new Error("Malformed OpenSSH private key");_=Ba(C),x=Ra(C),A=il($n(v,0,32)),l=null;break}case"ecdsa-sha2-nistp256":l="sha256",u="1.2.840.10045.3.1.7";case"ecdsa-sha2-nistp384":l===void 0&&(l="sha384",u="1.3.132.0.34");case"ecdsa-sha2-nistp521":{if(l===void 0&&(l="sha512",u="1.3.132.0.35"),!po(e,1))return new Error("Malformed OpenSSH private key");let C=Ce(e,e._pos);if(C===void 0)return new Error("Malformed OpenSSH private key");let v=Ce(e,e._pos);if(v===void 0)return new Error("Malformed OpenSSH private key");_=bo(u,C),x=Io(u,C),A=sl(u,C,v);break}default:return new Error(`Unsupported OpenSSH private key type: ${b}`)}let w=Ce(e,e._pos,!0);if(w===void 0)return new Error("Malformed OpenSSH private key");s.push(new Hi(b,w,A,_,x,l,i))}let h=0;for(a=e._pos;a<e.length;++a)if(e[a]!==++h%255)return new Error("Malformed OpenSSH private key");return s},n=/^-----BEGIN OPENSSH PRIVATE KEY-----(?:\r\n|\n)([\s\S]+)(?:\r\n|\n)-----END OPENSSH PRIVATE KEY-----$/;Hi.parse=(e,r)=>{let i=n.exec(e);if(i===null)return null;let s,o=Buffer.from(i[1],"base64");if(o.length<31)return new Error("Malformed OpenSSH private key");let f=o.utf8Slice(0,15);if(f!=="openssh-key-v1\0")return new Error(`Unsupported OpenSSH key magic: ${f}`);let a=Ce(o,15,!0);if(a===void 0)return new Error("Malformed OpenSSH private key");if(a!=="none"&&nl.indexOf(a)===-1)return new Error(`Unsupported cipher for OpenSSH key: ${a}`);let u=Ce(o,o._pos,!0);if(u===void 0)return new Error("Malformed OpenSSH private key");if(u!=="none"){if(a==="none")return new Error("Malformed OpenSSH private key");if(u!=="bcrypt")return new Error(`Unsupported kdf name for OpenSSH key: ${u}`);if(!r)return new Error("Encrypted private OpenSSH key detected, but no passphrase given")}else if(a!=="none")return new Error("Malformed OpenSSH private key");let h,l,A;a!=="none"&&(h=Yr[a]);let _=Ce(o,o._pos);if(_===void 0)return new Error("Malformed OpenSSH private key");if(_.length)switch(u){case"none":return new Error("Malformed OpenSSH private key");case"bcrypt":{let b=Ce(_,0);if(b===void 0||_._pos+4>_.length)return new Error("Malformed OpenSSH private key");let w=Wr(_,_._pos),C=Buffer.allocUnsafe(h.keyLen+h.ivLen);if(tl(r,r.length,b,b.length,C,C.length,w)!==0)return new Error("Failed to generate information to decrypt key");l=$n(C,0,h.keyLen),A=$n(C,h.keyLen,C.length);break}}else if(u!=="none")return new Error("Malformed OpenSSH private key");if(o._pos+3>=o.length)return new Error("Malformed OpenSSH private key");let x=Wr(o,o._pos);if(o._pos+=4,x>0){for(let w=0;w<x;++w){let C=Ce(o,o._pos);if(C===void 0)return new Error("Malformed OpenSSH private key");if(Ce(C,0,!0)===void 0)return new Error("Malformed OpenSSH private key")}let b=Ce(o,o._pos);if(b===void 0)return new Error("Malformed OpenSSH private key");if(l!==void 0){if(b.length<h.blockLen||b.length%h.blockLen!==0)return new Error("Malformed OpenSSH private key");try{let w={authTagLength:h.authLen},C=Eo(h.sslName,l,A,w);if(C.setAutoPadding(!1),h.authLen>0){if(o.length-o._pos<h.authLen)return new Error("Malformed OpenSSH private key");C.setAuthTag($n(o,o._pos,o._pos+=h.authLen))}b=$r(C.update(b),C.final())}catch(w){return w}}if(o._pos!==o.length)return new Error("Malformed OpenSSH private key");s=t(b,x,l!==void 0)}else s=[];return s instanceof Error?s:s[0]}}function Fi(n,t,e,r,i,s,o){this.type=n,this.comment=t,this[sn]=e,this[dn]=r,this[vn]=i,this[Sn]=s,this[dr]=o}Fi.prototype=Jr;{let n=/^-----BEGIN (RSA|DSA|EC) PRIVATE KEY-----(?:\r\n|\n)((?:[^:]+:\s*[\S].*(?:\r\n|\n))*)([\s\S]+)(?:\r\n|\n)-----END (RSA|DSA|EC) PRIVATE KEY-----$/;Fi.parse=(t,e)=>{let r=n.exec(t);if(r===null)return null;let i=Buffer.from(r[3],"base64"),s=r[2],o=!1;if(s!==void 0){s=s.split(/\r\n|\n/g);for(let x=0;x<s.length;++x){let b=s[x],w=b.indexOf(":");if(b.slice(0,w)==="DEK-Info"){let C=b.slice(w+2);if(w=C.indexOf(","),w===-1)continue;let v=C.slice(0,w).toLowerCase();if(el.indexOf(v)===-1)return new Error(`Cipher (${v}) not supported for encrypted OpenSSH private key`);let X=go[v];if(!X)return new Error(`Cipher (${v}) not supported for encrypted OpenSSH private key`);let L=Buffer.from(C.slice(w+1),"hex");if(L.length!==X.ivLen)return new Error("Malformed encrypted OpenSSH private key");if(!e)return new Error("Encrypted OpenSSH private key detected, but no passphrase given");let z=$n(L,0,8),ne=Gr("md5").update(e).update(z).digest();for(;ne.length<X.keyLen;)ne=$r(ne,Gr("md5").update(ne).update(e).update(z).digest());ne.length>X.keyLen&&(ne=$n(ne,0,X.keyLen));try{let J=Eo(v,ne,L);J.setAutoPadding(!1),i=$r(J.update(i),J.final()),o=!0}catch(J){return J}}}}let f,a,u,h,l,A,_="Malformed OpenSSH private key";switch(o&&(_+=". Bad passphrase?"),r[1]){case"RSA":f="ssh-rsa",a=on("RSA PRIVATE",i);try{A=new Re.Reader(i),A.readSequence(),A.readInt();let x=A.readString(Re.Integer,!0);if(x===null)return new Error(_);let b=A.readString(Re.Integer,!0);if(b===null)return new Error(_);u=Xr(x,b),h=jr(x,b)}catch{return new Error(_)}l="sha1";break;case"DSA":f="ssh-dss",a=on("DSA PRIVATE",i);try{A=new Re.Reader(i),A.readSequence(),A.readInt();let x=A.readString(Re.Integer,!0);if(x===null)return new Error(_);let b=A.readString(Re.Integer,!0);if(b===null)return new Error(_);let w=A.readString(Re.Integer,!0);if(w===null)return new Error(_);let C=A.readString(Re.Integer,!0);if(C===null)return new Error(_);u=Vr(x,b,w,C),h=zr(x,b,w,C)}catch{return new Error(_)}l="sha1";break;case"EC":{let x,b,w;try{A=new Re.Reader(i),A.readSequence(),A.readInt(),b=A.readString(Re.OctetString,!0),A.readByte();let v=A.readLength();if(v!==null){if(A._offset=v,w=A.readOID(),w===null)return new Error(_);switch(w){case"1.2.840.10045.3.1.7":x="prime256v1",f="ecdsa-sha2-nistp256",l="sha256";break;case"1.3.132.0.34":x="secp384r1",f="ecdsa-sha2-nistp384",l="sha384";break;case"1.3.132.0.35":x="secp521r1",f="ecdsa-sha2-nistp521",l="sha512";break;default:return new Error(`Unsupported private key EC OID: ${w}`)}}else return new Error(_)}catch{return new Error(_)}a=on("EC PRIVATE",i);let C=ol(x,b);u=bo(w,C),h=Io(w,C);break}}return new Fi(f,"",a,u,h,l,o)}}function Mi(n,t,e,r,i,s,o){this.type=n,this.comment=t,this[sn]=e,this[dn]=r,this[vn]=i,this[Sn]=s,this[dr]=o}Mi.prototype=Jr;{let n=Buffer.alloc(0),t=Buffer.from([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),e=Buffer.from([0,0,0,0]),r=Buffer.from([0,0,0,1]),i=/^PuTTY-User-Key-File-2: (ssh-(?:rsa|dss))\r?\nEncryption: (aes256-cbc|none)\r?\nComment: ([^\r\n]*)\r?\nPublic-Lines: \d+\r?\n([\s\S]+?)\r?\nPrivate-Lines: \d+\r?\n([\s\S]+?)\r?\nPrivate-MAC: ([^\r\n]+)/;Mi.parse=(s,o)=>{let f=i.exec(s);if(f===null)return null;let a=f[2],u=a!=="none";if(u&&!o)return new Error("Encrypted PPK private key detected, but no passphrase given");let h=Buffer.from(f[5],"base64");if(u){let O=Yr[a],q=$r(Gr("sha1").update(e).update(o).digest(),Gr("sha1").update(r).update(o).digest());q.length>O.keyLen&&(q=$n(q,0,O.keyLen));try{let H=Eo(O.sslName,q,t);H.setAutoPadding(!1),h=$r(H.update(h),H.final())}catch(H){return H}}let l=f[1],A=f[3],_=Buffer.from(f[4],"base64"),x=f[6],b=l.length,w=a.length,C=Buffer.byteLength(A),v=_.length,X=h.length,L=Buffer.allocUnsafe(4+b+4+w+4+C+4+v+4+X),z=0;if(kt(L,b,z),L.utf8Write(l,z+=4,b),kt(L,w,z+=b),L.utf8Write(a,z+=4,w),kt(L,C,z+=w),L.utf8Write(A,z+=4,C),kt(L,v,z+=C),L.set(_,z+=4),kt(L,X,z+=v),L.set(h,z+4),o||(o=n),Vh("sha1",Gr("sha1").update("putty-private-key-file-mac-key").update(o).digest()).update(L).digest("hex")!==x)return u?new Error("PPK private key integrity check failed -- bad passphrase?"):new Error("PPK private key integrity check failed");let J,y,S;switch(_._pos=0,po(_,1),l){case"ssh-rsa":{let O=Ce(_,_._pos);if(O===void 0)return new Error("Malformed PPK public key");let q=Ce(_,_._pos);if(q===void 0)return new Error("Malformed PPK public key");let H=Ce(h,0);if(H===void 0)return new Error("Malformed PPK private key");let se=Ce(h,h._pos);if(se===void 0)return new Error("Malformed PPK private key");let te=Ce(h,h._pos);if(te===void 0)return new Error("Malformed PPK private key");let Z=Ce(h,h._pos);if(Z===void 0)return new Error("Malformed PPK private key");J=Xr(q,O),y=jr(q,O),S=ma(q,O,H,Z,se,te);break}case"ssh-dss":{let O=Ce(_,_._pos);if(O===void 0)return new Error("Malformed PPK public key");let q=Ce(_,_._pos);if(q===void 0)return new Error("Malformed PPK public key");let H=Ce(_,_._pos);if(H===void 0)return new Error("Malformed PPK public key");let se=Ce(_,_._pos);if(se===void 0)return new Error("Malformed PPK public key");let te=Ce(h,0);if(te===void 0)return new Error("Malformed PPK private key");J=Vr(O,q,H,se),y=zr(O,q,H,se),S=Ca(O,q,H,se,te);break}}return new Mi(l,A,S,J,y,"sha1",u)}}function Ki(n,t,e,r,i){this.type=n,this.comment=t,this[sn]=null,this[dn]=e,this[vn]=r,this[Sn]=i,this[dr]=!1}Ki.prototype=Jr;{let n;_o?n=/^(((?:ssh-(?:rsa|dss|ed25519))|ecdsa-sha2-nistp(?:256|384|521))(?:-cert-v0[01]@openssh.com)?) ([A-Z0-9a-z/+=]+)(?:$|\s+([\S].*)?)$/:n=/^(((?:ssh-(?:rsa|dss))|ecdsa-sha2-nistp(?:256|384|521))(?:-cert-v0[01]@openssh.com)?) ([A-Z0-9a-z/+=]+)(?:$|\s+([\S].*)?)$/,Ki.parse=t=>{let e=n.exec(t);if(e===null)return null;let r=e[1],i=e[2],s=Buffer.from(e[3],"base64"),o=e[4]||"",f=Ce(s,s._pos,!0);return f===void 0||f.indexOf(i)!==0?new Error("Malformed OpenSSH public key"):xo(s,i,o,r)}}function qi(n,t,e,r,i){this.type=n,this.comment=t,this[sn]=null,this[dn]=e,this[vn]=r,this[Sn]=i,this[dr]=!1}qi.prototype=Jr;{let n=/^---- BEGIN SSH2 PUBLIC KEY ----(?:\r?\n)((?:.{0,72}\r?\n)+)---- END SSH2 PUBLIC KEY ----$/,t=/^[A-Z0-9a-z/+=\r\n]+$/,e=/^([\x21-\x39\x3B-\x7E]{1,64}): ((?:[^\\]*\\\r?\n)*[^\r\n]+)\r?\n/gm,r=/\\\r?\n/g;qi.parse=i=>{let s=n.exec(i);if(s===null)return null;let o=s[1],f=0,a="";for(;s=e.exec(o);){let _=s[1],x=s[2].replace(r,"");if(x.length>1024)return e.lastIndex=0,new Error("Malformed RFC4716 public key");f=e.lastIndex,_.toLowerCase()==="comment"&&(a=x,a.length>1&&a.charCodeAt(0)===34&&a.charCodeAt(a.length-1)===34&&(a=a.slice(1,-1)))}let u=o.slice(f);if(!t.test(u))return new Error("Malformed RFC4716 public key");u=Buffer.from(u,"base64");let h=Ce(u,0,!0);if(h===void 0)return new Error("Malformed RFC4716 public key");let l=null,A=null;switch(h){case"ssh-rsa":{let _=Ce(u,u._pos);if(_===void 0)return new Error("Malformed RFC4716 public key");let x=Ce(u,u._pos);if(x===void 0)return new Error("Malformed RFC4716 public key");l=Xr(x,_),A=jr(x,_);break}case"ssh-dss":{let _=Ce(u,u._pos);if(_===void 0)return new Error("Malformed RFC4716 public key");let x=Ce(u,u._pos);if(x===void 0)return new Error("Malformed RFC4716 public key");let b=Ce(u,u._pos);if(b===void 0)return new Error("Malformed RFC4716 public key");let w=Ce(u,u._pos);if(w===void 0)return new Error("Malformed RFC4716 public key");l=Vr(_,x,b,w),A=zr(_,x,b,w);break}default:return new Error("Malformed RFC4716 public key")}return new qi(h,a,l,A,"sha1")}}function xo(n,t,e,r){if(!ka(t))return new Error(`Unsupported OpenSSH public key type: ${t}`);let i,s,o=null,f=null;switch(t){case"ssh-rsa":{let a=Ce(n,n._pos||0);if(a===void 0)return new Error("Malformed OpenSSH public key");let u=Ce(n,n._pos);if(u===void 0)return new Error("Malformed OpenSSH public key");o=Xr(u,a),f=jr(u,a),i="sha1";break}case"ssh-dss":{let a=Ce(n,n._pos||0);if(a===void 0)return new Error("Malformed OpenSSH public key");let u=Ce(n,n._pos);if(u===void 0)return new Error("Malformed OpenSSH public key");let h=Ce(n,n._pos);if(h===void 0)return new Error("Malformed OpenSSH public key");let l=Ce(n,n._pos);if(l===void 0)return new Error("Malformed OpenSSH public key");o=Vr(a,u,h,l),f=zr(a,u,h,l),i="sha1";break}case"ssh-ed25519":{let a=Ce(n,n._pos||0);if(a===void 0||a.length!==32)return new Error("Malformed OpenSSH public key");o=Ba(a),f=Ra(a),i=null;break}case"ecdsa-sha2-nistp256":i="sha256",s="1.2.840.10045.3.1.7";case"ecdsa-sha2-nistp384":i===void 0&&(i="sha384",s="1.3.132.0.34");case"ecdsa-sha2-nistp521":{if(i===void 0&&(i="sha512",s="1.3.132.0.35"),!po(n,1))return new Error("Malformed OpenSSH public key");let a=Ce(n,n._pos||0);if(a===void 0)return new Error("Malformed OpenSSH public key");o=bo(s,a),f=Io(s,a);break}default:return new Error(`Unsupported OpenSSH public key type: ${t}`)}return new Ki(r,e,o,f,i)}function ka(n){switch(n){case"ssh-rsa":case"ssh-dss":case"ecdsa-sha2-nistp256":case"ecdsa-sha2-nistp384":case"ecdsa-sha2-nistp521":return!0;case"ssh-ed25519":if(_o)return!0;default:return!1}}function Na(n){return n?typeof n[dr]=="boolean":!1}function Ta(n,t){if(Na(n))return n;let e;if(Buffer.isBuffer(n))e=n,n=n.utf8Slice(0,n.length).trim();else if(typeof n=="string")n=n.trim();else return new Error("Key data must be a Buffer or string");if(t!=null){if(typeof t=="string")t=Buffer.from(t);else if(!Buffer.isBuffer(t))return new Error("Passphrase must be a string or Buffer when supplied")}let r;if((r=Hi.parse(n,t))!==null||(r=Fi.parse(n,t))!==null||(r=Mi.parse(n,t))!==null||(r=Ki.parse(n))!==null||(r=qi.parse(n))!==null)return r;if(e){Qi.init(e,0);let i=Qi.readString(!0);i!==void 0&&(n=Qi.readRaw(),n!==void 0&&(r=xo(n,i,"",i),r instanceof Error&&(r=null))),Qi.clear()}return r||new Error("Unsupported key format")}va.exports={isParsedKey:Na,isSupportedKeyType:ka,parseDERKey:(n,t)=>xo(n,t,"",t),parseKey:Ta}});var Bo=ze((jA,qa)=>{"use strict";var{Socket:Pa}=require("net"),{Duplex:Da}=require("stream"),{resolve:fl}=require("path"),{readFile:La}=require("fs"),{execFile:al,spawn:cl}=require("child_process"),{isParsedKey:Oa,parseKey:Zr}=Ln(),{makeBufferParser:ul,readUInt32BE:Co,writeUInt32BE:Wt,writeUInt32LE:Ua}=rn();function ei(n){let t=!1;return(...e)=>{t||(t=!0,n(...e))}}function hl(n,t){let e=Buffer.allocUnsafe(n.length+t.length);return n.copy(e,0),t.copy(e,n.length),e}function So(){}var ll=Buffer.alloc(0),_t=ul(),ti=class{getIdentities(t){t(new Error("Missing getIdentities() implementation"))}sign(t,e,r,i){typeof r=="function"&&(i=r),i(new Error("Missing sign() implementation"))}},gr=class extends ti{constructor(t){super(),this.socketPath=t}getStream(t){t=ei(t);let e=new Pa;e.on("connect",()=>{t(null,e)}),e.on("close",r).on("end",r).on("error",r),e.connect(this.socketPath);function r(){try{e.destroy()}catch{}t(new Error("Failed to connect to agent"))}}getIdentities(t){t=ei(t),this.getStream((e,r)=>{function i(o){if(r)try{r.destroy()}catch{}o||(o=new Error("Failed to retrieve identities from agent")),t(o)}if(e)return i(e);let s=new wo(!0);s.on("error",i),s.pipe(r).pipe(s),r.on("close",i).on("end",i).on("error",i),s.getIdentities((o,f)=>{if(o)return i(o);try{r.destroy()}catch{}t(null,f)})})}sign(t,e,r,i){typeof r=="function"?(i=r,r=void 0):(typeof r!="object"||r===null)&&(r=void 0),i=ei(i),this.getStream((s,o)=>{function f(u){if(o)try{o.destroy()}catch{}u||(u=new Error("Failed to sign data with agent")),i(u)}if(s)return f(s);let a=new wo(!0);a.on("error",f),a.pipe(o).pipe(a),o.on("close",f).on("end",f).on("error",f),a.sign(t,e,r,(u,h)=>{if(u)return f(u);try{o.destroy()}catch{}i(null,h)})})}},Qa=(()=>{let o=fl(__dirname,"..","util/pagent.exe"),f={[10]:new Error("Invalid pagent.exe arguments"),[11]:new Error("Pageant is not running"),[12]:new Error("pagent.exe could not create an mmap"),[13]:new Error("pagent.exe could not set mode for stdin"),[14]:new Error("pagent.exe could not set mode for stdout"),[15]:new Error("pagent.exe did not get expected input payload")};function a(h){h.buffer=null,h.proc&&(h.proc.kill(),h.proc=void 0)}class u extends Da{constructor(){super(),this.proc=void 0,this.buffer=null}_read(l){}_write(l,A,_){if(this.buffer===null)this.buffer=l;else{let C=Buffer.allocUnsafe(this.buffer.length+l.length);this.buffer.copy(C,0),l.copy(C,this.buffer.length),this.buffer=C}if(this.buffer.length<4)return _();let x=Co(this.buffer,0);if(this.buffer.length-4<x)return _();if(l=this.buffer.slice(0,4+x),this.buffer.length>4+x)return _(new Error("Unexpected multiple agent requests"));this.buffer=null;let b,w=this.proc=cl(o,[l.length]);w.stdout.on("data",C=>{this.push(C)}),w.on("error",C=>{b=C,_(b)}),w.on("close",C=>{if(this.proc=void 0,!b){if(b=f[C])return _(b);_()}}),w.stdin.end(l)}_final(l){a(this),l()}_destroy(l,A){a(this),A()}}return class extends gr{getStream(l){l(null,new u)}}})(),Ha=(()=>{let n=/^!<socket >(\d+) s ([A-Z0-9]{8}-[A-Z0-9]{8}-[A-Z0-9]{8}-[A-Z0-9]{8})/;return class extends gr{getStream(e){e=ei(e);let r=this.socketPath,i=!1;La(r,function s(o,f){if(o){if(i)return e(new Error("Invalid cygwin unix socket path"));al("cygpath",["-w",r],(ne,J,y)=>{if(ne||J.length===0)return e(new Error("Invalid cygwin unix socket path"));i=!0,r=J.toString().replace(/[\r\n]/g,""),La(r,s)});return}let a=n.exec(f.toString("ascii"));if(!a)return e(new Error("Malformed cygwin unix socket file"));let u,h=0,l=!1,A=[],_,x=Buffer.alloc(12),b=parseInt(a[1],10),w=a[2].replace(/-/g,""),C=Buffer.allocUnsafe(16);for(let ne=0,J=0;J<32;++ne,J+=2)C[ne]=parseInt(w.substring(J,J+2),16);for(let ne=0;ne<16;ne+=4)Ua(C,Co(C,ne),ne);z();function v(){h=0,u="secret",_.write(C)}function X(ne){if(h+=ne.length,u==="secret"){h===16&&(h=0,u="creds",_.write(x));return}if(u==="creds"&&(l||A.push(ne),h===12)){if(_.removeListener("connect",v),_.removeListener("data",X),_.removeListener("error",L),_.removeListener("end",L),_.removeListener("close",L),l)return e(null,_);l=!0,x=Buffer.concat(A),Ua(x,process.pid,0),_.on("error",()=>{}),_.destroy(),z()}}function L(){e(new Error("Problem negotiating cygwin unix socket security"))}function z(){_=new Pa,_.on("connect",v),_.on("data",X),_.on("error",L),_.on("end",L),_.on("close",L),_.connect(b)}})}}})(),dl=/^[/\\][/\\]\.[/\\]pipe[/\\].+/;function Fa(n){return process.platform==="win32"&&!dl.test(n)?n==="pageant"?new Qa:new Ha(n):new gr(n)}var wo=(()=>{function u(y){let S;for(;y[v].length;){let O=y[v][0][l];if(O===void 0)break;y[v].shift(),S=y.push(O)}return S}let h=Symbol("Inbound Request Type"),l=Symbol("Inbound Request Response"),A=Symbol("Inbound Request Context");class _{constructor(S,O){this[h]=S,this[l]=void 0,this[A]=O}hasResponded(){return this[l]!==void 0}getType(){return this[h]}getContext(){return this[A]}}function x(y,S,O){return S[l]=O,u(y)}function b(y){if(y[L]=null,y[X]===0){let S=y[v];if(S&&S.length){y[v]=[];for(let O of S)O.cb(new Error("No reply from server"))}}try{y.end()}catch{}setImmediate(()=>{y[J]||y.emit("end"),y[ne]||y.emit("close")})}function w(){this[ne]=!0}function C(){this[J]=!0}let v=Symbol("Requests"),X=Symbol("Agent Protocol Role"),L=Symbol("Agent Protocol Buffer"),z=Symbol("Agent Protocol Current Message Length"),ne=Symbol("Agent Protocol Closed"),J=Symbol("Agent Protocol Ended");return class extends Da{constructor(S){super({autoDestroy:!0,emitClose:!1}),this[X]=S?0:1,this[v]=[],this[L]=null,this[z]=-1,this.once("end",C),this.once("close",w)}_read(S){}_write(S,O,q){this[L]===null?this[L]=S:this[L]=hl(this[L],S);let H=this[L],se=H.length,te=0;for(;te<se&&!(se<5||(this[z]===-1&&(this[z]=Co(H,te)),se<4+this[z]));){let Z=H[te+=4];if(++te,this[X]===0){if(this[v].length===0)return q(new Error("Received unexpected message from server"));let re=this[v].shift();switch(Z){case 5:re.cb(new Error("Agent responded with failure"));break;case 12:{if(re.type!==11)return q(new Error("Agent responded with wrong message type"));_t.init(H,te);let oe=_t.readUInt32BE();if(oe===void 0)return _t.clear(),q(new Error("Malformed agent response"));let T=[];for(let M=0;M<oe;++M){let F=_t.readString();if(F===void 0)return _t.clear(),q(new Error("Malformed agent response"));let V=_t.readString(!0);if(V===void 0)return _t.clear(),q(new Error("Malformed agent response"));F=Zr(F),!(F instanceof Error)&&(F.comment=F.comment||V,T.push(F))}te=_t.pos(),_t.clear(),re.cb(null,T);break}case 14:{if(re.type!==13)return q(new Error("Agent responded with wrong message type"));_t.init(H,te);let oe=_t.readString();if(te=_t.pos(),_t.clear(),oe===void 0)return q(new Error("Malformed agent response"));if(_t.init(oe,0),_t.readString(!0),oe=_t.readString(),_t.clear(),oe===void 0)return q(new Error("Malformed OpenSSH signature format"));re.cb(null,oe);break}default:return q(new Error("Agent responded with unsupported message type"))}}else switch(Z){case 11:{let re=new _(Z);this[v].push(re),this.emit("identities",re);break}case 13:{_t.init(H,te);let re=_t.readString(),oe=_t.readString(),T=_t.readUInt32BE();if(te=_t.pos(),_t.clear(),T===void 0){let Ae=new _(Z);return this[v].push(Ae),this.failureReply(Ae)}if(re=Zr(re),re instanceof Error){let Ae=new _(Z);return this[v].push(Ae),this.failureReply(Ae)}let M={hash:void 0},F;re.type==="ssh-rsa"&&(T&2?(F="rsa-sha2-256",M.hash="sha256"):T&4&&(F="rsa-sha2-512",M.hash="sha512")),F===void 0&&(F=re.type);let V=new _(Z,F);this[v].push(V),this.emit("sign",V,re,oe,M);break}default:{let re=new _(Z);this[v].push(re),this.failureReply(re)}}if(this[z]=-1,te===se){this[L]=null;break}else this[L]=H=H.slice(te),se=H.length,te=0}q()}_destroy(S,O){b(this),O()}_final(S){b(this),S()}sign(S,O,q,H){if(this[X]!==0)throw new Error("Client-only method called with server role");typeof q=="function"?(H=q,q=void 0):(typeof q!="object"||q===null)&&(q=void 0);let se=0;if(S=Zr(S),S instanceof Error)throw new Error("Invalid public key argument");if(S.type==="ssh-rsa"&&q)switch(q.hash){case"sha256":se=2;break;case"sha512":se=4;break}S=S.getPublicSSH();let te=13,Z=S.length,re=O.length,oe=0,T=Buffer.allocUnsafe(4+1+4+Z+4+re+4);return Wt(T,T.length-4,oe),T[oe+=4]=te,Wt(T,Z,++oe),S.copy(T,oe+=4),Wt(T,re,oe+=Z),O.copy(T,oe+=4),Wt(T,se,oe+=re),typeof H!="function"&&(H=So),this[v].push({type:te,cb:H}),this.push(T)}getIdentities(S){if(this[X]!==0)throw new Error("Client-only method called with server role");let O=11,q=0,H=Buffer.allocUnsafe(4+1);return Wt(H,H.length-4,q),H[q+=4]=O,typeof S!="function"&&(S=So),this[v].push({type:O,cb:S}),this.push(H)}failureReply(S){if(this[X]!==1)throw new Error("Server-only method called with client role");if(!(S instanceof _))throw new Error("Wrong request argument");if(S.hasResponded())return!0;let O=0,q=Buffer.allocUnsafe(4+1);return Wt(q,q.length-4,O),q[O+=4]=5,x(this,S,q)}getIdentitiesReply(S,O){if(this[X]!==1)throw new Error("Server-only method called with client role");if(!(S instanceof _))throw new Error("Wrong request argument");if(S.hasResponded())return!0;if(S.getType()!==11)throw new Error("Invalid response to request");if(!Array.isArray(O))throw new Error("Keys argument must be an array");let q=4,H=[];for(let Z=0;Z<O.length;++Z){let re=O[Z];if(typeof re!="object"||re===null)throw new Error(`Invalid key entry: ${re}`);let oe,T;if(Oa(re))oe=re;else if(Oa(re.pubKey))oe=re.pubKey;else if(typeof re.pubKey!="object"||re.pubKey===null||({pubKey:oe,comment:T}=re.pubKey,oe=Zr(oe),oe instanceof Error))continue;T=oe.comment||T,oe=oe.getPublicSSH(),q+=4+oe.length,T&&typeof T=="string"?T=Buffer.from(T):Buffer.isBuffer(T)||(T=ll),q+=4+T.length,H.push({pubKey:oe,comment:T})}let se=0,te=Buffer.allocUnsafe(4+1+q);Wt(te,te.length-4,se),te[se+=4]=12,Wt(te,H.length,++se),se+=4;for(let Z=0;Z<H.length;++Z){let{pubKey:re,comment:oe}=H[Z];Wt(te,re.length,se),re.copy(te,se+=4),Wt(te,oe.length,se+=re.length),se+=4,oe.length&&(oe.copy(te,se),se+=oe.length)}return x(this,S,te)}signReply(S,O){if(this[X]!==1)throw new Error("Server-only method called with client role");if(!(S instanceof _))throw new Error("Wrong request argument");if(S.hasResponded())return!0;if(S.getType()!==13)throw new Error("Invalid response to request");if(!Buffer.isBuffer(O))throw new Error("Signature argument must be a Buffer");if(O.length===0)throw new Error("Signature argument must be non-empty");let q=0,H=S.getContext(),se=Buffer.byteLength(H),te=Buffer.allocUnsafe(4+1+4+4+se+4+O.length);return Wt(te,te.length-4,q),te[q+=4]=14,Wt(te,4+se+4+O.length,++q),Wt(te,se,q+=4),te.utf8Write(H,q+=4,se),Wt(te,O.length,q+=se),O.copy(te,q+=4),x(this,S,te)}}})(),yo=Symbol("Agent"),fn=Symbol("Agent Keys"),wn=Symbol("Agent Keys Index"),Ar=Symbol("Agent Init Callbacks"),mo=class{constructor(t){if(typeof t=="string")t=Fa(t);else if(!Ma(t))throw new Error("Invalid agent argument");this[yo]=t,this[fn]=null,this[wn]=-1,this[Ar]=null}init(t){if(typeof t!="function"&&(t=So),this[fn]===null)if(this[Ar]===null){this[Ar]=[t];let e=(...r)=>{process.nextTick(()=>{let i=this[Ar];this[Ar]=null;for(let s of i)s(...r)})};this[yo].getIdentities(ei((r,i)=>{if(r)return e(r);if(!Array.isArray(i))return e(new Error("Agent implementation failed to provide keys"));let s=[];for(let o of i)o=Zr(o),!(o instanceof Error)&&s.push(o);this[fn]=s,this[wn]=-1,e()}))}else this[Ar].push(t);else process.nextTick(t)}nextKey(){return this[fn]===null||++this[wn]>=this[fn].length?!1:this[fn][this[wn]]}currentKey(){return this[fn]===null||this[wn]>=this[fn].length?null:this[fn][this[wn]]}pos(){return this[fn]===null||this[wn]>=this[fn].length?-1:this[wn]}reset(){this[wn]=-1}sign(...t){this[yo].sign(...t)}};function Ma(n){return n instanceof ti}qa.exports={AgentContext:mo,AgentProtocol:wo,BaseAgent:ti,createAgent:Fa,CygwinAgent:Ha,isAgent:Ma,OpenSSHAgent:gr,PageantAgent:Qa}});var Lo=ze((VA,Ka)=>{"use strict";var{kMaxLength:Al}=require("buffer"),{createInflate:gl,constants:{DEFLATE:El,INFLATE:_l,Z_DEFAULT_CHUNK:pl,Z_DEFAULT_COMPRESSION:bl,Z_DEFAULT_MEMLEVEL:Il,Z_DEFAULT_STRATEGY:xl,Z_DEFAULT_WINDOWBITS:yl,Z_PARTIAL_FLUSH:Sl}}=require("zlib"),wl=gl()._handle.constructor;function ml(){throw new Error("Should not get here")}function Cl(n,t,e){let r=this._owner,i=new Error(n);i.errno=t,i.code=e,r._err=i}function vo(n){n._handle&&(n._handle.close(),n._handle=null)}var Wi=class{constructor(t){let e=yl,r=bl,i=Il,s=xl,o=void 0;this._err=void 0,this._writeState=new Uint32Array(2),this._chunkSize=pl,this._maxOutputLength=Al,this._outBuffer=Buffer.allocUnsafe(this._chunkSize),this._outOffset=0,this._handle=new wl(t),this._handle._owner=this,this._handle.onerror=Cl,this._handle.init(e,r,i,s,this._writeState,ml,o)}writeSync(t,e){let r=this._handle;if(!r)throw new Error("Invalid Zlib instance");let i=t.length,s=this._chunkSize-this._outOffset,o=0,f,a,u,h=0,l=this._writeState,A=this._outBuffer,_=this._outOffset,x=this._chunkSize;for(;;){if(r.writeSync(Sl,t,o,i,A,_,s),this._err)throw this._err;f=l[0],a=l[1];let w=i-a,C=s-f;if(C>0){let v=_===0&&C===A.length?A:A.slice(_,_+C);if(_+=C,u?u.push===void 0?u=[u,v]:u.push(v):u=v,h+=v.byteLength,h>this._maxOutputLength)throw vo(this),new Error(`Output length exceeded maximum of ${this._maxOutputLength}`)}else if(C!==0)throw new Error("have should not go down");if((f===0||_>=x)&&(s=x,_=0,A=Buffer.allocUnsafe(x)),f===0)o+=w,i=a;else break}if(this._outBuffer=A,this._outOffset=_,h===0&&(u=Buffer.alloc(0)),e)return u.totalLen=h,u;if(u.push===void 0)return u;let b=Buffer.allocUnsafe(h);for(let w=0,C=0;w<u.length;++w){let v=u[w];b.set(v,C),C+=v.length}return b}},Ro=class{constructor(t){this.allocStart=0,this.allocStartKEX=0,this._protocol=t,this._zlib=new Wi(El)}cleanup(){this._zlib&&vo(this._zlib)}alloc(t,e){return Buffer.allocUnsafe(t)}finalize(t,e){if(this._protocol._kexinit===void 0||e){let r=this._zlib.writeSync(t,!0),i=this._protocol._cipher.allocPacket(r.totalLen);if(r.push===void 0)i.set(r,5);else for(let s=0,o=5;s<r.length;++s){let f=r[s];i.set(f,o),o+=f.length}return i}return t}},ko=class{constructor(t){this.allocStart=5,this.allocStartKEX=5,this._protocol=t}cleanup(){}alloc(t,e){return this._protocol._kexinit===void 0||e?this._protocol._cipher.allocPacket(t):Buffer.allocUnsafe(t)}finalize(t,e){return t}},No=class{constructor(){this._zlib=new Wi(_l)}cleanup(){this._zlib&&vo(this._zlib)}read(t){return this._zlib.writeSync(t,!1)}},To=class{cleanup(){}read(t){return t}};Ka.exports={PacketReader:To,PacketWriter:ko,ZlibPacketReader:No,ZlibPacketWriter:Ro}});var Xa=ze((zA,$a)=>{"use strict";var{bufferSlice:Oo,bufferParser:R,doFatalError:lt,sigSSHToASN1:Wa,writeUInt32BE:Ga}=rn(),{CHANNEL_OPEN_FAILURE:Bl,COMPAT:Rl,MESSAGE:At,TERMINAL_MODE:Ya}=yn(),{parseKey:kl}=Ln(),Nl=Array.from(Object.entries(Ya)).reduce((n,[t,e])=>({...n,[t]:e}),{});$a.exports={[At.DISCONNECT]:(n,t)=>{R.init(t,1);let e=R.readUInt32BE(),r=R.readString(!0),i=R.readString();if(R.clear(),i===void 0)return lt(n,"Inbound: Malformed DISCONNECT packet");n._debug&&n._debug(`Inbound: Received DISCONNECT (${e}, "${r}")`);let s=n._handlers.DISCONNECT;s&&s(n,e,r)},[At.IGNORE]:(n,t)=>{n._debug&&n._debug("Inbound: Received IGNORE")},[At.UNIMPLEMENTED]:(n,t)=>{R.init(t,1);let e=R.readUInt32BE();if(R.clear(),e===void 0)return lt(n,"Inbound: Malformed UNIMPLEMENTED packet");n._debug&&n._debug(`Inbound: Received UNIMPLEMENTED (seqno ${e})`)},[At.DEBUG]:(n,t)=>{R.init(t,1);let e=R.readBool(),r=R.readString(!0),i=R.readString();if(R.clear(),i===void 0)return lt(n,"Inbound: Malformed DEBUG packet");n._debug&&n._debug("Inbound: Received DEBUG");let s=n._handlers.DEBUG;s&&s(n,e,r)},[At.SERVICE_REQUEST]:(n,t)=>{R.init(t,1);let e=R.readString(!0);if(R.clear(),e===void 0)return lt(n,"Inbound: Malformed SERVICE_REQUEST packet");n._debug&&n._debug(`Inbound: Received SERVICE_REQUEST (${e})`);let r=n._handlers.SERVICE_REQUEST;r&&r(n,e)},[At.SERVICE_ACCEPT]:(n,t)=>{R.init(t,1);let e=R.readString(!0);if(R.clear(),e===void 0)return lt(n,"Inbound: Malformed SERVICE_ACCEPT packet");n._debug&&n._debug(`Inbound: Received SERVICE_ACCEPT (${e})`);let r=n._handlers.SERVICE_ACCEPT;r&&r(n,e)},[At.EXT_INFO]:(n,t)=>{R.init(t,1);let e=R.readUInt32BE(),r;if(e!==void 0){r=[];for(let s=0;s<e;++s){let o=R.readString(!0),f=R.readString();if(f!==void 0)switch(o){case"server-sig-algs":{let a=f.latin1Slice(0,f.length).split(",");r.push({name:o,algs:a});continue}default:continue}r=void 0;break}}if(R.clear(),r===void 0)return lt(n,"Inbound: Malformed EXT_INFO packet");n._debug&&n._debug("Inbound: Received EXT_INFO");let i=n._handlers.EXT_INFO;i&&i(n,r)},[At.USERAUTH_REQUEST]:(n,t)=>{R.init(t,1);let e=R.readString(!0),r=R.readString(!0),i=R.readString(!0),s,o;switch(i){case"none":s=null;break;case"password":{let a=R.readBool();if(a!==void 0&&(s=R.readString(!0),s!==void 0&&a)){let u=R.readString(!0);u!==void 0?s={oldPassword:s,newPassword:u}:s=void 0}break}case"publickey":{let a=R.readBool();if(a!==void 0){let u=R.readString(!0),h=u,l=R.readString(),A;switch(u){case"rsa-sha2-256":h="ssh-rsa",A="sha256";break;case"rsa-sha2-512":h="ssh-rsa",A="sha512";break}if(a){let _=R.pos(),x=R.readString();if(x!==void 0&&(x.length>4+u.length+4&&x.utf8Slice(4,4+u.length)===u&&(x=Oo(x,4+u.length+4)),x=Wa(x,h),x)){let b=n._kex.sessionID,w=Buffer.allocUnsafe(4+b.length+_);Ga(w,b.length,0),w.set(b,4),w.set(new Uint8Array(t.buffer,t.byteOffset,_),4+b.length),s={keyAlgo:h,key:l,signature:x,blob:w,hashAlgo:A}}}else s={keyAlgo:h,key:l,hashAlgo:A},o="publickey -- check"}break}case"hostbased":{let a=R.readString(!0),u=a,h=R.readString(),l=R.readString(!0),A=R.readString(!0),_;switch(a){case"rsa-sha2-256":u="ssh-rsa",_="sha256";break;case"rsa-sha2-512":u="ssh-rsa",_="sha512";break}let x=R.pos(),b=R.readString();if(b!==void 0&&(b.length>4+a.length+4&&b.utf8Slice(4,4+a.length)===a&&(b=Oo(b,4+a.length+4)),b=Wa(b,u),b!==void 0)){let w=n._kex.sessionID,C=Buffer.allocUnsafe(4+w.length+x);Ga(C,w.length,0),C.set(w,4),C.set(new Uint8Array(t.buffer,t.byteOffset,x),4+w.length),s={keyAlgo:u,key:h,signature:b,blob:C,localHostname:l,localUsername:A,hashAlgo:_}}break}case"keyboard-interactive":R.skipString(),s=R.readList();break;default:i!==void 0&&(s=R.readRaw())}if(R.clear(),s===void 0)return lt(n,"Inbound: Malformed USERAUTH_REQUEST packet");o===void 0&&(o=i),n._authsQueue.push(i),n._debug&&n._debug(`Inbound: Received USERAUTH_REQUEST (${o})`);let f=n._handlers.USERAUTH_REQUEST;f&&f(n,e,r,i,s)},[At.USERAUTH_FAILURE]:(n,t)=>{R.init(t,1);let e=R.readList(),r=R.readBool();if(R.clear(),r===void 0)return lt(n,"Inbound: Malformed USERAUTH_FAILURE packet");n._debug&&n._debug(`Inbound: Received USERAUTH_FAILURE (${e})`),n._authsQueue.shift();let i=n._handlers.USERAUTH_FAILURE;i&&i(n,e,r)},[At.USERAUTH_SUCCESS]:(n,t)=>{n._debug&&n._debug("Inbound: Received USERAUTH_SUCCESS"),n._authsQueue.shift();let e=n._handlers.USERAUTH_SUCCESS;e&&e(n)},[At.USERAUTH_BANNER]:(n,t)=>{R.init(t,1);let e=R.readString(!0),r=R.readString();if(R.clear(),r===void 0)return lt(n,"Inbound: Malformed USERAUTH_BANNER packet");n._debug&&n._debug("Inbound: Received USERAUTH_BANNER");let i=n._handlers.USERAUTH_BANNER;i&&i(n,e)},60:(n,t)=>{if(!n._authsQueue.length){n._debug&&n._debug("Inbound: Received payload type 60 without auth");return}switch(n._authsQueue[0]){case"password":{R.init(t,1);let e=R.readString(!0),r=R.readString();if(R.clear(),r===void 0)return lt(n,"Inbound: Malformed USERAUTH_PASSWD_CHANGEREQ packet");n._debug&&n._debug("Inbound: Received USERAUTH_PASSWD_CHANGEREQ");let i=n._handlers.USERAUTH_PASSWD_CHANGEREQ;i&&i(n,e);break}case"publickey":{R.init(t,1);let e=R.readString(!0),r=R.readString();if(R.clear(),r===void 0)return lt(n,"Inbound: Malformed USERAUTH_PK_OK packet");n._debug&&n._debug("Inbound: Received USERAUTH_PK_OK"),n._authsQueue.shift();let i=n._handlers.USERAUTH_PK_OK;i&&i(n,e,r);break}case"keyboard-interactive":{R.init(t,1);let e=R.readString(!0),r=R.readString(!0);R.readString();let i=R.readUInt32BE(),s;if(i!==void 0){s=new Array(i);let f;for(f=0;f<i;++f){let a=R.readString(!0),u=R.readBool();if(u===void 0)break;s[f]={prompt:a,echo:u}}f!==i&&(s=void 0)}if(R.clear(),s===void 0)return lt(n,"Inbound: Malformed USERAUTH_INFO_REQUEST packet");n._debug&&n._debug("Inbound: Received USERAUTH_INFO_REQUEST");let o=n._handlers.USERAUTH_INFO_REQUEST;o&&o(n,e,r,s);break}default:n._debug&&n._debug("Inbound: Received unexpected payload type 60")}},61:(n,t)=>{if(!n._authsQueue.length){n._debug&&n._debug("Inbound: Received payload type 61 without auth");return}if(n._authsQueue[0]!=="keyboard-interactive")return lt(n,"Inbound: Received unexpected payload type 61");R.init(t,1);let e=R.readUInt32BE(),r;if(e!==void 0){r=new Array(e);let s;for(s=0;s<e;++s){let o=R.readString(!0);if(o===void 0)break;r[s]=o}s!==e&&(r=void 0)}if(R.clear(),r===void 0)return lt(n,"Inbound: Malformed USERAUTH_INFO_RESPONSE packet");n._debug&&n._debug("Inbound: Received USERAUTH_INFO_RESPONSE");let i=n._handlers.USERAUTH_INFO_RESPONSE;i&&i(n,r)},[At.GLOBAL_REQUEST]:(n,t)=>{R.init(t,1);let e=R.readString(!0),r=R.readBool(),i;if(r!==void 0)switch(e){case"tcpip-forward":case"cancel-tcpip-forward":{let o=R.readString(!0),f=R.readUInt32BE();f!==void 0&&(i={bindAddr:o,bindPort:f});break}case"streamlocal-forward@openssh.com":case"cancel-streamlocal-forward@openssh.com":{let o=R.readString(!0);o!==void 0&&(i={socketPath:o});break}case"no-more-sessions@openssh.com":i=null;break;case"hostkeys-00@openssh.com":{for(i=[];R.avail()>0;){let o=R.readString();if(o===void 0){i=void 0;break}let f=kl(o);f instanceof Error||i.push(f)}break}default:i=R.readRaw()}if(R.clear(),i===void 0)return lt(n,"Inbound: Malformed GLOBAL_REQUEST packet");n._debug&&n._debug(`Inbound: GLOBAL_REQUEST (${e})`);let s=n._handlers.GLOBAL_REQUEST;s?s(n,e,r,i):n.requestFailure()},[At.REQUEST_SUCCESS]:(n,t)=>{let e=t.length>1?Oo(t,1):null;n._debug&&n._debug("Inbound: REQUEST_SUCCESS");let r=n._handlers.REQUEST_SUCCESS;r&&r(n,e)},[At.REQUEST_FAILURE]:(n,t)=>{n._debug&&n._debug("Inbound: Received REQUEST_FAILURE");let e=n._handlers.REQUEST_FAILURE;e&&e(n)},[At.CHANNEL_OPEN]:(n,t)=>{R.init(t,1);let e=R.readString(!0),r=R.readUInt32BE(),i=R.readUInt32BE(),s=R.readUInt32BE(),o;switch(e){case"forwarded-tcpip":case"direct-tcpip":{let a=R.readString(!0),u=R.readUInt32BE(),h=R.readString(!0),l=R.readUInt32BE();l!==void 0&&(o={type:e,sender:r,window:i,packetSize:s,data:{destIP:a,destPort:u,srcIP:h,srcPort:l}});break}case"forwarded-streamlocal@openssh.com":case"direct-streamlocal@openssh.com":{let a=R.readString(!0);a!==void 0&&(o={type:e,sender:r,window:i,packetSize:s,data:{socketPath:a}});break}case"x11":{let a=R.readString(!0),u=R.readUInt32BE();u!==void 0&&(o={type:e,sender:r,window:i,packetSize:s,data:{srcIP:a,srcPort:u}});break}default:o={type:e,sender:r,window:i,packetSize:s,data:{}}}if(R.clear(),o===void 0)return lt(n,"Inbound: Malformed CHANNEL_OPEN packet");n._debug&&n._debug(`Inbound: CHANNEL_OPEN (s:${r}, ${e})`);let f=n._handlers.CHANNEL_OPEN;f?f(n,o):n.channelOpenFail(o.sender,Bl.ADMINISTRATIVELY_PROHIBITED,"","")},[At.CHANNEL_OPEN_CONFIRMATION]:(n,t)=>{R.init(t,1);let e=R.readUInt32BE(),r=R.readUInt32BE(),i=R.readUInt32BE(),s=R.readUInt32BE(),o=R.avail()?R.readRaw():void 0;if(R.clear(),s===void 0)return lt(n,"Inbound: Malformed CHANNEL_OPEN_CONFIRMATION packet");n._debug&&n._debug(`Inbound: CHANNEL_OPEN_CONFIRMATION (r:${e}, s:${r})`);let f=n._handlers.CHANNEL_OPEN_CONFIRMATION;f&&f(n,{recipient:e,sender:r,window:i,packetSize:s,data:o})},[At.CHANNEL_OPEN_FAILURE]:(n,t)=>{R.init(t,1);let e=R.readUInt32BE(),r=R.readUInt32BE(),i=R.readString(!0),s=R.readString();if(R.clear(),s===void 0)return lt(n,"Inbound: Malformed CHANNEL_OPEN_FAILURE packet");n._debug&&n._debug(`Inbound: CHANNEL_OPEN_FAILURE (r:${e})`);let o=n._handlers.CHANNEL_OPEN_FAILURE;o&&o(n,e,r,i)},[At.CHANNEL_WINDOW_ADJUST]:(n,t)=>{R.init(t,1);let e=R.readUInt32BE(),r=R.readUInt32BE();if(R.clear(),r===void 0)return lt(n,"Inbound: Malformed CHANNEL_WINDOW_ADJUST packet");n._debug&&n._debug(`Inbound: CHANNEL_WINDOW_ADJUST (r:${e}, ${r})`);let i=n._handlers.CHANNEL_WINDOW_ADJUST;i&&i(n,e,r)},[At.CHANNEL_DATA]:(n,t)=>{R.init(t,1);let e=R.readUInt32BE(),r=R.readString();if(R.clear(),r===void 0)return lt(n,"Inbound: Malformed CHANNEL_DATA packet");n._debug&&n._debug(`Inbound: CHANNEL_DATA (r:${e}, ${r.length})`);let i=n._handlers.CHANNEL_DATA;i&&i(n,e,r)},[At.CHANNEL_EXTENDED_DATA]:(n,t)=>{R.init(t,1);let e=R.readUInt32BE(),r=R.readUInt32BE(),i=R.readString();if(R.clear(),i===void 0)return lt(n,"Inbound: Malformed CHANNEL_EXTENDED_DATA packet");n._debug&&n._debug(`Inbound: CHANNEL_EXTENDED_DATA (r:${e}, ${i.length})`);let s=n._handlers.CHANNEL_EXTENDED_DATA;s&&s(n,e,i,r)},[At.CHANNEL_EOF]:(n,t)=>{R.init(t,1);let e=R.readUInt32BE();if(R.clear(),e===void 0)return lt(n,"Inbound: Malformed CHANNEL_EOF packet");n._debug&&n._debug(`Inbound: CHANNEL_EOF (r:${e})`);let r=n._handlers.CHANNEL_EOF;r&&r(n,e)},[At.CHANNEL_CLOSE]:(n,t)=>{R.init(t,1);let e=R.readUInt32BE();if(R.clear(),e===void 0)return lt(n,"Inbound: Malformed CHANNEL_CLOSE packet");n._debug&&n._debug(`Inbound: CHANNEL_CLOSE (r:${e})`);let r=n._handlers.CHANNEL_CLOSE;r&&r(n,e)},[At.CHANNEL_REQUEST]:(n,t)=>{R.init(t,1);let e=R.readUInt32BE(),r=R.readString(!0),i=R.readBool(),s;if(i!==void 0)switch(r){case"exit-status":s=R.readUInt32BE(),n._debug&&n._debug(`Inbound: CHANNEL_REQUEST (r:${e}, ${r}: ${s})`);break;case"exit-signal":{let f,a;if(n._compatFlags&Rl.OLD_EXIT){let h=R.readUInt32BE();switch(h){case 1:f="HUP";break;case 2:f="INT";break;case 3:f="QUIT";break;case 6:f="ABRT";break;case 9:f="KILL";break;case 14:f="ALRM";break;case 15:f="TERM";break;default:h!==void 0&&(f=`UNKNOWN (${h})`)}a=!1}else f=R.readString(!0),a=R.readBool(),a===void 0&&(f=void 0);let u=R.readString(!0);R.skipString()!==void 0&&(s={signal:f,coreDumped:a,errorMessage:u}),n._debug&&n._debug(`Inbound: CHANNEL_REQUEST (r:${e}, ${r}: ${f})`);break}case"pty-req":{let f=R.readString(!0),a=R.readUInt32BE(),u=R.readUInt32BE(),h=R.readUInt32BE(),l=R.readUInt32BE(),A=R.readString();if(A!==void 0){R.init(A,1);let _={};for(;R.avail();){let x=R.readByte();if(x===Ya.TTY_OP_END)break;let b=Nl[x],w=R.readUInt32BE();if(x===void 0||b===void 0||w===void 0){_=void 0;break}_[b]=w}_!==void 0&&(s={term:f,cols:a,rows:u,width:h,height:l,modes:_})}n._debug&&n._debug(`Inbound: CHANNEL_REQUEST (r:${e}, ${r})`);break}case"window-change":{let f=R.readUInt32BE(),a=R.readUInt32BE(),u=R.readUInt32BE(),h=R.readUInt32BE();h!==void 0&&(s={cols:f,rows:a,width:u,height:h}),n._debug&&n._debug(`Inbound: CHANNEL_REQUEST (r:${e}, ${r})`);break}case"x11-req":{let f=R.readBool(),a=R.readString(!0),u=R.readString(),h=R.readUInt32BE();h!==void 0&&(s={single:f,protocol:a,cookie:u,screen:h}),n._debug&&n._debug(`Inbound: CHANNEL_REQUEST (r:${e}, ${r})`);break}case"env":{let f=R.readString(!0),a=R.readString(!0);a!==void 0&&(s={name:f,value:a}),n._debug&&n._debug(`Inbound: CHANNEL_REQUEST (r:${e}, ${r}: ${f}=${a})`);break}case"shell":s=null,n._debug&&n._debug(`Inbound: CHANNEL_REQUEST (r:${e}, ${r})`);break;case"exec":s=R.readString(!0),n._debug&&n._debug(`Inbound: CHANNEL_REQUEST (r:${e}, ${r}: ${s})`);break;case"subsystem":s=R.readString(!0),n._debug&&n._debug(`Inbound: CHANNEL_REQUEST (r:${e}, ${r}: ${s})`);break;case"signal":s=R.readString(!0),n._debug&&n._debug(`Inbound: CHANNEL_REQUEST (r:${e}, ${r}: ${s})`);break;case"xon-xoff":s=R.readBool(),n._debug&&n._debug(`Inbound: CHANNEL_REQUEST (r:${e}, ${r}: ${s})`);break;case"auth-agent-req@openssh.com":s=null,n._debug&&n._debug(`Inbound: CHANNEL_REQUEST (r:${e}, ${r})`);break;default:s=R.avail()?R.readRaw():null,n._debug&&n._debug(`Inbound: CHANNEL_REQUEST (r:${e}, ${r})`)}if(R.clear(),s===void 0)return lt(n,"Inbound: Malformed CHANNEL_REQUEST packet");let o=n._handlers.CHANNEL_REQUEST;o&&o(n,e,r,i,s)},[At.CHANNEL_SUCCESS]:(n,t)=>{R.init(t,1);let e=R.readUInt32BE();if(R.clear(),e===void 0)return lt(n,"Inbound: Malformed CHANNEL_SUCCESS packet");n._debug&&n._debug(`Inbound: CHANNEL_SUCCESS (r:${e})`);let r=n._handlers.CHANNEL_SUCCESS;r&&r(n,e)},[At.CHANNEL_FAILURE]:(n,t)=>{R.init(t,1);let e=R.readUInt32BE();if(R.clear(),e===void 0)return lt(n,"Inbound: Malformed CHANNEL_FAILURE packet");n._debug&&n._debug(`Inbound: CHANNEL_FAILURE (r:${e})`);let r=n._handlers.CHANNEL_FAILURE;r&&r(n,e)}}});var Gi=ze((JA,ja)=>{"use strict";var Uo=new Array(256);[Yi().HANDLERS,Xa()].forEach(n=>{for(let[t,e]of Object.entries(n))t=+t,isFinite(t)&&t>=0&&t<Uo.length&&(Uo[t]=e)});ja.exports=Uo});var Yi=ze((eg,sc)=>{"use strict";var{createDiffieHellman:Tl,createDiffieHellmanGroup:vl,createECDH:Ll,createHash:Do,createPublicKey:Ol,diffieHellman:Ul,generateKeyPairSync:Pl,randomFillSync:Dl}=require("crypto"),{Ber:Va}=Qr(),{COMPAT:Qo,curve25519Supported:Ql,DEFAULT_KEX:za,DEFAULT_SERVER_HOST_KEY:Ja,DEFAULT_CIPHER:$i,DEFAULT_MAC:Xi,DEFAULT_COMPRESSION:ji,DISCONNECT_REASON:$e,MESSAGE:ut}=yn(),{CIPHER_INFO:pr,createCipher:Hl,createDecipher:Fl,MAC_INFO:Za}=Nn(),{parseDERKey:Ml}=Ln(),{bufferFill:ql,bufferParser:Ge,convertSignature:Kl,doFatalError:Xe,FastBuffer:Wl,sigSSHToASN1:Gl,writeUInt32BE:Nt}=rn(),{PacketReader:ec,PacketWriter:tc,ZlibPacketReader:Vi,ZlibPacketWriter:zi}=Lo(),Er,Yl=2048,$l=8192,Xl=Buffer.alloc(0);function nc(n){let t;if(n._compatFlags&Qo.BAD_DHGEX){let e=n._offer.lists.kex,r=e.array,i=!1;for(let s=0;s<r.length;++s)r[s].includes("group-exchange")&&(i||(i=!0,r=r.slice()),r.splice(s--,1));if(i){let s=17+n._offer.totalSize+1+4,o=Buffer.from(r.join(","));s-=e.buffer.length-o.length;let f=n._offer.lists.all,a=new Uint8Array(f.buffer,f.byteOffset+4+e.buffer.length,f.length-(4+e.buffer.length));t=Buffer.allocUnsafe(s),Nt(t,o.length,17),t.set(o,17+4),t.set(a,17+4+o.length)}}t===void 0&&(t=Buffer.allocUnsafe(1+16+n._offer.totalSize+1+4),n._offer.copyAllTo(t,17)),n._debug&&n._debug("Outbound: Sending KEXINIT"),t[0]=ut.KEXINIT,Dl(t,1,16),ql(t,0,t.length-5),n._kexinit=t,n._packetRW.write.allocStart=0;{let e=n._packetRW.write.allocStartKEX,r=n._packetRW.write.alloc(t.length,!0);r.set(t,e),n._cipher.encrypt(n._packetRW.write.finalize(r,!0))}}function rc(n,t){let e={kex:void 0,serverHostKey:void 0,cs:{cipher:void 0,mac:void 0,compress:void 0,lang:void 0},sc:{cipher:void 0,mac:void 0,compress:void 0,lang:void 0}};if(Ge.init(t,17),(e.kex=Ge.readList())===void 0||(e.serverHostKey=Ge.readList())===void 0||(e.cs.cipher=Ge.readList())===void 0||(e.sc.cipher=Ge.readList())===void 0||(e.cs.mac=Ge.readList())===void 0||(e.sc.mac=Ge.readList())===void 0||(e.cs.compress=Ge.readList())===void 0||(e.sc.compress=Ge.readList())===void 0||(e.cs.lang=Ge.readList())===void 0||(e.sc.lang=Ge.readList())===void 0)return Ge.clear(),Xe(n,"Received malformed KEXINIT","handshake",$e.KEY_EXCHANGE_FAILED);let r=Ge.pos(),i=r<t.length&&t[r]===1;Ge.clear();let s=n._offer,o=e,f=s.lists.kex.array;if(n._compatFlags&Qo.BAD_DHGEX){let L=!1;for(let z=0;z<f.length;++z)f[z].indexOf("group-exchange")!==-1&&(L||(L=!0,f=f.slice()),f.splice(z--,1))}let a,u,h,l=n._debug;l&&l("Inbound: Handshake in progress"),l&&l(`Handshake: (local) KEX method: ${f}`),l&&l(`Handshake: (remote) KEX method: ${o.kex}`);let A;if(n._server?(u=f,a=o.kex,A=a.indexOf("ext-info-c")!==-1):(u=o.kex,a=f,A=u.indexOf("ext-info-s")!==-1),n._strictMode===void 0&&(n._server?n._strictMode=a.indexOf("kex-strict-c-v00@openssh.com")!==-1:n._strictMode=u.indexOf("kex-strict-s-v00@openssh.com")!==-1,n._strictMode&&(l&&l("Handshake: strict KEX mode enabled"),n._decipher.inSeqno!==1)))return l&&l("Handshake: KEXINIT not first packet in strict KEX mode"),Xe(n,"Handshake failed: KEXINIT not first packet in strict KEX mode","handshake",$e.KEY_EXCHANGE_FAILED);for(h=0;h<a.length&&u.indexOf(a[h])===-1;++h);if(h===a.length)return l&&l("Handshake: no matching key exchange algorithm"),Xe(n,"Handshake failed: no matching key exchange algorithm","handshake",$e.KEY_EXCHANGE_FAILED);e.kex=a[h],l&&l(`Handshake: KEX algorithm: ${a[h]}`),i&&(!o.kex.length||a[h]!==o.kex[0])&&(n._skipNextInboundPacket=!0);let _=s.lists.serverHostKey.array;for(l&&l(`Handshake: (local) Host key format: ${_}`),l&&l(`Handshake: (remote) Host key format: ${o.serverHostKey}`),n._server?(u=_,a=o.serverHostKey):(u=o.serverHostKey,a=_),h=0;h<a.length&&u.indexOf(a[h])===-1;++h);if(h===a.length)return l&&l("Handshake: No matching host key format"),Xe(n,"Handshake failed: no matching host key format","handshake",$e.KEY_EXCHANGE_FAILED);e.serverHostKey=a[h],l&&l(`Handshake: Host key format: ${a[h]}`);let x=s.lists.cs.cipher.array;for(l&&l(`Handshake: (local) C->S cipher: ${x}`),l&&l(`Handshake: (remote) C->S cipher: ${o.cs.cipher}`),n._server?(u=x,a=o.cs.cipher):(u=o.cs.cipher,a=x),h=0;h<a.length&&u.indexOf(a[h])===-1;++h);if(h===a.length)return l&&l("Handshake: No matching C->S cipher"),Xe(n,"Handshake failed: no matching C->S cipher","handshake",$e.KEY_EXCHANGE_FAILED);e.cs.cipher=a[h],l&&l(`Handshake: C->S Cipher: ${a[h]}`);let b=s.lists.sc.cipher.array;for(l&&l(`Handshake: (local) S->C cipher: ${b}`),l&&l(`Handshake: (remote) S->C cipher: ${o.sc.cipher}`),n._server?(u=b,a=o.sc.cipher):(u=o.sc.cipher,a=b),h=0;h<a.length&&u.indexOf(a[h])===-1;++h);if(h===a.length)return l&&l("Handshake: No matching S->C cipher"),Xe(n,"Handshake failed: no matching S->C cipher","handshake",$e.KEY_EXCHANGE_FAILED);e.sc.cipher=a[h],l&&l(`Handshake: S->C cipher: ${a[h]}`);let w=s.lists.cs.mac.array;if(l&&l(`Handshake: (local) C->S MAC: ${w}`),l&&l(`Handshake: (remote) C->S MAC: ${o.cs.mac}`),pr[e.cs.cipher].authLen>0)e.cs.mac="",l&&l("Handshake: C->S MAC: <implicit>");else{for(n._server?(u=w,a=o.cs.mac):(u=o.cs.mac,a=w),h=0;h<a.length&&u.indexOf(a[h])===-1;++h);if(h===a.length)return l&&l("Handshake: No matching C->S MAC"),Xe(n,"Handshake failed: no matching C->S MAC","handshake",$e.KEY_EXCHANGE_FAILED);e.cs.mac=a[h],l&&l(`Handshake: C->S MAC: ${a[h]}`)}let C=s.lists.sc.mac.array;if(l&&l(`Handshake: (local) S->C MAC: ${C}`),l&&l(`Handshake: (remote) S->C MAC: ${o.sc.mac}`),pr[e.sc.cipher].authLen>0)e.sc.mac="",l&&l("Handshake: S->C MAC: <implicit>");else{for(n._server?(u=C,a=o.sc.mac):(u=o.sc.mac,a=C),h=0;h<a.length&&u.indexOf(a[h])===-1;++h);if(h===a.length)return l&&l("Handshake: No matching S->C MAC"),Xe(n,"Handshake failed: no matching S->C MAC","handshake",$e.KEY_EXCHANGE_FAILED);e.sc.mac=a[h],l&&l(`Handshake: S->C MAC: ${a[h]}`)}let v=s.lists.cs.compress.array;for(l&&l(`Handshake: (local) C->S compression: ${v}`),l&&l(`Handshake: (remote) C->S compression: ${o.cs.compress}`),n._server?(u=v,a=o.cs.compress):(u=o.cs.compress,a=v),h=0;h<a.length&&u.indexOf(a[h])===-1;++h);if(h===a.length)return l&&l("Handshake: No matching C->S compression"),Xe(n,"Handshake failed: no matching C->S compression","handshake",$e.KEY_EXCHANGE_FAILED);e.cs.compress=a[h],l&&l(`Handshake: C->S compression: ${a[h]}`);let X=s.lists.sc.compress.array;for(l&&l(`Handshake: (local) S->C compression: ${X}`),l&&l(`Handshake: (remote) S->C compression: ${o.sc.compress}`),n._server?(u=X,a=o.sc.compress):(u=o.sc.compress,a=X),h=0;h<a.length&&u.indexOf(a[h])===-1;++h);if(h===a.length)return l&&l("Handshake: No matching S->C compression"),Xe(n,"Handshake failed: no matching S->C compression","handshake",$e.KEY_EXCHANGE_FAILED);e.sc.compress=a[h],l&&l(`Handshake: S->C compression: ${a[h]}`),e.cs.lang="",e.sc.lang="",n._kex&&(n._kexinit||nc(n),n._decipher._onPayload=ic.bind(n,{firstPacket:!1})),n._kex=jl(e,n,t),n._kex.remoteExtInfoEnabled=A,n._kex.start()}var jl=(()=>{function n(o){let f=0,a=o.length;for(;o[f]===0;)++f,--a;let u;return o[f]&128?(u=Buffer.allocUnsafe(1+a),u[0]=0,o.copy(u,1,f),o=u):a!==o.length&&(u=Buffer.allocUnsafe(a),o.copy(u,0,f),o=u),o}class t{constructor(f,a,u){this._protocol=a,this.sessionID=a._kex?a._kex.sessionID:void 0,this.negotiated=f,this.remoteExtInfoEnabled=!1,this._step=1,this._public=null,this._dh=null,this._sentNEWKEYS=!1,this._receivedNEWKEYS=!1,this._finished=!1,this._hostVerified=!1,this._kexinit=a._kexinit,this._remoteKexinit=u,this._identRaw=a._identRaw,this._remoteIdentRaw=a._remoteIdentRaw,this._hostKey=void 0,this._dhData=void 0,this._sig=void 0}finish(f){if(this._finished)return!1;this._finished=!0;let a=this._protocol._server,u=this.negotiated,h=this.convertPublicKey(this._dhData),l=this.computeSecret(this._dhData);if(l instanceof Error)return l.message=`Error while computing DH secret (${this.type}): ${l.message}`,l.level="handshake",Xe(this._protocol,l,$e.KEY_EXCHANGE_FAILED);let A=Do(this.hashName);An(A,a?this._remoteIdentRaw:this._identRaw),An(A,a?this._identRaw:this._remoteIdentRaw),An(A,a?this._remoteKexinit:this._kexinit),An(A,a?this._kexinit:this._remoteKexinit);let _=a?this._hostKey.getPublicSSH():this._hostKey;if(An(A,_),this.type==="groupex"){let X=this.getDHParams(),L=Buffer.allocUnsafe(4);Nt(L,this._minBits,0),A.update(L),Nt(L,this._prefBits,0),A.update(L),Nt(L,this._maxBits,0),A.update(L),An(A,X.prime),An(A,X.generator)}An(A,a?h:this.getPublicKey());let x=a?this.getPublicKey():h;An(A,x),An(A,l);let b=A.digest();if(a){let X;switch(this.negotiated.serverHostKey){case"rsa-sha2-256":X="sha256";break;case"rsa-sha2-512":X="sha512";break}this._protocol._debug&&this._protocol._debug("Generating signature ...");let L=this._hostKey.sign(b,X);if(L instanceof Error)return Xe(this._protocol,`Handshake failed: signature generation failed for ${this._hostKey.type} host key: ${L.message}`,"handshake",$e.KEY_EXCHANGE_FAILED);if(L=Kl(L,this._hostKey.type),L===!1)return Xe(this._protocol,`Handshake failed: signature conversion failed for ${this._hostKey.type} host key`,"handshake",$e.KEY_EXCHANGE_FAILED);let z=this.negotiated.serverHostKey,ne=Buffer.byteLength(z),J=4+ne+4+L.length,y=this._protocol._packetRW.write.allocStartKEX,S=this._protocol._packetRW.write.alloc(1+4+_.length+4+x.length+4+J,!0);if(S[y]=ut.KEXDH_REPLY,Nt(S,_.length,++y),S.set(_,y+=4),Nt(S,x.length,y+=_.length),S.set(x,y+=4),Nt(S,J,y+=x.length),Nt(S,ne,y+=4),S.utf8Write(z,y+=4,ne),Nt(S,L.length,y+=ne),S.set(L,y+=4),this._protocol._debug){let O;switch(this.type){case"group":O="KEXDH_REPLY";break;case"groupex":O="KEXDH_GEX_REPLY";break;default:O="KEXECDH_REPLY"}this._protocol._debug(`Outbound: Sending ${O}`)}this._protocol._cipher.encrypt(this._protocol._packetRW.write.finalize(S,!0))}else{Ge.init(this._sig,0);let X=Ge.readString(!0);if(!X)return Xe(this._protocol,"Malformed packet while reading signature","handshake",$e.KEY_EXCHANGE_FAILED);if(X!==u.serverHostKey)return Xe(this._protocol,`Wrong signature type: ${X}, expected: ${u.serverHostKey}`,"handshake",$e.KEY_EXCHANGE_FAILED);let L=Ge.readString();if(Ge.clear(),L===void 0)return Xe(this._protocol,"Malformed packet while reading signature","handshake",$e.KEY_EXCHANGE_FAILED);if(!(L=Gl(L,X)))return Xe(this._protocol,"Malformed signature","handshake",$e.KEY_EXCHANGE_FAILED);let z;{Ge.init(this._hostKey,0);let y=Ge.readString(!0),S=this._hostKey.slice(Ge.pos());if(Ge.clear(),z=Ml(S,y),z instanceof Error)return z.level="handshake",Xe(this._protocol,z,$e.KEY_EXCHANGE_FAILED)}let ne;switch(this.negotiated.serverHostKey){case"rsa-sha2-256":ne="sha256";break;case"rsa-sha2-512":ne="sha512";break}this._protocol._debug&&this._protocol._debug("Verifying signature ...");let J=z.verify(b,L,ne);if(J!==!0)return J instanceof Error?this._protocol._debug&&this._protocol._debug(`Signature verification failed: ${J.stack}`):this._protocol._debug&&this._protocol._debug("Signature verification failed"),Xe(this._protocol,"Handshake failed: signature verification failed","handshake",$e.KEY_EXCHANGE_FAILED);this._protocol._debug&&this._protocol._debug("Verified signature")}(a||!f)&&Ji(this);let w,C,v=X=>{if(w)return Ji(this),w.outbound.seqno=this._protocol._cipher.outSeqno,this._protocol._cipher.free(),this._protocol._cipher=Hl(w),this._protocol._packetRW.write=C,w=void 0,C=void 0,this._protocol._onHandshakeComplete(u),!1;this.sessionID||(this.sessionID=b);{let re=Buffer.allocUnsafe(4+l.length);Nt(re,l.length,0),re.set(l,4),l=re}let L=pr[u.cs.cipher],z=pr[u.sc.cipher],ne=_r(L.ivLen,this.hashName,l,b,this.sessionID,"A"),J=_r(z.ivLen,this.hashName,l,b,this.sessionID,"B"),y=_r(L.keyLen,this.hashName,l,b,this.sessionID,"C"),S=_r(z.keyLen,this.hashName,l,b,this.sessionID,"D"),O,q;L.authLen||(O=Za[u.cs.mac],q=_r(O.len,this.hashName,l,b,this.sessionID,"E"));let H,se;z.authLen||(H=Za[u.sc.mac],se=_r(H.len,this.hashName,l,b,this.sessionID,"F"));let te={inbound:{onPayload:this._protocol._onPayload,seqno:this._protocol._decipher.inSeqno,decipherInfo:a?L:z,decipherIV:a?ne:J,decipherKey:a?y:S,macInfo:a?O:H,macKey:a?q:se},outbound:{onWrite:this._protocol._onWrite,seqno:this._protocol._cipher.outSeqno,cipherInfo:a?z:L,cipherIV:a?J:ne,cipherKey:a?S:y,macInfo:a?H:O,macKey:a?se:q}};this._protocol._decipher.free(),w=te,this._protocol._decipher=Fl(te);let Z={read:void 0,write:void 0};switch(u.cs.compress){case"zlib":a?Z.read=new Vi:Z.write=new zi(this._protocol);break;case"zlib@openssh.com":if(this._protocol._authenticated){a?Z.read=new Vi:Z.write=new zi(this._protocol);break}default:a?Z.read=new ec:Z.write=new tc(this._protocol)}switch(u.sc.compress){case"zlib":a?Z.write=new zi(this._protocol):Z.read=new Vi;break;case"zlib@openssh.com":if(this._protocol._authenticated){a?Z.write=new zi(this._protocol):Z.read=new Vi;break}default:a?Z.write=new tc(this._protocol):Z.read=new ec}return this._protocol._packetRW.read.cleanup(),this._protocol._packetRW.write.cleanup(),this._protocol._packetRW.read=Z.read,C=Z.write,this._public=null,this._dh=null,this._kexinit=this._protocol._kexinit=void 0,this._remoteKexinit=void 0,this._identRaw=void 0,this._remoteIdentRaw=void 0,this._hostKey=void 0,this._dhData=void 0,this._sig=void 0,X?!1:v()};if((a||f)&&(this.finish=v),!a)return v(f)}start(){if(!this._protocol._server){if(this._protocol._debug){let h;switch(this.type){case"group":h="KEXDH_INIT";break;default:h="KEXECDH_INIT"}this._protocol._debug(`Outbound: Sending ${h}`)}let f=this.getPublicKey(),a=this._protocol._packetRW.write.allocStartKEX,u=this._protocol._packetRW.write.alloc(1+4+f.length,!0);u[a]=ut.KEXDH_INIT,Nt(u,f.length,++a),u.set(f,a+=4),this._protocol._cipher.encrypt(this._protocol._packetRW.write.finalize(u,!0))}}getPublicKey(){this.generateKeys();let f=this._public;if(f)return this.convertPublicKey(f)}convertPublicKey(f){let a,u=0,h=f.length;for(;f[u]===0;)++u,--h;return f[u]&128?(a=Buffer.allocUnsafe(1+h),a[0]=0,f.copy(a,1,u),a):(h!==f.length&&(a=Buffer.allocUnsafe(h),f.copy(a,0,u),f=a),f)}computeSecret(f){this.generateKeys();try{return n(this._dh.computeSecret(f))}catch(a){return a}}parse(f){let a=f[0];switch(this._step){case 1:if(this._protocol._server){if(a!==ut.KEXDH_INIT)return Xe(this._protocol,`Received packet ${a} instead of ${ut.KEXDH_INIT}`,"handshake",$e.KEY_EXCHANGE_FAILED);this._protocol._debug&&this._protocol._debug("Received DH Init"),Ge.init(f,1);let u=Ge.readString();if(Ge.clear(),u===void 0)return Xe(this._protocol,"Received malformed KEX*_INIT","handshake",$e.KEY_EXCHANGE_FAILED);this._dhData=u;let h=this._protocol._hostKeys[this.negotiated.serverHostKey];Array.isArray(h)&&(h=h[0]),this._hostKey=h,this.finish()}else{if(a!==ut.KEXDH_REPLY)return Xe(this._protocol,`Received packet ${a} instead of ${ut.KEXDH_REPLY}`,"handshake",$e.KEY_EXCHANGE_FAILED);this._protocol._debug&&this._protocol._debug("Received DH Reply"),Ge.init(f,1);let u,h,l;if((u=Ge.readString())===void 0||(h=Ge.readString())===void 0||(l=Ge.readString())===void 0)return Ge.clear(),Xe(this._protocol,"Received malformed KEX*_REPLY","handshake",$e.KEY_EXCHANGE_FAILED);Ge.clear(),Ge.init(u,0);let A=Ge.readString(!0);if(Ge.clear(),A===void 0)return Xe(this._protocol,"Received malformed host public key","handshake",$e.KEY_EXCHANGE_FAILED);if(A!==this.negotiated.serverHostKey)switch(this.negotiated.serverHostKey){case"rsa-sha2-256":case"rsa-sha2-512":if(A==="ssh-rsa")break;default:return Xe(this._protocol,"Host key does not match negotiated type","handshake",$e.KEY_EXCHANGE_FAILED)}this._hostKey=u,this._dhData=h,this._sig=l;let _=!1,x;if(this._protocol._hostVerifier===void 0?(x=!0,this._protocol._debug&&this._protocol._debug("Host accepted by default (no verification)")):x=this._protocol._hostVerifier(u,b=>{if(!_){if(_=!0,b===!1)return this._protocol._debug&&this._protocol._debug("Host denied (verification failed)"),Xe(this._protocol,"Host denied (verification failed)","handshake",$e.KEY_EXCHANGE_FAILED);this._protocol._debug&&this._protocol._debug("Host accepted (verified)"),this._hostVerified=!0,this._receivedNEWKEYS?this.finish():Ji(this)}}),x===void 0){++this._step;return}if(_=!0,x===!1)return this._protocol._debug&&this._protocol._debug("Host denied (verification failed)"),Xe(this._protocol,"Host denied (verification failed)","handshake",$e.KEY_EXCHANGE_FAILED);this._protocol._debug&&this._protocol._debug("Host accepted (verified)"),this._hostVerified=!0,Ji(this)}++this._step;break;case 2:return a!==ut.NEWKEYS?Xe(this._protocol,`Received packet ${a} instead of ${ut.NEWKEYS}`,"handshake",$e.KEY_EXCHANGE_FAILED):(this._protocol._debug&&this._protocol._debug("Inbound: NEWKEYS"),this._receivedNEWKEYS=!0,this._protocol._strictMode&&(this._protocol._decipher.inSeqno=0),++this._step,this.finish(!this._protocol._server&&!this._hostVerified));default:return Xe(this._protocol,`Received unexpected packet ${a} after NEWKEYS`,"handshake",$e.KEY_EXCHANGE_FAILED)}}}class e extends t{constructor(f,...a){super(...a),this.type="25519",this.hashName=f,this._keys=null}generateKeys(){this._keys||(this._keys=Pl("x25519"))}getPublicKey(){return this.generateKeys(),this._keys.publicKey.export({type:"spki",format:"der"}).slice(-32)}convertPublicKey(f){let a,u=0,h=f.length;for(;f[u]===0;)++u,--h;return f.length===32||h!==f.length&&(a=Buffer.allocUnsafe(h),f.copy(a,0,u),f=a),f}computeSecret(f){this.generateKeys();try{let a=new Va.Writer;return a.startSequence(),a.startSequence(),a.writeOID("1.3.101.110"),a.endSequence(),a.startSequence(Va.BitString),a.writeByte(0),a._ensure(f.length),f.copy(a._buf,a._offset,0,f.length),a._offset+=f.length,a.endSequence(),a.endSequence(),n(Ul({privateKey:this._keys.privateKey,publicKey:Ol({key:a.buffer,type:"spki",format:"der"})}))}catch(a){return a}}}class r extends t{constructor(f,a,...u){super(...u),this.type="ecdh",this.curveName=f,this.hashName=a}generateKeys(){this._dh||(this._dh=Ll(this.curveName),this._public=this._dh.generateKeys())}}class i extends t{constructor(f,...a){super(...a),this.type="groupex",this.hashName=f,this._prime=null,this._generator=null,this._minBits=Yl,this._prefBits=Vl(this.negotiated),this._protocol._compatFlags&Qo.BUG_DHGEX_LARGE&&(this._prefBits=Math.min(this._prefBits,4096)),this._maxBits=$l}start(){if(this._protocol._server)return;this._protocol._debug&&this._protocol._debug("Outbound: Sending KEXDH_GEX_REQUEST");let f=this._protocol._packetRW.write.allocStartKEX,a=this._protocol._packetRW.write.alloc(1+4+4+4,!0);a[f]=ut.KEXDH_GEX_REQUEST,Nt(a,this._minBits,++f),Nt(a,this._prefBits,f+=4),Nt(a,this._maxBits,f+=4),this._protocol._cipher.encrypt(this._protocol._packetRW.write.finalize(a,!0))}generateKeys(){!this._dh&&this._prime&&this._generator&&(this._dh=Tl(this._prime,this._generator),this._public=this._dh.generateKeys())}setDHParams(f,a){if(!Buffer.isBuffer(f))throw new Error("Invalid prime value");if(!Buffer.isBuffer(a))throw new Error("Invalid generator value");this._prime=f,this._generator=a}getDHParams(){if(this._dh)return{prime:n(this._dh.getPrime()),generator:n(this._dh.getGenerator())}}parse(f){let a=f[0];switch(this._step){case 1:{if(this._protocol._server)return a!==ut.KEXDH_GEX_REQUEST?Xe(this._protocol,`Received packet ${a} instead of `+ut.KEXDH_GEX_REQUEST,"handshake",$e.KEY_EXCHANGE_FAILED):Xe(this._protocol,"Group exchange not implemented for server","handshake",$e.KEY_EXCHANGE_FAILED);if(a!==ut.KEXDH_GEX_GROUP)return Xe(this._protocol,`Received packet ${a} instead of ${ut.KEXDH_GEX_GROUP}`,"handshake",$e.KEY_EXCHANGE_FAILED);this._protocol._debug&&this._protocol._debug("Received DH GEX Group"),Ge.init(f,1);let u,h;if((u=Ge.readString())===void 0||(h=Ge.readString())===void 0)return Ge.clear(),Xe(this._protocol,"Received malformed KEXDH_GEX_GROUP","handshake",$e.KEY_EXCHANGE_FAILED);Ge.clear(),this.setDHParams(u,h),this.generateKeys();let l=this.getPublicKey();this._protocol._debug&&this._protocol._debug("Outbound: Sending KEXDH_GEX_INIT");let A=this._protocol._packetRW.write.allocStartKEX,_=this._protocol._packetRW.write.alloc(1+4+l.length,!0);_[A]=ut.KEXDH_GEX_INIT,Nt(_,l.length,++A),_.set(l,A+=4),this._protocol._cipher.encrypt(this._protocol._packetRW.write.finalize(_,!0)),++this._step;break}case 2:if(this._protocol._server)return a!==ut.KEXDH_GEX_INIT?Xe(this._protocol,`Received packet ${a} instead of ${ut.KEXDH_GEX_INIT}`,"handshake",$e.KEY_EXCHANGE_FAILED):(this._protocol._debug&&this._protocol._debug("Received DH GEX Init"),Xe(this._protocol,"Group exchange not implemented for server","handshake",$e.KEY_EXCHANGE_FAILED));if(a!==ut.KEXDH_GEX_REPLY)return Xe(this._protocol,`Received packet ${a} instead of ${ut.KEXDH_GEX_REPLY}`,"handshake",$e.KEY_EXCHANGE_FAILED);this._protocol._debug&&this._protocol._debug("Received DH GEX Reply"),this._step=1,f[0]=ut.KEXDH_REPLY,this.parse=t.prototype.parse,this.parse(f)}}}class s extends t{constructor(f,a,...u){super(...u),this.type="group",this.groupName=f,this.hashName=a}start(){if(!this._protocol._server){this._protocol._debug&&this._protocol._debug("Outbound: Sending KEXDH_INIT");let f=this.getPublicKey(),a=this._protocol._packetRW.write.allocStartKEX,u=this._protocol._packetRW.write.alloc(1+4+f.length,!0);u[a]=ut.KEXDH_INIT,Nt(u,f.length,++a),u.set(f,a+=4),this._protocol._cipher.encrypt(this._protocol._packetRW.write.finalize(u,!0))}}generateKeys(){this._dh||(this._dh=vl(this.groupName),this._public=this._dh.generateKeys())}getDHParams(){if(this._dh)return{prime:n(this._dh.getPrime()),generator:n(this._dh.getGenerator())}}}return(o,...f)=>{if(typeof o!="object"||o===null)throw new Error("Invalid negotiated argument");let a=o.kex;if(typeof a=="string"){switch(f=[o,...f],a){case"curve25519-sha256":case"curve25519-sha256@libssh.org":if(!Ql)break;return new e("sha256",...f);case"ecdh-sha2-nistp256":return new r("prime256v1","sha256",...f);case"ecdh-sha2-nistp384":return new r("secp384r1","sha384",...f);case"ecdh-sha2-nistp521":return new r("secp521r1","sha512",...f);case"diffie-hellman-group1-sha1":return new s("modp2","sha1",...f);case"diffie-hellman-group14-sha1":return new s("modp14","sha1",...f);case"diffie-hellman-group14-sha256":return new s("modp14","sha256",...f);case"diffie-hellman-group15-sha512":return new s("modp15","sha512",...f);case"diffie-hellman-group16-sha512":return new s("modp16","sha512",...f);case"diffie-hellman-group17-sha512":return new s("modp17","sha512",...f);case"diffie-hellman-group18-sha512":return new s("modp18","sha512",...f);case"diffie-hellman-group-exchange-sha1":return new i("sha1",...f);case"diffie-hellman-group-exchange-sha256":return new i("sha256",...f)}throw new Error(`Unsupported key exchange algorithm: ${a}`)}throw new Error(`Invalid key exchange type: ${a}`)}})(),Po=(()=>{let n=["kex","serverHostKey",["cs","cipher"],["sc","cipher"],["cs","mac"],["sc","mac"],["cs","compress"],["sc","compress"],["cs","lang"],["sc","lang"]];return class{constructor(e){if(typeof e!="object"||e===null)throw new TypeError("Argument must be an object");let r={kex:void 0,serverHostKey:void 0,cs:{cipher:void 0,mac:void 0,compress:void 0,lang:void 0},sc:{cipher:void 0,mac:void 0,compress:void 0,lang:void 0},all:void 0},i=0;for(let f of n){let a,u,h,l;if(typeof f=="string")a=r,u=e[f],h=l=f;else{let _=f[0];a=r[_],l=f[1],u=e[_][l],h=`${_}.${l}`}let A={array:void 0,buffer:void 0};if(Buffer.isBuffer(u))A.array=(""+u).split(","),A.buffer=u,i+=4+u.length;else{if(typeof u=="string"&&(u=u.split(",")),Array.isArray(u))A.array=u,A.buffer=Buffer.from(u.join(","));else throw new TypeError(`Invalid \`${h}\` type: ${typeof u}`);i+=4+A.buffer.length}a[l]=A}let s=Buffer.allocUnsafe(i);r.all=s;let o=0;for(let f of n){let a;typeof f=="string"?a=r[f].buffer:a=r[f[0]][f[1]].buffer,o=Nt(s,a.length,o),s.set(a,o),o+=a.length}this.totalSize=i,this.lists=r}copyAllTo(e,r){let i=this.lists.all;if(typeof r!="number")throw new TypeError(`Invalid offset value: ${typeof r}`);if(e.length-r<i.length)throw new Error("Insufficient space to copy list");return e.set(i,r),i.length}}})(),An=(()=>{let n=Buffer.allocUnsafe(4);return(t,e)=>{Nt(n,e.length,0),t.update(n),t.update(e)}})();function _r(n,t,e,r,i,s){let o;if(n){let f=Do(t).update(e).update(r).update(s).update(i).digest();for(;f.length<n;){let a=Do(t).update(e).update(r).update(f).digest(),u=Buffer.allocUnsafe(f.length+a.length);u.set(f,0),u.set(a,f.length),f=u}f.length===n?o=f:o=new Wl(f.buffer,f.byteOffset,n)}else o=Xl;return o}function ic(n,t){if(t.length===0){this._debug&&this._debug("Inbound: Skipping empty packet payload");return}if(this._skipNextInboundPacket){this._skipNextInboundPacket=!1;return}t=this._packetRW.read.read(t);let e=t[0];if(!this._strictMode)switch(e){case ut.IGNORE:case ut.UNIMPLEMENTED:case ut.DEBUG:return Er||(Er=Gi()),Er[e](this,t)}switch(e){case ut.DISCONNECT:return Er||(Er=Gi()),Er[e](this,t);case ut.KEXINIT:return n.firstPacket?(n.firstPacket=!1,rc(this,t)):Xe(this,"Received extra KEXINIT during handshake","handshake",$e.KEY_EXCHANGE_FAILED);default:if(e<20||e>49)return Xe(this,`Received unexpected packet type ${e}`,"handshake",$e.KEY_EXCHANGE_FAILED)}return this._kex.parse(t)}function Vl(n){let t=pr[n.cs.cipher],e=pr[n.sc.cipher],r=Math.max(0,t.sslName==="des-ede3-cbc"?14:t.keyLen,t.blockLen,t.ivLen,e.sslName==="des-ede3-cbc"?14:e.keyLen,e.blockLen,e.ivLen)*8;return r<=112?2048:r<=128?3072:r<=192?7680:8192}function Ji(n){if(!n._sentNEWKEYS){n._protocol._debug&&n._protocol._debug("Outbound: Sending NEWKEYS");let t=n._protocol._packetRW.write.allocStartKEX,e=n._protocol._packetRW.write.alloc(1,!0);e[t]=ut.NEWKEYS,n._protocol._cipher.encrypt(n._protocol._packetRW.write.finalize(e,!0)),n._sentNEWKEYS=!0,n._protocol._strictMode&&(n._protocol._cipher.outSeqno=0)}}sc.exports={KexInit:Po,kexinit:nc,onKEXPayload:ic,DEFAULT_KEXINIT_CLIENT:new Po({kex:za.concat(["ext-info-c","kex-strict-c-v00@openssh.com"]),serverHostKey:Ja,cs:{cipher:$i,mac:Xi,compress:ji,lang:[]},sc:{cipher:$i,mac:Xi,compress:ji,lang:[]}}),DEFAULT_KEXINIT_SERVER:new Po({kex:za.concat(["kex-strict-s-v00@openssh.com"]),serverHostKey:Ja,cs:{cipher:$i,mac:Xi,compress:ji,lang:[]},sc:{cipher:$i,mac:Xi,compress:ji,lang:[]}}),HANDLERS:{[ut.KEXINIT]:rc}}});var oc=ze((tg,zl)=>{zl.exports={name:"ssh2",version:"1.15.0",author:"Brian White <mscdex@mscdex.net>",description:"SSH2 client and server modules written in pure JavaScript for node.js",main:"./lib/index.js",engines:{node:">=10.16.0"},dependencies:{asn1:"^0.2.6","bcrypt-pbkdf":"^1.0.2"},devDependencies:{"@mscdex/eslint-config":"^1.1.0",eslint:"^7.32.0"},optionalDependencies:{"cpu-features":"~0.0.9",nan:"^2.18.0"},scripts:{install:"node install.js",rebuild:"node install.js",test:"node test/test.js",lint:"eslint --cache --report-unused-disable-directives --ext=.js .eslintrc.js examples lib test","lint:fix":"npm run lint -- --fix"},keywords:["ssh","ssh2","sftp","secure","shell","exec","remote","client"],licenses:[{type:"MIT",url:"http://github.com/mscdex/ssh2/raw/master/LICENSE"}],repository:{type:"git",url:"http://github.com/mscdex/ssh2.git"}}});var qo=ze((ng,bc)=>{"use strict";var{inspect:lc}=require("util"),{bindingAvailable:Jl,NullCipher:Zl,NullDecipher:ed}=Nn(),{COMPAT_CHECKS:td,DISCONNECT_REASON:dc,eddsaSupported:nd,MESSAGE:ye,SIGNALS:fc,TERMINAL_MODE:Fo}=yn(),{DEFAULT_KEXINIT_CLIENT:rd,DEFAULT_KEXINIT_SERVER:id,KexInit:ac,kexinit:Ac,onKEXPayload:sd}=Yi(),{parseKey:cc}=Ln(),od=Gi(),{bufferCopy:Zi,bufferFill:fd,bufferSlice:gc,convertSignature:uc,sendPacket:Se,writeUInt32BE:m}=rn(),{PacketReader:ad,PacketWriter:cd,ZlibPacketReader:Ec,ZlibPacketWriter:_c}=Lo(),ud=oc().version,hd=new Map(Object.values(dc).map(n=>[n,1])),pc=Buffer.from(`SSH-2.0-ssh2js${ud}`),ld=Buffer.from(`${pc}\r
`),dd=8192,Ad=1024,hc=Buffer.from([ye.GLOBAL_REQUEST,0,0,0,21,107,101,101,112,97,108,105,118,101,64,111,112,101,110,115,115,104,46,99,111,109,1]),gd=Buffer.from([Fo.TTY_OP_END]);function Ho(){}var Mo=class{constructor(t){let e=t.onWrite;if(typeof e!="function")throw new Error("Missing onWrite function");this._onWrite=_=>{e(_)};let r=t.onError;if(typeof r!="function")throw new Error("Missing onError function");this._onError=_=>{r(_)};let i=t.debug;this._debug=typeof i=="function"?_=>{i(_)}:void 0;let s=t.onHeader;this._onHeader=typeof s=="function"?(..._)=>{s(..._)}:Ho;let o=t.onPacket;this._onPacket=typeof o=="function"?()=>{o()}:Ho;let f=t.onHandshakeComplete;typeof f!="function"&&(f=Ho);let a;this._onHandshakeComplete=(..._)=>{this._debug&&this._debug("Handshake completed"),a===void 0?a=!0:a=!1;let x=this._queue;if(x){this._queue=void 0,this._debug&&this._debug(`Draining outbound queue (${x.length}) ...`);for(let b=0;b<x.length;++b){let w=x[b],C=this._packetRW.write.finalize(w);if(C===w){let v=this._cipher.allocPacket(w.length);v.set(w,5),C=v}Se(this,C)}this._debug&&this._debug("... finished draining outbound queue")}a&&this._server&&this._kex.remoteExtInfoEnabled&&yd(this),f(..._)},this._queue=void 0;let u=t.messageHandlers;typeof u=="object"&&u!==null?this._handlers=u:this._handlers={},this._onPayload=bd.bind(this),this._server=!!t.server,this._banner=void 0;let h;if(this._server){if(typeof t.hostKeys!="object"||t.hostKeys===null)throw new Error("Missing server host key(s)");this._hostKeys=t.hostKeys,typeof t.greeting=="string"&&t.greeting.length&&(h=t.greeting.slice(-2)===`\r
`?t.greeting:`${t.greeting}\r
`),typeof t.banner=="string"&&t.banner.length&&(this._banner=t.banner.slice(-2)===`\r
`?t.banner:`${t.banner}\r
`)}else this._hostKeys=void 0;let l=t.offer;typeof l!="object"||l===null?l=this._server?id:rd:l.constructor!==ac&&(this._server?l.kex=l.kex.concat(["kex-strict-s-v00@openssh.com"]):l.kex=l.kex.concat(["ext-info-c","kex-strict-c-v00@openssh.com"]),l=new ac(l)),this._kex=void 0,this._strictMode=void 0,this._kexinit=void 0,this._offer=l,this._cipher=new Zl(0,this._onWrite),this._decipher=void 0,this._skipNextInboundPacket=!1,this._packetRW={read:new ad,write:new cd(this)},this._hostVerifier=!this._server&&typeof t.hostVerifier=="function"?t.hostVerifier:void 0,this._parse=_d,this._buffer=void 0,this._authsQueue=[],this._authenticated=!1,this._remoteIdentRaw=void 0;let A;if(typeof t.ident=="string")this._identRaw=Buffer.from(`SSH-2.0-${t.ident}`),A=Buffer.allocUnsafe(this._identRaw.length+2),A.set(this._identRaw,0),A[A.length-2]=13,A[A.length-1]=10;else if(Buffer.isBuffer(t.ident)){let _=Buffer.allocUnsafe(8+t.ident.length);_.latin1Write("SSH-2.0-",0,8),_.set(t.ident,8),this._identRaw=_,A=Buffer.allocUnsafe(_.length+2),A.set(_,0),A[A.length-2]=13,A[A.length-1]=10}else this._identRaw=pc,A=ld;this._compatFlags=0,this._debug&&(Jl?this._debug("Custom crypto binding available"):this._debug("Custom crypto binding not available")),this._debug&&this._debug(`Local ident: ${lc(this._identRaw.toString())}`),this.start=()=>{this.start=void 0,h&&this._onWrite(h),this._onWrite(A)}}_destruct(t){this._packetRW.read.cleanup(),this._packetRW.write.cleanup(),this._cipher&&this._cipher.free(),this._decipher&&this._decipher.free(),(typeof t!="string"||t.length===0)&&(t="fatal error"),this.parse=()=>{throw new Error(`Instance unusable after ${t}`)},this._onWrite=()=>{throw new Error(`Instance unusable after ${t}`)},this._destruct=void 0}cleanup(){this._destruct&&this._destruct()}parse(t,e,r){for(;e<r;)e=this._parse(t,e,r)}disconnect(t){let r=this._packetRW.write.allocStartKEX,i=this._packetRW.write.alloc(13,!0),s=r+13;hd.has(t)||(t=dc.PROTOCOL_ERROR),i[r]=ye.DISCONNECT,m(i,t,++r),i.fill(0,r+=4,s),this._debug&&this._debug(`Outbound: Sending DISCONNECT (${t})`),Se(this,this._packetRW.write.finalize(i,!0),!0)}ping(){let t=this._packetRW.write.allocStart,e=this._packetRW.write.alloc(hc.length);e.set(hc,t),this._debug&&this._debug("Outbound: Sending ping (GLOBAL_REQUEST: keepalive@openssh.com)"),Se(this,this._packetRW.write.finalize(e))}rekey(){this._kexinit===void 0?(this._debug&&this._debug("Outbound: Initiated explicit rekey"),this._queue=[],Ac(this)):this._debug&&this._debug("Outbound: Ignoring rekey during handshake")}requestSuccess(t){let e=this._packetRW.write.allocStart,r;Buffer.isBuffer(t)?(r=this._packetRW.write.alloc(1+t.length),r[e]=ye.REQUEST_SUCCESS,r.set(t,++e)):(r=this._packetRW.write.alloc(1),r[e]=ye.REQUEST_SUCCESS),this._debug&&this._debug("Outbound: Sending REQUEST_SUCCESS"),Se(this,this._packetRW.write.finalize(r))}requestFailure(){let t=this._packetRW.write.allocStart,e=this._packetRW.write.alloc(1);e[t]=ye.REQUEST_FAILURE,this._debug&&this._debug("Outbound: Sending REQUEST_FAILURE"),Se(this,this._packetRW.write.finalize(e))}channelSuccess(t){let e=this._packetRW.write.allocStart,r=this._packetRW.write.alloc(1+4);r[e]=ye.CHANNEL_SUCCESS,m(r,t,++e),this._debug&&this._debug(`Outbound: Sending CHANNEL_SUCCESS (r:${t})`),Se(this,this._packetRW.write.finalize(r))}channelFailure(t){let e=this._packetRW.write.allocStart,r=this._packetRW.write.alloc(1+4);r[e]=ye.CHANNEL_FAILURE,m(r,t,++e),this._debug&&this._debug(`Outbound: Sending CHANNEL_FAILURE (r:${t})`),Se(this,this._packetRW.write.finalize(r))}channelEOF(t){let e=this._packetRW.write.allocStart,r=this._packetRW.write.alloc(1+4);r[e]=ye.CHANNEL_EOF,m(r,t,++e),this._debug&&this._debug(`Outbound: Sending CHANNEL_EOF (r:${t})`),Se(this,this._packetRW.write.finalize(r))}channelClose(t){let e=this._packetRW.write.allocStart,r=this._packetRW.write.alloc(1+4);r[e]=ye.CHANNEL_CLOSE,m(r,t,++e),this._debug&&this._debug(`Outbound: Sending CHANNEL_CLOSE (r:${t})`),Se(this,this._packetRW.write.finalize(r))}channelWindowAdjust(t,e){let r=this._packetRW.write.allocStart,i=this._packetRW.write.alloc(1+4+4);i[r]=ye.CHANNEL_WINDOW_ADJUST,m(i,t,++r),m(i,e,r+=4),this._debug&&this._debug(`Outbound: Sending CHANNEL_WINDOW_ADJUST (r:${t}, ${e})`),Se(this,this._packetRW.write.finalize(i))}channelData(t,e){let r=Buffer.isBuffer(e),i=r?e.length:Buffer.byteLength(e),s=this._packetRW.write.allocStart,o=this._packetRW.write.alloc(1+4+4+i);o[s]=ye.CHANNEL_DATA,m(o,t,++s),m(o,i,s+=4),r?o.set(e,s+=4):o.utf8Write(e,s+=4,i),this._debug&&this._debug(`Outbound: Sending CHANNEL_DATA (r:${t}, ${i})`),Se(this,this._packetRW.write.finalize(o))}channelExtData(t,e,r){let i=Buffer.isBuffer(e),s=i?e.length:Buffer.byteLength(e),o=this._packetRW.write.allocStart,f=this._packetRW.write.alloc(1+4+4+4+s);f[o]=ye.CHANNEL_EXTENDED_DATA,m(f,t,++o),m(f,r,o+=4),m(f,s,o+=4),i?f.set(e,o+=4):f.utf8Write(e,o+=4,s),this._debug&&this._debug(`Outbound: Sending CHANNEL_EXTENDED_DATA (r:${t})`),Se(this,this._packetRW.write.finalize(f))}channelOpenConfirm(t,e,r,i){let s=this._packetRW.write.allocStart,o=this._packetRW.write.alloc(1+4+4+4+4);o[s]=ye.CHANNEL_OPEN_CONFIRMATION,m(o,t,++s),m(o,e,s+=4),m(o,r,s+=4),m(o,i,s+=4),this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN_CONFIRMATION (r:${t}, l:${e})`),Se(this,this._packetRW.write.finalize(o))}channelOpenFail(t,e,r){typeof r!="string"&&(r="");let i=Buffer.byteLength(r),s=this._packetRW.write.allocStart,o=this._packetRW.write.alloc(1+4+4+4+i+4);o[s]=ye.CHANNEL_OPEN_FAILURE,m(o,t,++s),m(o,e,s+=4),m(o,i,s+=4),s+=4,i&&(o.utf8Write(r,s,i),s+=i),m(o,0,s),this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN_FAILURE (r:${t})`),Se(this,this._packetRW.write.finalize(o))}service(t){if(this._server)throw new Error("Client-only method called in server mode");let e=Buffer.byteLength(t),r=this._packetRW.write.allocStart,i=this._packetRW.write.alloc(1+4+e);i[r]=ye.SERVICE_REQUEST,m(i,e,++r),i.utf8Write(t,r+=4,e),this._debug&&this._debug(`Outbound: Sending SERVICE_REQUEST (${t})`),Se(this,this._packetRW.write.finalize(i))}authPassword(t,e,r){if(this._server)throw new Error("Client-only method called in server mode");let i=Buffer.byteLength(t),s=Buffer.byteLength(e),o=r?Buffer.byteLength(r):0,f=this._packetRW.write.allocStart,a=this._packetRW.write.alloc(1+4+i+4+14+4+8+1+4+s+(r?4+o:0));a[f]=ye.USERAUTH_REQUEST,m(a,i,++f),a.utf8Write(t,f+=4,i),m(a,14,f+=i),a.utf8Write("ssh-connection",f+=4,14),m(a,8,f+=14),a.utf8Write("password",f+=4,8),a[f+=8]=r?1:0,m(a,s,++f),Buffer.isBuffer(e)?Zi(e,a,0,s,f+=4):a.utf8Write(e,f+=4,s),r?(m(a,o,f+=s),Buffer.isBuffer(r)?Zi(r,a,0,o,f+=4):a.utf8Write(r,f+=4,o),this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (changed password)")):this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (password)"),this._authsQueue.push("password"),Se(this,this._packetRW.write.finalize(a))}authPK(t,e,r,i){if(this._server)throw new Error("Client-only method called in server mode");if(e=cc(e),e instanceof Error)throw new Error("Invalid key");let s=e.type;e=e.getPublicSSH(),typeof r=="function"&&(i=r,r=void 0),r||(r=s);let o=Buffer.byteLength(t),f=Buffer.byteLength(r),a=e.length,u=this._kex.sessionID,h=u.length,l=(i?4+h:0)+1+4+o+4+14+4+9+1+4+f+4+a,A,_;if(i?(A=Buffer.allocUnsafe(l),_=0,m(A,h,_),A.set(u,_+=4),_+=h):(A=this._packetRW.write.alloc(l),_=this._packetRW.write.allocStart),A[_]=ye.USERAUTH_REQUEST,m(A,o,++_),A.utf8Write(t,_+=4,o),m(A,14,_+=o),A.utf8Write("ssh-connection",_+=4,14),m(A,9,_+=14),A.utf8Write("publickey",_+=4,9),A[_+=9]=i?1:0,m(A,f,++_),A.utf8Write(r,_+=4,f),m(A,a,_+=f),A.set(e,_+=4),!i){this._authsQueue.push("publickey"),this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (publickey -- check)"),Se(this,this._packetRW.write.finalize(A));return}i(A,x=>{if(x=uc(x,s),x===!1)throw new Error("Error while converting handshake signature");let b=x.length;_=this._packetRW.write.allocStart,A=this._packetRW.write.alloc(1+4+o+4+14+4+9+1+4+f+4+a+4+4+f+4+b),A[_]=ye.USERAUTH_REQUEST,m(A,o,++_),A.utf8Write(t,_+=4,o),m(A,14,_+=o),A.utf8Write("ssh-connection",_+=4,14),m(A,9,_+=14),A.utf8Write("publickey",_+=4,9),A[_+=9]=1,m(A,f,++_),A.utf8Write(r,_+=4,f),m(A,a,_+=f),A.set(e,_+=4),m(A,4+f+4+b,_+=a),m(A,f,_+=4),A.utf8Write(r,_+=4,f),m(A,b,_+=f),A.set(x,_+=4),this._authsQueue.push("publickey"),this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (publickey)"),Se(this,this._packetRW.write.finalize(A))})}authHostbased(t,e,r,i,s,o){if(this._server)throw new Error("Client-only method called in server mode");if(e=cc(e),e instanceof Error)throw new Error("Invalid key");let f=e.type;e=e.getPublicSSH(),typeof s=="function"&&(o=s,s=void 0),s||(s=f);let a=Buffer.byteLength(t),u=Buffer.byteLength(s),h=e.length,l=this._kex.sessionID,A=l.length,_=Buffer.byteLength(r),x=Buffer.byteLength(i),b=Buffer.allocUnsafe(4+A+1+4+a+4+14+4+9+4+u+4+h+4+_+4+x),w=0;m(b,A,w),b.set(l,w+=4),b[w+=A]=ye.USERAUTH_REQUEST,m(b,a,++w),b.utf8Write(t,w+=4,a),m(b,14,w+=a),b.utf8Write("ssh-connection",w+=4,14),m(b,9,w+=14),b.utf8Write("hostbased",w+=4,9),m(b,u,w+=9),b.utf8Write(s,w+=4,u),m(b,h,w+=u),b.set(e,w+=4),m(b,_,w+=h),b.utf8Write(r,w+=4,_),m(b,x,w+=_),b.utf8Write(i,w+=4,x),o(b,C=>{if(C=uc(C,f),!C)throw new Error("Error while converting handshake signature");let v=C.length,X=b.length-A-4;w=this._packetRW.write.allocStart;let L=this._packetRW.write.alloc(X+4+4+u+4+v);Zi(b,L,4+A,b.length,w),m(L,4+u+4+v,w+=X),m(L,u,w+=4),L.utf8Write(s,w+=4,u),m(L,v,w+=u),L.set(C,w+=4),this._authsQueue.push("hostbased"),this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (hostbased)"),Se(this,this._packetRW.write.finalize(L))})}authKeyboard(t){if(this._server)throw new Error("Client-only method called in server mode");let e=Buffer.byteLength(t),r=this._packetRW.write.allocStart,i=this._packetRW.write.alloc(1+4+e+4+14+4+20+4+4);i[r]=ye.USERAUTH_REQUEST,m(i,e,++r),i.utf8Write(t,r+=4,e),m(i,14,r+=e),i.utf8Write("ssh-connection",r+=4,14),m(i,20,r+=14),i.utf8Write("keyboard-interactive",r+=4,20),m(i,0,r+=20),m(i,0,r+=4),this._authsQueue.push("keyboard-interactive"),this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (keyboard-interactive)"),Se(this,this._packetRW.write.finalize(i))}authNone(t){if(this._server)throw new Error("Client-only method called in server mode");let e=Buffer.byteLength(t),r=this._packetRW.write.allocStart,i=this._packetRW.write.alloc(1+4+e+4+14+4+4);i[r]=ye.USERAUTH_REQUEST,m(i,e,++r),i.utf8Write(t,r+=4,e),m(i,14,r+=e),i.utf8Write("ssh-connection",r+=4,14),m(i,4,r+=14),i.utf8Write("none",r+=4,4),this._authsQueue.push("none"),this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (none)"),Se(this,this._packetRW.write.finalize(i))}authInfoRes(t){if(this._server)throw new Error("Client-only method called in server mode");let e=0,r;if(t){r=new Array(t.length);for(let o=0;o<t.length;++o){let f=Buffer.byteLength(t[o]);r[o]=f,e+=4+f}}let i=this._packetRW.write.allocStart,s=this._packetRW.write.alloc(1+4+e);if(s[i]=ye.USERAUTH_INFO_RESPONSE,t){m(s,t.length,++i),i+=4;for(let o=0;o<t.length;++o){let f=r[o];m(s,f,i),i+=4,f&&(s.utf8Write(t[o],i,f),i+=f)}}else m(s,0,++i);this._debug&&this._debug("Outbound: Sending USERAUTH_INFO_RESPONSE"),Se(this,this._packetRW.write.finalize(s))}tcpipForward(t,e,r){if(this._server)throw new Error("Client-only method called in server mode");let i=Buffer.byteLength(t),s=this._packetRW.write.allocStart,o=this._packetRW.write.alloc(1+4+13+1+4+i+4);o[s]=ye.GLOBAL_REQUEST,m(o,13,++s),o.utf8Write("tcpip-forward",s+=4,13),o[s+=13]=r===void 0||r===!0?1:0,m(o,i,++s),o.utf8Write(t,s+=4,i),m(o,e,s+=i),this._debug&&this._debug("Outbound: Sending GLOBAL_REQUEST (tcpip-forward)"),Se(this,this._packetRW.write.finalize(o))}cancelTcpipForward(t,e,r){if(this._server)throw new Error("Client-only method called in server mode");let i=Buffer.byteLength(t),s=this._packetRW.write.allocStart,o=this._packetRW.write.alloc(1+4+20+1+4+i+4);o[s]=ye.GLOBAL_REQUEST,m(o,20,++s),o.utf8Write("cancel-tcpip-forward",s+=4,20),o[s+=20]=r===void 0||r===!0?1:0,m(o,i,++s),o.utf8Write(t,s+=4,i),m(o,e,s+=i),this._debug&&this._debug("Outbound: Sending GLOBAL_REQUEST (cancel-tcpip-forward)"),Se(this,this._packetRW.write.finalize(o))}openssh_streamLocalForward(t,e){if(this._server)throw new Error("Client-only method called in server mode");let r=Buffer.byteLength(t),i=this._packetRW.write.allocStart,s=this._packetRW.write.alloc(1+4+31+1+4+r);s[i]=ye.GLOBAL_REQUEST,m(s,31,++i),s.utf8Write("streamlocal-forward@openssh.com",i+=4,31),s[i+=31]=e===void 0||e===!0?1:0,m(s,r,++i),s.utf8Write(t,i+=4,r),this._debug&&this._debug("Outbound: Sending GLOBAL_REQUEST (streamlocal-forward@openssh.com)"),Se(this,this._packetRW.write.finalize(s))}openssh_cancelStreamLocalForward(t,e){if(this._server)throw new Error("Client-only method called in server mode");let r=Buffer.byteLength(t),i=this._packetRW.write.allocStart,s=this._packetRW.write.alloc(1+4+38+1+4+r);s[i]=ye.GLOBAL_REQUEST,m(s,38,++i),s.utf8Write("cancel-streamlocal-forward@openssh.com",i+=4,38),s[i+=38]=e===void 0||e===!0?1:0,m(s,r,++i),s.utf8Write(t,i+=4,r),this._debug&&this._debug("Outbound: Sending GLOBAL_REQUEST (cancel-streamlocal-forward@openssh.com)"),Se(this,this._packetRW.write.finalize(s))}directTcpip(t,e,r,i){if(this._server)throw new Error("Client-only method called in server mode");let s=Buffer.byteLength(i.srcIP),o=Buffer.byteLength(i.dstIP),f=this._packetRW.write.allocStart,a=this._packetRW.write.alloc(1+4+12+4+4+4+4+s+4+4+o+4);a[f]=ye.CHANNEL_OPEN,m(a,12,++f),a.utf8Write("direct-tcpip",f+=4,12),m(a,t,f+=12),m(a,e,f+=4),m(a,r,f+=4),m(a,o,f+=4),a.utf8Write(i.dstIP,f+=4,o),m(a,i.dstPort,f+=o),m(a,s,f+=4),a.utf8Write(i.srcIP,f+=4,s),m(a,i.srcPort,f+=s),this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${t}, direct-tcpip)`),Se(this,this._packetRW.write.finalize(a))}openssh_directStreamLocal(t,e,r,i){if(this._server)throw new Error("Client-only method called in server mode");let s=Buffer.byteLength(i.socketPath),o=this._packetRW.write.allocStart,f=this._packetRW.write.alloc(1+4+30+4+4+4+4+s+4+4);f[o]=ye.CHANNEL_OPEN,m(f,30,++o),f.utf8Write("direct-streamlocal@openssh.com",o+=4,30),m(f,t,o+=30),m(f,e,o+=4),m(f,r,o+=4),m(f,s,o+=4),f.utf8Write(i.socketPath,o+=4,s),fd(f,0,o+=s,o+8),this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${t}, direct-streamlocal@openssh.com)`),Se(this,this._packetRW.write.finalize(f))}openssh_noMoreSessions(t){if(this._server)throw new Error("Client-only method called in server mode");let e=this._packetRW.write.allocStart,r=this._packetRW.write.alloc(1+4+28+1);r[e]=ye.GLOBAL_REQUEST,m(r,28,++e),r.utf8Write("no-more-sessions@openssh.com",e+=4,28),r[e+=28]=t===void 0||t===!0?1:0,this._debug&&this._debug("Outbound: Sending GLOBAL_REQUEST (no-more-sessions@openssh.com)"),Se(this,this._packetRW.write.finalize(r))}session(t,e,r){if(this._server)throw new Error("Client-only method called in server mode");let i=this._packetRW.write.allocStart,s=this._packetRW.write.alloc(1+4+7+4+4+4);s[i]=ye.CHANNEL_OPEN,m(s,7,++i),s.utf8Write("session",i+=4,7),m(s,t,i+=7),m(s,e,i+=4),m(s,r,i+=4),this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${t}, session)`),Se(this,this._packetRW.write.finalize(s))}windowChange(t,e,r,i,s){if(this._server)throw new Error("Client-only method called in server mode");let o=this._packetRW.write.allocStart,f=this._packetRW.write.alloc(1+4+4+13+1+4+4+4+4);f[o]=ye.CHANNEL_REQUEST,m(f,t,++o),m(f,13,o+=4),f.utf8Write("window-change",o+=4,13),f[o+=13]=0,m(f,r,++o),m(f,e,o+=4),m(f,s,o+=4),m(f,i,o+=4),this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${t}, window-change)`),Se(this,this._packetRW.write.finalize(f))}pty(t,e,r,i,s,o,f,a){if(this._server)throw new Error("Client-only method called in server mode");(!o||!o.length)&&(o="vt100"),f&&!Buffer.isBuffer(f)&&!Array.isArray(f)&&typeof f=="object"&&f!==null&&(f=xd(f)),(!f||!f.length)&&(f=gd);let u=o.length,h=f.length,l=this._packetRW.write.allocStart,A=this._packetRW.write.alloc(1+4+4+7+1+4+u+4+4+4+4+4+h);if(A[l]=ye.CHANNEL_REQUEST,m(A,t,++l),m(A,7,l+=4),A.utf8Write("pty-req",l+=4,7),A[l+=7]=a===void 0||a===!0?1:0,m(A,u,++l),A.utf8Write(o,l+=4,u),m(A,r,l+=u),m(A,e,l+=4),m(A,s,l+=4),m(A,i,l+=4),m(A,h,l+=4),l+=4,Array.isArray(f))for(let _=0;_<h;++_)A[l++]=f[_];else Buffer.isBuffer(f)&&A.set(f,l);this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${t}, pty-req)`),Se(this,this._packetRW.write.finalize(A))}shell(t,e){if(this._server)throw new Error("Client-only method called in server mode");let r=this._packetRW.write.allocStart,i=this._packetRW.write.alloc(1+4+4+5+1);i[r]=ye.CHANNEL_REQUEST,m(i,t,++r),m(i,5,r+=4),i.utf8Write("shell",r+=4,5),i[r+=5]=e===void 0||e===!0?1:0,this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${t}, shell)`),Se(this,this._packetRW.write.finalize(i))}exec(t,e,r){if(this._server)throw new Error("Client-only method called in server mode");let i=Buffer.isBuffer(e),s=i?e.length:Buffer.byteLength(e),o=this._packetRW.write.allocStart,f=this._packetRW.write.alloc(1+4+4+4+1+4+s);f[o]=ye.CHANNEL_REQUEST,m(f,t,++o),m(f,4,o+=4),f.utf8Write("exec",o+=4,4),f[o+=4]=r===void 0||r===!0?1:0,m(f,s,++o),i?f.set(e,o+=4):f.utf8Write(e,o+=4,s),this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${t}, exec: ${e})`),Se(this,this._packetRW.write.finalize(f))}signal(t,e){if(this._server)throw new Error("Client-only method called in server mode");let r=e;if(e=e.toUpperCase(),e.slice(0,3)==="SIG"&&(e=e.slice(3)),fc[e]!==1)throw new Error(`Invalid signal: ${r}`);let i=e.length,s=this._packetRW.write.allocStart,o=this._packetRW.write.alloc(1+4+4+6+1+4+i);o[s]=ye.CHANNEL_REQUEST,m(o,t,++s),m(o,6,s+=4),o.utf8Write("signal",s+=4,6),o[s+=6]=0,m(o,i,++s),o.utf8Write(e,s+=4,i),this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${t}, signal: ${e})`),Se(this,this._packetRW.write.finalize(o))}env(t,e,r,i){if(this._server)throw new Error("Client-only method called in server mode");let s=Buffer.byteLength(e),o=Buffer.isBuffer(r),f=o?r.length:Buffer.byteLength(r),a=this._packetRW.write.allocStart,u=this._packetRW.write.alloc(1+4+4+3+1+4+s+4+f);u[a]=ye.CHANNEL_REQUEST,m(u,t,++a),m(u,3,a+=4),u.utf8Write("env",a+=4,3),u[a+=3]=i===void 0||i===!0?1:0,m(u,s,++a),u.utf8Write(e,a+=4,s),m(u,f,a+=s),o?u.set(r,a+=4):u.utf8Write(r,a+=4,f),this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${t}, env: ${e}=${r})`),Se(this,this._packetRW.write.finalize(u))}x11Forward(t,e,r){if(this._server)throw new Error("Client-only method called in server mode");let i=e.protocol,s=e.cookie,o=Buffer.isBuffer(i),f=o?i.length:Buffer.byteLength(i),a=Buffer.isBuffer(s),u=a?s.length:Buffer.byteLength(s),h=this._packetRW.write.allocStart,l=this._packetRW.write.alloc(1+4+4+7+1+1+4+f+4+u+4);l[h]=ye.CHANNEL_REQUEST,m(l,t,++h),m(l,7,h+=4),l.utf8Write("x11-req",h+=4,7),l[h+=7]=r===void 0||r===!0?1:0,l[++h]=e.single?1:0,m(l,f,++h),o?l.set(i,h+=4):l.utf8Write(i,h+=4,f),m(l,u,h+=f),a?l.set(s,h+=4):l.latin1Write(s,h+=4,u),m(l,e.screen||0,h+=u),this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${t}, x11-req)`),Se(this,this._packetRW.write.finalize(l))}subsystem(t,e,r){if(this._server)throw new Error("Client-only method called in server mode");let i=Buffer.byteLength(e),s=this._packetRW.write.allocStart,o=this._packetRW.write.alloc(1+4+4+9+1+4+i);o[s]=ye.CHANNEL_REQUEST,m(o,t,++s),m(o,9,s+=4),o.utf8Write("subsystem",s+=4,9),o[s+=9]=r===void 0||r===!0?1:0,m(o,i,++s),o.utf8Write(e,s+=4,i),this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${t}, subsystem: ${e})`),Se(this,this._packetRW.write.finalize(o))}openssh_agentForward(t,e){if(this._server)throw new Error("Client-only method called in server mode");let r=this._packetRW.write.allocStart,i=this._packetRW.write.alloc(1+4+4+26+1);i[r]=ye.CHANNEL_REQUEST,m(i,t,++r),m(i,26,r+=4),i.utf8Write("auth-agent-req@openssh.com",r+=4,26),i[r+=26]=e===void 0||e===!0?1:0,this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${t}, auth-agent-req@openssh.com)`),Se(this,this._packetRW.write.finalize(i))}openssh_hostKeysProve(t){if(this._server)throw new Error("Client-only method called in server mode");let e=0,r=[];for(let o of t){let f=o.getPublicSSH();e+=4+f.length,r.push(f)}let i=this._packetRW.write.allocStart,s=this._packetRW.write.alloc(1+4+29+1+e);s[i]=ye.GLOBAL_REQUEST,m(s,29,++i),s.utf8Write("hostkeys-prove-00@openssh.com",i+=4,29),s[i+=29]=1,++i;for(let o of r)m(s,o.length,i),Zi(o,s,0,o.length,i+=4),i+=o.length;this._debug&&this._debug("Outbound: Sending GLOBAL_REQUEST (hostkeys-prove-00@openssh.com)"),Se(this,this._packetRW.write.finalize(s))}serviceAccept(t){if(!this._server)throw new Error("Server-only method called in client mode");let e=Buffer.byteLength(t),r=this._packetRW.write.allocStart,i=this._packetRW.write.alloc(1+4+e);if(i[r]=ye.SERVICE_ACCEPT,m(i,e,++r),i.utf8Write(t,r+=4,e),this._debug&&this._debug(`Outbound: Sending SERVICE_ACCEPT (${t})`),Se(this,this._packetRW.write.finalize(i)),this._server&&this._banner&&t==="ssh-userauth"){let s=this._banner;this._banner=void 0;let o=Buffer.byteLength(s);r=this._packetRW.write.allocStart;let f=this._packetRW.write.alloc(1+4+o+4);f[r]=ye.USERAUTH_BANNER,m(f,o,++r),f.utf8Write(s,r+=4,o),m(f,0,r+=o),this._debug&&this._debug("Outbound: Sending USERAUTH_BANNER"),Se(this,this._packetRW.write.finalize(f))}}forwardedTcpip(t,e,r,i){if(!this._server)throw new Error("Server-only method called in client mode");let s=Buffer.byteLength(i.boundAddr),o=Buffer.byteLength(i.remoteAddr),f=this._packetRW.write.allocStart,a=this._packetRW.write.alloc(1+4+15+4+4+4+4+s+4+4+o+4);a[f]=ye.CHANNEL_OPEN,m(a,15,++f),a.utf8Write("forwarded-tcpip",f+=4,15),m(a,t,f+=15),m(a,e,f+=4),m(a,r,f+=4),m(a,s,f+=4),a.utf8Write(i.boundAddr,f+=4,s),m(a,i.boundPort,f+=s),m(a,o,f+=4),a.utf8Write(i.remoteAddr,f+=4,o),m(a,i.remotePort,f+=o),this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${t}, forwarded-tcpip)`),Se(this,this._packetRW.write.finalize(a))}x11(t,e,r,i){if(!this._server)throw new Error("Server-only method called in client mode");let s=Buffer.byteLength(i.originAddr),o=this._packetRW.write.allocStart,f=this._packetRW.write.alloc(1+4+3+4+4+4+4+s+4);f[o]=ye.CHANNEL_OPEN,m(f,3,++o),f.utf8Write("x11",o+=4,3),m(f,t,o+=3),m(f,e,o+=4),m(f,r,o+=4),m(f,s,o+=4),f.utf8Write(i.originAddr,o+=4,s),m(f,i.originPort,o+=s),this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${t}, x11)`),Se(this,this._packetRW.write.finalize(f))}openssh_authAgent(t,e,r){if(!this._server)throw new Error("Server-only method called in client mode");let i=this._packetRW.write.allocStart,s=this._packetRW.write.alloc(1+4+22+4+4+4);s[i]=ye.CHANNEL_OPEN,m(s,22,++i),s.utf8Write("auth-agent@openssh.com",i+=4,22),m(s,t,i+=22),m(s,e,i+=4),m(s,r,i+=4),this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${t}, auth-agent@openssh.com)`),Se(this,this._packetRW.write.finalize(s))}openssh_forwardedStreamLocal(t,e,r,i){if(!this._server)throw new Error("Server-only method called in client mode");let s=Buffer.byteLength(i.socketPath),o=this._packetRW.write.allocStart,f=this._packetRW.write.alloc(1+4+33+4+4+4+4+s+4);f[o]=ye.CHANNEL_OPEN,m(f,33,++o),f.utf8Write("forwarded-streamlocal@openssh.com",o+=4,33),m(f,t,o+=33),m(f,e,o+=4),m(f,r,o+=4),m(f,s,o+=4),f.utf8Write(i.socketPath,o+=4,s),m(f,0,o+=s),this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${t}, forwarded-streamlocal@openssh.com)`),Se(this,this._packetRW.write.finalize(f))}exitStatus(t,e){if(!this._server)throw new Error("Server-only method called in client mode");let r=this._packetRW.write.allocStart,i=this._packetRW.write.alloc(1+4+4+11+1+4);i[r]=ye.CHANNEL_REQUEST,m(i,t,++r),m(i,11,r+=4),i.utf8Write("exit-status",r+=4,11),i[r+=11]=0,m(i,e,++r),this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${t}, exit-status: ${e})`),Se(this,this._packetRW.write.finalize(i))}exitSignal(t,e,r,i){if(!this._server)throw new Error("Server-only method called in client mode");let s=e;if(typeof s!="string"||!s)throw new Error(`Invalid signal: ${s}`);let o=e.toUpperCase();if(o.slice(0,3)==="SIG"&&(o=o.slice(3)),fc[o]!==1)throw new Error(`Invalid signal: ${s}`);let f=Buffer.byteLength(o),a=i?Buffer.byteLength(i):0,u=this._packetRW.write.allocStart,h=this._packetRW.write.alloc(1+4+4+11+1+4+f+1+4+a+4);h[u]=ye.CHANNEL_REQUEST,m(h,t,++u),m(h,11,u+=4),h.utf8Write("exit-signal",u+=4,11),h[u+=11]=0,m(h,f,++u),h.utf8Write(o,u+=4,f),h[u+=f]=r?1:0,m(h,a,++u),u+=4,a&&(h.utf8Write(i,u,a),u+=a),m(h,0,u),this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${t}, exit-signal: ${e})`),Se(this,this._packetRW.write.finalize(h))}authFailure(t,e){if(!this._server)throw new Error("Server-only method called in client mode");if(this._authsQueue.length===0)throw new Error("No auth in progress");let r;if(typeof t=="boolean"&&(e=t,t=void 0),t){r=[];for(let f=0;f<t.length;++f)t[f].toLowerCase()!=="none"&&r.push(t[f]);r=r.join(",")}else r="";let i=r.length,s=this._packetRW.write.allocStart,o=this._packetRW.write.alloc(1+4+i+1);o[s]=ye.USERAUTH_FAILURE,m(o,i,++s),o.utf8Write(r,s+=4,i),o[s+=i]=e===!0?1:0,this._authsQueue.shift(),this._debug&&this._debug("Outbound: Sending USERAUTH_FAILURE"),Se(this,this._packetRW.write.finalize(o))}authSuccess(){if(!this._server)throw new Error("Server-only method called in client mode");if(this._authsQueue.length===0)throw new Error("No auth in progress");let t=this._packetRW.write.allocStart,e=this._packetRW.write.alloc(1);e[t]=ye.USERAUTH_SUCCESS,this._authsQueue.shift(),this._authenticated=!0,this._debug&&this._debug("Outbound: Sending USERAUTH_SUCCESS"),Se(this,this._packetRW.write.finalize(e)),this._kex.negotiated.cs.compress==="zlib@openssh.com"&&(this._packetRW.read=new Ec),this._kex.negotiated.sc.compress==="zlib@openssh.com"&&(this._packetRW.write=new _c(this))}authPKOK(t,e){if(!this._server)throw new Error("Server-only method called in client mode");if(this._authsQueue.length===0||this._authsQueue[0]!=="publickey")throw new Error('"publickey" auth not in progress');let r=Buffer.byteLength(t),i=e.length,s=this._packetRW.write.allocStart,o=this._packetRW.write.alloc(1+4+r+4+i);o[s]=ye.USERAUTH_PK_OK,m(o,r,++s),o.utf8Write(t,s+=4,r),m(o,i,s+=r),o.set(e,s+=4),this._authsQueue.shift(),this._debug&&this._debug("Outbound: Sending USERAUTH_PK_OK"),Se(this,this._packetRW.write.finalize(o))}authPasswdChg(t){if(!this._server)throw new Error("Server-only method called in client mode");let e=Buffer.byteLength(t),r=this._packetRW.write.allocStart,i=this._packetRW.write.alloc(1+4+e+4);i[r]=ye.USERAUTH_PASSWD_CHANGEREQ,m(i,e,++r),i.utf8Write(t,r+=4,e),m(i,0,r+=e),this._debug&&this._debug("Outbound: Sending USERAUTH_PASSWD_CHANGEREQ"),Se(this,this._packetRW.write.finalize(i))}authInfoReq(t,e,r){if(!this._server)throw new Error("Server-only method called in client mode");let i=0,s=t?Buffer.byteLength(t):0,o=e?Buffer.byteLength(e):0;for(let u=0;u<r.length;++u)i+=4+Buffer.byteLength(r[u].prompt)+1;let f=this._packetRW.write.allocStart,a=this._packetRW.write.alloc(1+4+s+4+o+4+4+i);a[f]=ye.USERAUTH_INFO_REQUEST,m(a,s,++f),f+=4,t&&(a.utf8Write(t,f,s),f+=s),m(a,o,f),f+=4,e&&(a.utf8Write(e,f,o),f+=o),m(a,0,f),m(a,r.length,f+=4),f+=4;for(let u=0;u<r.length;++u){let h=r[u],l=Buffer.byteLength(h.prompt);m(a,l,f),f+=4,l&&(a.utf8Write(h.prompt,f,l),f+=l),a[f++]=h.echo?1:0}this._debug&&this._debug("Outbound: Sending USERAUTH_INFO_REQUEST"),Se(this,this._packetRW.write.finalize(a))}},Ed=/^SSH-(2\.0|1\.99)-([^ ]+)(?: (.*))?$/;function _d(n,t,e){let r,i;this._buffer?(r=Buffer.allocUnsafe(this._buffer.length+(e-t)),r.set(this._buffer,0),t===0?r.set(n,this._buffer.length):r.set(new Uint8Array(n.buffer,n.byteOffset+t,e-t),this._buffer.length),i=this._buffer.length,t=0):(r=n,i=0);let s=t,o=t,f=t,a=!1,u=0,h=0;for(;t<r.length;++t){let l=r[t];if(l===13){a=!0;continue}if(l===10){if(f>o&&f-o>4&&r[o]===83&&r[o+1]===83&&r[o+2]===72&&r[o+3]===45){let A=r.latin1Slice(s,f+1),_=o===s?A:A.slice(o-s),x=Ed.exec(_);if(!x)throw new Error("Invalid identification string");let b={greeting:o===s?"":A.slice(0,o-s),identRaw:_,versions:{protocol:x[1],software:x[2]},comments:x[3]};return this._remoteIdentRaw=Buffer.from(_),this._debug&&this._debug(`Remote ident: ${lc(_)}`),this._compatFlags=Id(b),this._buffer=void 0,this._decipher=new ed(0,sd.bind(this,{firstPacket:!0})),this._parse=pd,this._onHeader(b),this._destruct?(Ac(this),t+1-i):e}if(this._server)throw new Error("Greetings from clients not permitted");if(++h>Ad)throw new Error("Max greeting lines exceeded");a=!1,o=t+1,u=0}else{if(a)throw new Error("Invalid header: expected newline");if(++u>=dd)throw new Error("Header line too long")}f=t}return this._buffer||(this._buffer=gc(r,s)),t-i}function pd(n,t,e){return this._decipher.decrypt(n,t,e)}function bd(n){if(this._onPacket(),n.length===0){this._debug&&this._debug("Inbound: Skipping empty packet payload");return}n=this._packetRW.read.read(n);let t=n[0];t===ye.USERAUTH_SUCCESS&&!this._server&&!this._authenticated&&(this._authenticated=!0,this._kex.negotiated.cs.compress==="zlib@openssh.com"&&(this._packetRW.write=new _c(this)),this._kex.negotiated.sc.compress==="zlib@openssh.com"&&(this._packetRW.read=new Ec));let e=od[t];if(e===void 0){this._debug&&this._debug(`Inbound: Unsupported message type: ${t}`);return}return e(this,n)}function Id(n){let t=n.versions.software,e=0;for(let r of td)typeof r[0]=="string"?t===r[0]&&(e|=r[1]):r[0].test(t)&&(e|=r[1]);return e}function xd(n){let t=Object.keys(n),e=Buffer.allocUnsafe(5*t.length+1),r=0;for(let i=0;i<t.length;++i){let s=t[i];if(s==="TTY_OP_END")continue;let o=Fo[s];if(o===void 0)continue;let f=n[s];typeof f=="number"&&isFinite(f)&&(e[r++]=o,e[r++]=f>>>24,e[r++]=f>>>16,e[r++]=f>>>8,e[r++]=f)}return e[r++]=Fo.TTY_OP_END,r<e.length?gc(e,0,r):e}function yd(n){let t="ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521rsa-sha2-512,rsa-sha2-256,ssh-rsa,ssh-dss";nd&&(t=`ssh-ed25519,${t}`);let e=Buffer.byteLength(t),r=n._packetRW.write.allocStart,i=n._packetRW.write.alloc(1+4+4+15+4+e);i[r]=ye.EXT_INFO,m(i,1,++r),m(i,15,r+=4),i.utf8Write("server-sig-algs",r+=4,15),m(i,e,r+=15),i.utf8Write(t,r+=4,e),n._debug&&n._debug("Outbound: Sending EXT_INFO"),Se(n,n._packetRW.write.finalize(i))}bc.exports=Mo});var mc=ze(ni=>{"use strict";var es=require("assert"),{inspect:Sd}=require("util");function Ic(n){let t="",e=n.length,r=n[0]==="-"?1:0;for(;e>=r+4;e-=3)t=`_${n.slice(e-3,e)}${t}`;return`${n.slice(0,e)}${t}`}function xc(n,t){if(es(typeof t=="string","`thing` has to be of type string"),Array.isArray(n)){let e=n.length;return es(e>0,"At least one expected value needs to be specified"),n=n.map(r=>String(r)),e>2?`one of ${t} ${n.slice(0,e-1).join(", ")}, or `+n[e-1]:e===2?`one of ${t} ${n[0]} or ${n[1]}`:`of ${t} ${n[0]}`}return`of ${t} ${String(n)}`}ni.ERR_INTERNAL_ASSERTION=class Sc extends Error{constructor(t){super(),Error.captureStackTrace(this,Sc);let e=`This is caused by either a bug in ssh2 or incorrect usage of ssh2 internals.
Please open an issue with this stack trace at https://github.com/mscdex/ssh2/issues
`;this.message=t===void 0?e:`${t}
${e}`}};var wd=2**32,yc=(()=>{try{return new Function("return 2n ** 32n")()}catch{}})();ni.ERR_OUT_OF_RANGE=class wc extends RangeError{constructor(t,e,r,i){super(),Error.captureStackTrace(this,wc),es(e,'Missing "range" argument');let s=i?t:`The value of "${t}" is out of range.`,o;Number.isInteger(r)&&Math.abs(r)>wd?o=Ic(String(r)):typeof r=="bigint"?(o=String(r),(r>yc||r<-yc)&&(o=Ic(o)),o+="n"):o=Sd(r),s+=` It must be ${e}. Received ${o}`,this.message=s}};var br=class extends TypeError{constructor(t,e,r){super(),Error.captureStackTrace(this,br),es(typeof t=="string","'name' must be a string");let i;typeof e=="string"&&e.startsWith("not ")?(i="must not be",e=e.replace(/^not /,"")):i="must be";let s;if(t.endsWith(" argument"))s=`The ${t} ${i} ${xc(e,"type")}`;else{let o=t.includes(".")?"property":"argument";s=`The "${t}" ${o} ${i} ${xc(e,"type")}`}s+=`. Received type ${typeof r}`,this.message=s}};ni.ERR_INVALID_ARG_TYPE=br;ni.validateNumber=function(t,e){if(typeof t!="number")throw new br(e,"number",t)}});var ri=ze((ig,Qc)=>{"use strict";var md=require("events"),Un=require("fs"),{constants:Gt}=Un,{Readable:Tc,Writable:zo}=require("stream"),{inherits:vc,isDate:Go}=require("util"),Cd=Buffer[Symbol.species],{bufferCopy:On,bufferSlice:yr,makeBufferParser:Bd,writeUInt32BE:Q}=rn(),mn={SIZE:1,UIDGID:2,PERMISSIONS:4,ACMODTIME:8,EXTENDED:2147483648},ke=Buffer.alloc(28),et={OK:0,EOF:1,NO_SUCH_FILE:2,PERMISSION_DENIED:3,FAILURE:4,BAD_MESSAGE:5,NO_CONNECTION:6,CONNECTION_LOST:7,OP_UNSUPPORTED:8},Rd=new Map(Object.values(et).map(n=>[n,1])),kd={[et.OK]:"No error",[et.EOF]:"End of file",[et.NO_SUCH_FILE]:"No such file or directory",[et.PERMISSION_DENIED]:"Permission denied",[et.FAILURE]:"Failure",[et.BAD_MESSAGE]:"Bad message",[et.NO_CONNECTION]:"No connection",[et.CONNECTION_LOST]:"Connection lost",[et.OP_UNSUPPORTED]:"Operation unsupported"},Be={INIT:1,OPEN:3,CLOSE:4,READ:5,WRITE:6,LSTAT:7,FSTAT:8,SETSTAT:9,FSETSTAT:10,OPENDIR:11,READDIR:12,REMOVE:13,MKDIR:14,RMDIR:15,REALPATH:16,STAT:17,RENAME:18,READLINK:19,SYMLINK:20,EXTENDED:200},Yt={VERSION:2,STATUS:101,HANDLE:102,DATA:103,NAME:104,ATTRS:105,EXTENDED:201},we={READ:1,WRITE:2,APPEND:4,CREAT:8,TRUNC:16,EXCL:32},Cc=2*1024,ct=2**32-1,Nd=Buffer.from([0,0,0,5,Be.INIT,0,0,0,3]),Td=Buffer.from([0,0,0,5,Yt.VERSION,0,0,0,3]),vd=/^SSH-2.0-(?:OpenSSH|dropbear)/,Ko=256*1024,k=Bd(),Ld={readable:!1,writable:!1,push:n=>{},once:()=>{},on:()=>{},emit:()=>{},end:()=>{}};function Lc(){}var Yo=class extends md{constructor(t,e,r){super(),(typeof r!="object"||!r)&&(r={});let i=t._protocol._remoteIdentRaw;this.server=!!r.server,this._debug=typeof r.debug=="function"?r.debug:void 0,this._isOpenSSH=i&&vd.test(i),this._version=-1,this._extensions={},this._biOpt=r.biOpt,this._pktLenBytes=0,this._pktLen=0,this._pktPos=0,this._pktType=0,this._pktData=void 0,this._writeReqid=-1,this._requests={},this._maxInPktLen=Ko,this._maxOutPktLen=34e3,this._maxReadLen=(this._isOpenSSH?Ko:34e3)-Cc,this._maxWriteLen=(this._isOpenSSH?Ko:34e3)-Cc,this.maxOpenHandles=void 0,this._client=t,this._protocol=t._protocol,this._callbacks=[],this._hasX11=!1,this._exit={code:void 0,signal:void 0,dump:void 0,desc:void 0},this._waitWindow=!1,this._chunkcb=void 0,this._buffer=[],this.type=e.type,this.subtype=void 0,this.incoming=e.incoming,this.outgoing=e.outgoing,this.stderr=Ld,this.readable=!0}push(t){if(t===null){if(Dc(this),!this.readable)return;this.readable=!1,this.emit("end");return}let e=0;for(;e<t.length;){if(this._pktLenBytes<4){let o=Math.min(4-this._pktLenBytes,t.length-e);for(this._pktLenBytes+=o;o--;)this._pktLen=(this._pktLen<<8)+t[e++];if(this._pktLenBytes<4)return;if(this._pktLen===0)return it(this,"Invalid packet length");if(this._pktLen>this._maxInPktLen){let f=this._maxInPktLen;return it(this,`Packet length ${this._pktLen} exceeds max length of ${f}`)}if(e>=t.length)return}if(this._pktPos<this._pktLen){let o=Math.min(this._pktLen-this._pktPos,t.length-e);if(e!==0||o!==t.length?o===this._pktLen?this._pkt=new Cd(t.buffer,t.byteOffset+e,o):(this._pkt||(this._pkt=Buffer.allocUnsafe(this._pktLen)),this._pkt.set(new Uint8Array(t.buffer,t.byteOffset+e,o),this._pktPos)):o===this._pktLen?this._pkt=t:(this._pkt||(this._pkt=Buffer.allocUnsafe(this._pktLen)),this._pkt.set(t,this._pktPos)),e+=o,this._pktPos+=o,this._pktPos<this._pktLen)return}let r=this._pkt[0],i=this._pkt;this._pktLen=0,this._pktLenBytes=0,this._pkt=void 0,this._pktPos=0;let s=this.server?Qd[r]:Dd[r];if(!s)return it(this,`Unknown packet type ${r}`);if(this._version===-1){if(this.server){if(r!==Be.INIT)return it(this,`Expected INIT packet, got ${r}`)}else if(r!==Yt.VERSION)return it(this,`Expected VERSION packet, got ${r}`)}if(s(this,i)===!1)return}}end(){this.destroy()}destroy(){(this.outgoing.state==="open"||this.outgoing.state==="eof")&&(this.outgoing.state="closing",this._protocol.channelClose(this.outgoing.id))}_init(){this._init=Lc,this.server||Ve(this,Nd)}createReadStream(t,e){if(this.server)throw new Error("Client-only method called in server mode");return new Cn(this,t,e)}createWriteStream(t,e){if(this.server)throw new Error("Client-only method called in server mode");return new nn(this,t,e)}open(t,e,r,i){if(this.server)throw new Error("Client-only method called in server mode");typeof r=="function"&&(i=r,r=void 0);let s=typeof e=="number"?e:Uc(e);if(s===null)throw new Error(`Unknown flags string: ${e}`);let o=0,f=0;(typeof r=="string"||typeof r=="number")&&(r={mode:r}),typeof r=="object"&&r!==null&&(r=Xn(r),o=r.flags,f=r.nb);let a=Buffer.byteLength(t),u=9,h=Buffer.allocUnsafe(4+1+4+4+a+4+4+f);Q(h,h.length-4,0),h[4]=Be.OPEN;let l=this._writeReqid=this._writeReqid+1&ct;Q(h,l,5),Q(h,a,u),h.utf8Write(t,u+=4,a),Q(h,s,u+=a),Q(h,o,u+=4),f&&(u+=4,f===ke.length?h.set(ke,u):On(ke,h,0,f,u),u+=f),this._requests[l]={cb:i};let A=Ve(this,h);this._debug&&this._debug(`SFTP: Outbound: ${A?"Buffered":"Sending"} OPEN`)}close(t,e){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(t))throw new Error("handle is not a Buffer");let r=t.length,i=9,s=Buffer.allocUnsafe(4+1+4+4+r);Q(s,s.length-4,0),s[4]=Be.CLOSE;let o=this._writeReqid=this._writeReqid+1&ct;Q(s,o,5),Q(s,r,i),s.set(t,i+=4),this._requests[o]={cb:e};let f=Ve(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} CLOSE`)}read(t,e,r,i,s,o){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(t))throw new Error("handle is not a Buffer");if(!Buffer.isBuffer(e))throw new Error("buffer is not a Buffer");if(r>=e.length)throw new Error("offset is out of bounds");if(r+i>e.length)throw new Error("length extends beyond buffer");if(s===null)throw new Error("null position currently unsupported");Oc(this,t,e,r,i,s,o)}readData(t,e,r,i,s,o){this.read(t,e,r,i,s,o)}write(t,e,r,i,s,o){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(t))throw new Error("handle is not a Buffer");if(!Buffer.isBuffer(e))throw new Error("buffer is not a Buffer");if(r>e.length)throw new Error("offset is out of bounds");if(r+i>e.length)throw new Error("length extends beyond buffer");if(s===null)throw new Error("null position currently unsupported");if(!i){o&&process.nextTick(o,void 0,0);return}let f=this._maxWriteLen,a=Math.max(i-f,0),u=s;a&&(i=f);let h=t.length,l=9,A=Buffer.allocUnsafe(4+1+4+4+h+8+4+i);Q(A,A.length-4,0),A[4]=Be.WRITE;let _=this._writeReqid=this._writeReqid+1&ct;Q(A,_,5),Q(A,h,l),A.set(t,l+=4),l+=h;for(let b=7;b>=0;--b)A[l+b]=s&255,s/=256;Q(A,i,l+=8),On(e,A,r,r+i,l+=4),this._requests[_]={cb:b=>{b?typeof o=="function"&&o(b):a?this.write(t,e,r+i,a,u+i,o):typeof o=="function"&&o(void 0,r+i)}};let x=Ve(this,A);if(this._debug){let b=x?"Sent":"Buffered";this._debug(`SFTP: Outbound: ${b} WRITE (id:${_})`)}}writeData(t,e,r,i,s,o){this.write(t,e,r,i,s,o)}fastGet(t,e,r,i){if(this.server)throw new Error("Client-only method called in server mode");Bc(this,Un,t,e,r,i)}fastPut(t,e,r,i){if(this.server)throw new Error("Client-only method called in server mode");Bc(Un,this,t,e,r,i)}readFile(t,e,r){if(this.server)throw new Error("Client-only method called in server mode");let i;if(typeof r=="function"?i=r:typeof e=="function"&&(i=e,e=void 0),typeof e=="string")e={encoding:e,flag:"r"};else if(!e)e={encoding:null,flag:"r"};else if(typeof e!="object")throw new TypeError("Bad arguments");let s=e.encoding;if(s&&!Buffer.isEncoding(s))throw new Error(`Unknown encoding: ${s}`);let o,f,a,u=0,h,l=0,A=e.flag||"r",_=()=>{o===0?(f=Buffer.allocUnsafe(8192),this.read(h,f,0,8192,l,x)):this.read(h,f,u,o-u,l,x)},x=(w,C)=>{let v;if(w){if(v=w.code===et.EOF,!v)return this.close(h,()=>i&&i(w))}else v=!1;if(v||o===0&&C===0)return b();l+=C,u+=C,o!==0?u===o?b():_():(a.push(yr(f,0,C)),_())};x._wantEOFError=!0;let b=()=>{this.close(h,w=>(o===0?f=Buffer.concat(a,u):u<o&&(f=yr(f,0,u)),s&&(f=f.toString(s)),i&&i(w,f)))};this.open(t,A,438,(w,C)=>{if(w)return i&&i(w);h=C;let v=(X,L)=>{if(X){this.stat(t,(z,ne)=>{if(z)return this.close(h,()=>{i&&i(X)});v(null,ne)});return}if(o=L.size||0,o===0)return a=[],_();f=Buffer.allocUnsafe(o),_()};this.fstat(h,v)})}writeFile(t,e,r,i){if(this.server)throw new Error("Client-only method called in server mode");let s;if(typeof i=="function"?s=i:typeof r=="function"&&(s=r,r=void 0),typeof r=="string")r={encoding:r,mode:438,flag:"w"};else if(!r)r={encoding:"utf8",mode:438,flag:"w"};else if(typeof r!="object")throw new TypeError("Bad arguments");if(r.encoding&&!Buffer.isEncoding(r.encoding))throw new Error(`Unknown encoding: ${r.encoding}`);let o=r.flag||"w";this.open(t,o,r.mode,(f,a)=>{if(f)s&&s(f);else{let u=Buffer.isBuffer(e)?e:Buffer.from(""+e,r.encoding||"utf8"),h=/a/.test(o)?null:0;if(h===null){let l=(A,_)=>{if(A){this.stat(t,(x,b)=>{if(x)return this.close(a,()=>{s&&s(A)});l(null,b)});return}$o(this,a,u,0,u.length,_.size,s)};this.fstat(a,l);return}$o(this,a,u,0,u.length,h,s)}})}appendFile(t,e,r,i){if(this.server)throw new Error("Client-only method called in server mode");let s;if(typeof i=="function"?s=i:typeof r=="function"&&(s=r,r=void 0),typeof r=="string")r={encoding:r,mode:438,flag:"a"};else if(!r)r={encoding:"utf8",mode:438,flag:"a"};else if(typeof r!="object")throw new TypeError("Bad arguments");r.flag||(r=Object.assign({flag:"a"},r)),this.writeFile(t,e,r,s)}exists(t,e){if(this.server)throw new Error("Client-only method called in server mode");this.stat(t,r=>{e&&e(!r)})}unlink(t,e){if(this.server)throw new Error("Client-only method called in server mode");let r=Buffer.byteLength(t),i=9,s=Buffer.allocUnsafe(4+1+4+4+r);Q(s,s.length-4,0),s[4]=Be.REMOVE;let o=this._writeReqid=this._writeReqid+1&ct;Q(s,o,5),Q(s,r,i),s.utf8Write(t,i+=4,r),this._requests[o]={cb:e};let f=Ve(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} REMOVE`)}rename(t,e,r){if(this.server)throw new Error("Client-only method called in server mode");let i=Buffer.byteLength(t),s=Buffer.byteLength(e),o=9,f=Buffer.allocUnsafe(4+1+4+4+i+4+s);Q(f,f.length-4,0),f[4]=Be.RENAME;let a=this._writeReqid=this._writeReqid+1&ct;Q(f,a,5),Q(f,i,o),f.utf8Write(t,o+=4,i),Q(f,s,o+=i),f.utf8Write(e,o+=4,s),this._requests[a]={cb:r};let u=Ve(this,f);this._debug&&this._debug(`SFTP: Outbound: ${u?"Buffered":"Sending"} RENAME`)}mkdir(t,e,r){if(this.server)throw new Error("Client-only method called in server mode");let i=0,s=0;typeof e=="function"&&(r=e,e=void 0),typeof e=="object"&&e!==null&&(e=Xn(e),i=e.flags,s=e.nb);let o=Buffer.byteLength(t),f=9,a=Buffer.allocUnsafe(4+1+4+4+o+4+s);Q(a,a.length-4,0),a[4]=Be.MKDIR;let u=this._writeReqid=this._writeReqid+1&ct;Q(a,u,5),Q(a,o,f),a.utf8Write(t,f+=4,o),Q(a,i,f+=o),s&&(f+=4,s===ke.length?a.set(ke,f):On(ke,a,0,s,f),f+=s),this._requests[u]={cb:r};let h=Ve(this,a);this._debug&&this._debug(`SFTP: Outbound: ${h?"Buffered":"Sending"} MKDIR`)}rmdir(t,e){if(this.server)throw new Error("Client-only method called in server mode");let r=Buffer.byteLength(t),i=9,s=Buffer.allocUnsafe(4+1+4+4+r);Q(s,s.length-4,0),s[4]=Be.RMDIR;let o=this._writeReqid=this._writeReqid+1&ct;Q(s,o,5),Q(s,r,i),s.utf8Write(t,i+=4,r),this._requests[o]={cb:e};let f=Ve(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} RMDIR`)}readdir(t,e,r){if(this.server)throw new Error("Client-only method called in server mode");typeof e=="function"&&(r=e,e={}),(typeof e!="object"||e===null)&&(e={});let i=!(e&&e.full);if(!Buffer.isBuffer(t)&&typeof t!="string")throw new Error("missing directory handle or path");if(typeof t=="string"){let h=[],l=0,A=(_,x)=>{if(_)return r(_);this.readdir(x,e,(b,w)=>{let C=b&&b.code===et.EOF;if(b&&!C)return this.close(x,()=>r(b));if(C)return this.close(x,v=>{if(v)return r(v);r(void 0,h)});for(let v=0;v<w.length;++v,++l)h[l]=w[v];A(void 0,x)})};return this.opendir(t,A)}let s=t.length,o=9,f=Buffer.allocUnsafe(4+1+4+4+s);Q(f,f.length-4,0),f[4]=Be.READDIR;let a=this._writeReqid=this._writeReqid+1&ct;Q(f,a,5),Q(f,s,o),f.set(t,o+=4),this._requests[a]={cb:i?(h,l)=>{if(typeof r=="function"){if(h)return r(h);for(let A=l.length-1;A>=0;--A)(l[A].filename==="."||l[A].filename==="..")&&l.splice(A,1);r(void 0,l)}}:r};let u=Ve(this,f);this._debug&&this._debug(`SFTP: Outbound: ${u?"Buffered":"Sending"} READDIR`)}fstat(t,e){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(t))throw new Error("handle is not a Buffer");let r=t.length,i=9,s=Buffer.allocUnsafe(4+1+4+4+r);Q(s,s.length-4,0),s[4]=Be.FSTAT;let o=this._writeReqid=this._writeReqid+1&ct;Q(s,o,5),Q(s,r,i),s.set(t,i+=4),this._requests[o]={cb:e};let f=Ve(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} FSTAT`)}stat(t,e){if(this.server)throw new Error("Client-only method called in server mode");let r=Buffer.byteLength(t),i=9,s=Buffer.allocUnsafe(4+1+4+4+r);Q(s,s.length-4,0),s[4]=Be.STAT;let o=this._writeReqid=this._writeReqid+1&ct;Q(s,o,5),Q(s,r,i),s.utf8Write(t,i+=4,r),this._requests[o]={cb:e};let f=Ve(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} STAT`)}lstat(t,e){if(this.server)throw new Error("Client-only method called in server mode");let r=Buffer.byteLength(t),i=9,s=Buffer.allocUnsafe(4+1+4+4+r);Q(s,s.length-4,0),s[4]=Be.LSTAT;let o=this._writeReqid=this._writeReqid+1&ct;Q(s,o,5),Q(s,r,i),s.utf8Write(t,i+=4,r),this._requests[o]={cb:e};let f=Ve(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} LSTAT`)}opendir(t,e){if(this.server)throw new Error("Client-only method called in server mode");let r=Buffer.byteLength(t),i=9,s=Buffer.allocUnsafe(4+1+4+4+r);Q(s,s.length-4,0),s[4]=Be.OPENDIR;let o=this._writeReqid=this._writeReqid+1&ct;Q(s,o,5),Q(s,r,i),s.utf8Write(t,i+=4,r),this._requests[o]={cb:e};let f=Ve(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} OPENDIR`)}setstat(t,e,r){if(this.server)throw new Error("Client-only method called in server mode");let i=0,s=0;typeof e=="object"&&e!==null?(e=Xn(e),i=e.flags,s=e.nb):typeof e=="function"&&(r=e);let o=Buffer.byteLength(t),f=9,a=Buffer.allocUnsafe(4+1+4+4+o+4+s);Q(a,a.length-4,0),a[4]=Be.SETSTAT;let u=this._writeReqid=this._writeReqid+1&ct;Q(a,u,5),Q(a,o,f),a.utf8Write(t,f+=4,o),Q(a,i,f+=o),s&&(f+=4,s===ke.length?a.set(ke,f):On(ke,a,0,s,f),f+=s),this._requests[u]={cb:r};let h=Ve(this,a);this._debug&&this._debug(`SFTP: Outbound: ${h?"Buffered":"Sending"} SETSTAT`)}fsetstat(t,e,r){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(t))throw new Error("handle is not a Buffer");let i=0,s=0;typeof e=="object"&&e!==null?(e=Xn(e),i=e.flags,s=e.nb):typeof e=="function"&&(r=e);let o=t.length,f=9,a=Buffer.allocUnsafe(4+1+4+4+o+4+s);Q(a,a.length-4,0),a[4]=Be.FSETSTAT;let u=this._writeReqid=this._writeReqid+1&ct;Q(a,u,5),Q(a,o,f),a.set(t,f+=4),Q(a,i,f+=o),s&&(f+=4,s===ke.length?a.set(ke,f):On(ke,a,0,s,f),f+=s),this._requests[u]={cb:r};let h=Ve(this,a);this._debug&&this._debug(`SFTP: Outbound: ${h?"Buffered":"Sending"} FSETSTAT`)}futimes(t,e,r,i){return this.fsetstat(t,{atime:Ir(e),mtime:Ir(r)},i)}utimes(t,e,r,i){return this.setstat(t,{atime:Ir(e),mtime:Ir(r)},i)}fchown(t,e,r,i){return this.fsetstat(t,{uid:e,gid:r},i)}chown(t,e,r,i){return this.setstat(t,{uid:e,gid:r},i)}fchmod(t,e,r){return this.fsetstat(t,{mode:e},r)}chmod(t,e,r){return this.setstat(t,{mode:e},r)}readlink(t,e){if(this.server)throw new Error("Client-only method called in server mode");let r=Buffer.byteLength(t),i=9,s=Buffer.allocUnsafe(4+1+4+4+r);Q(s,s.length-4,0),s[4]=Be.READLINK;let o=this._writeReqid=this._writeReqid+1&ct;Q(s,o,5),Q(s,r,i),s.utf8Write(t,i+=4,r),this._requests[o]={cb:(a,u)=>{if(typeof e=="function"){if(a)return e(a);if(!u||!u.length)return e(new Error("Response missing link info"));e(void 0,u[0].filename)}}};let f=Ve(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} READLINK`)}symlink(t,e,r){if(this.server)throw new Error("Client-only method called in server mode");let i=Buffer.byteLength(e),s=Buffer.byteLength(t),o=9,f=Buffer.allocUnsafe(4+1+4+4+i+4+s);Q(f,f.length-4,0),f[4]=Be.SYMLINK;let a=this._writeReqid=this._writeReqid+1&ct;Q(f,a,5),this._isOpenSSH?(Q(f,s,o),f.utf8Write(t,o+=4,s),Q(f,i,o+=s),f.utf8Write(e,o+=4,i)):(Q(f,i,o),f.utf8Write(e,o+=4,i),Q(f,s,o+=i),f.utf8Write(t,o+=4,s)),this._requests[a]={cb:r};let u=Ve(this,f);this._debug&&this._debug(`SFTP: Outbound: ${u?"Buffered":"Sending"} SYMLINK`)}realpath(t,e){if(this.server)throw new Error("Client-only method called in server mode");let r=Buffer.byteLength(t),i=9,s=Buffer.allocUnsafe(4+1+4+4+r);Q(s,s.length-4,0),s[4]=Be.REALPATH;let o=this._writeReqid=this._writeReqid+1&ct;Q(s,o,5),Q(s,r,i),s.utf8Write(t,i+=4,r),this._requests[o]={cb:(a,u)=>{if(typeof e=="function"){if(a)return e(a);if(!u||!u.length)return e(new Error("Response missing path info"));e(void 0,u[0].filename)}}};let f=Ve(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} REALPATH`)}ext_openssh_rename(t,e,r){if(this.server)throw new Error("Client-only method called in server mode");let i=this._extensions["posix-rename@openssh.com"];if(!i||i!=="1")throw new Error("Server does not support this extended request");let s=Buffer.byteLength(t),o=Buffer.byteLength(e),f=9,a=Buffer.allocUnsafe(4+1+4+4+24+4+s+4+o);Q(a,a.length-4,0),a[4]=Be.EXTENDED;let u=this._writeReqid=this._writeReqid+1&ct;Q(a,u,5),Q(a,24,f),a.utf8Write("posix-rename@openssh.com",f+=4,24),Q(a,s,f+=24),a.utf8Write(t,f+=4,s),Q(a,o,f+=s),a.utf8Write(e,f+=4,o),this._requests[u]={cb:r};let h=Ve(this,a);if(this._debug){let l=h?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${l} posix-rename@openssh.com`)}}ext_openssh_statvfs(t,e){if(this.server)throw new Error("Client-only method called in server mode");let r=this._extensions["statvfs@openssh.com"];if(!r||r!=="2")throw new Error("Server does not support this extended request");let i=Buffer.byteLength(t),s=9,o=Buffer.allocUnsafe(4+1+4+4+19+4+i);Q(o,o.length-4,0),o[4]=Be.EXTENDED;let f=this._writeReqid=this._writeReqid+1&ct;Q(o,f,5),Q(o,19,s),o.utf8Write("statvfs@openssh.com",s+=4,19),Q(o,i,s+=19),o.utf8Write(t,s+=4,i),this._requests[f]={extended:"statvfs@openssh.com",cb:e};let a=Ve(this,o);if(this._debug){let u=a?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${u} statvfs@openssh.com`)}}ext_openssh_fstatvfs(t,e){if(this.server)throw new Error("Client-only method called in server mode");let r=this._extensions["fstatvfs@openssh.com"];if(!r||r!=="2")throw new Error("Server does not support this extended request");if(!Buffer.isBuffer(t))throw new Error("handle is not a Buffer");let i=t.length,s=9,o=Buffer.allocUnsafe(4+1+4+4+20+4+i);Q(o,o.length-4,0),o[4]=Be.EXTENDED;let f=this._writeReqid=this._writeReqid+1&ct;Q(o,f,5),Q(o,20,s),o.utf8Write("fstatvfs@openssh.com",s+=4,20),Q(o,i,s+=20),o.set(t,s+=4),this._requests[f]={extended:"fstatvfs@openssh.com",cb:e};let a=Ve(this,o);if(this._debug){let u=a?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${u} fstatvfs@openssh.com`)}}ext_openssh_hardlink(t,e,r){if(this.server)throw new Error("Client-only method called in server mode");if(this._extensions["hardlink@openssh.com"]!=="1")throw new Error("Server does not support this extended request");let s=Buffer.byteLength(t),o=Buffer.byteLength(e),f=9,a=Buffer.allocUnsafe(4+1+4+4+20+4+s+4+o);Q(a,a.length-4,0),a[4]=Be.EXTENDED;let u=this._writeReqid=this._writeReqid+1&ct;Q(a,u,5),Q(a,20,f),a.utf8Write("hardlink@openssh.com",f+=4,20),Q(a,s,f+=20),a.utf8Write(t,f+=4,s),Q(a,o,f+=s),a.utf8Write(e,f+=4,o),this._requests[u]={cb:r};let h=Ve(this,a);if(this._debug){let l=h?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${l} hardlink@openssh.com`)}}ext_openssh_fsync(t,e){if(this.server)throw new Error("Client-only method called in server mode");if(this._extensions["fsync@openssh.com"]!=="1")throw new Error("Server does not support this extended request");if(!Buffer.isBuffer(t))throw new Error("handle is not a Buffer");let i=t.length,s=9,o=Buffer.allocUnsafe(4+1+4+4+17+4+i);Q(o,o.length-4,0),o[4]=Be.EXTENDED;let f=this._writeReqid=this._writeReqid+1&ct;Q(o,f,5),Q(o,17,s),o.utf8Write("fsync@openssh.com",s+=4,17),Q(o,i,s+=17),o.set(t,s+=4),this._requests[f]={cb:e};let a=Ve(this,o);this._debug&&this._debug(`SFTP: Outbound: ${a?"Buffered":"Sending"} fsync@openssh.com`)}ext_openssh_lsetstat(t,e,r){if(this.server)throw new Error("Client-only method called in server mode");if(this._extensions["lsetstat@openssh.com"]!=="1")throw new Error("Server does not support this extended request");let s=0,o=0;typeof e=="object"&&e!==null?(e=Xn(e),s=e.flags,o=e.nb):typeof e=="function"&&(r=e);let f=Buffer.byteLength(t),a=9,u=Buffer.allocUnsafe(4+1+4+4+20+4+f+4+o);Q(u,u.length-4,0),u[4]=Be.EXTENDED;let h=this._writeReqid=this._writeReqid+1&ct;Q(u,h,5),Q(u,20,a),u.utf8Write("lsetstat@openssh.com",a+=4,20),Q(u,f,a+=20),u.utf8Write(t,a+=4,f),Q(u,s,a+=f),o&&(a+=4,o===ke.length?u.set(ke,a):On(ke,u,0,o,a),a+=o),this._requests[h]={cb:r};let l=Ve(this,u);if(this._debug){let A=l?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${A} lsetstat@openssh.com`)}}ext_openssh_expandPath(t,e){if(this.server)throw new Error("Client-only method called in server mode");if(this._extensions["expand-path@openssh.com"]!=="1")throw new Error("Server does not support this extended request");let i=Buffer.byteLength(t),s=9,o=Buffer.allocUnsafe(4+1+4+4+23+4+i);Q(o,o.length-4,0),o[4]=Be.EXTENDED;let f=this._writeReqid=this._writeReqid+1&ct;Q(o,f,5),Q(o,23,s),o.utf8Write("expand-path@openssh.com",s+=4,23),Q(o,i,s+=20),o.utf8Write(t,s+=4,i),this._requests[f]={cb:(u,h)=>{if(typeof e=="function"){if(u)return e(u);if(!h||!h.length)return e(new Error("Response missing expanded path"));e(void 0,h[0].filename)}}};let a=Ve(this,o);if(this._debug){let u=a?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${u} expand-path@openssh.com`)}}ext_copy_data(t,e,r,i,s,o){if(this.server)throw new Error("Client-only method called in server mode");if(this._extensions["copy-data"]!=="1")throw new Error("Server does not support this extended request");if(!Buffer.isBuffer(t))throw new Error("Source handle is not a Buffer");if(!Buffer.isBuffer(i))throw new Error("Destination handle is not a Buffer");let a=0,u=Buffer.allocUnsafe(4+1+4+4+9+4+t.length+8+8+4+i.length+8);Q(u,u.length-4,a),a+=4,u[a]=Be.EXTENDED,++a;let h=this._writeReqid=this._writeReqid+1&ct;Q(u,h,a),a+=4,Q(u,9,a),a+=4,u.utf8Write("copy-data",a,9),a+=9,Q(u,t.length,a),a+=4,u.set(t,a),a+=t.length;for(let A=7;A>=0;--A)u[a+A]=e&255,e/=256;a+=8;for(let A=7;A>=0;--A)u[a+A]=r&255,r/=256;a+=8,Q(u,i.length,a),a+=4,u.set(i,a),a+=i.length;for(let A=7;A>=0;--A)u[a+A]=s&255,s/=256;this._requests[h]={cb:o};let l=Ve(this,u);if(this._debug){let A=l?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${A} copy-data`)}}ext_home_dir(t,e){if(this.server)throw new Error("Client-only method called in server mode");if(this._extensions["home-directory"]!=="1")throw new Error("Server does not support this extended request");if(typeof t!="string")throw new TypeError("username is not a string");let i=0,s=Buffer.byteLength(t),o=Buffer.allocUnsafe(4+1+4+4+14+4+s);Q(o,o.length-4,i),i+=4,o[i]=Be.EXTENDED,++i;let f=this._writeReqid=this._writeReqid+1&ct;Q(o,f,i),i+=4,Q(o,14,i),i+=4,o.utf8Write("home-directory",i,14),i+=14,Q(o,s,i),i+=4,o.utf8Write(t,i,s),i+=s,this._requests[f]={cb:(u,h)=>{if(typeof e=="function"){if(u)return e(u);if(!h||!h.length)return e(new Error("Response missing home directory"));e(void 0,h[0].filename)}}};let a=Ve(this,o);if(this._debug){let u=a?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${u} home-directory`)}}ext_users_groups(t,e,r){if(this.server)throw new Error("Client-only method called in server mode");if(this._extensions["users-groups-by-id@openssh.com"]!=="1")throw new Error("Server does not support this extended request");if(!Array.isArray(t))throw new TypeError("uids is not an array");for(let u of t)if(!Number.isInteger(u)||u<0||u>2**32-1)throw new Error("uid values must all be 32-bit unsigned integers");if(!Array.isArray(e))throw new TypeError("gids is not an array");for(let u of e)if(!Number.isInteger(u)||u<0||u>2**32-1)throw new Error("gid values must all be 32-bit unsigned integers");let s=0,o=Buffer.allocUnsafe(4+1+4+4+30+4+4*t.length+4+4*e.length);Q(o,o.length-4,s),s+=4,o[s]=Be.EXTENDED,++s;let f=this._writeReqid=this._writeReqid+1&ct;Q(o,f,s),s+=4,Q(o,30,s),s+=4,o.utf8Write("users-groups-by-id@openssh.com",s,30),s+=30,Q(o,4*t.length,s),s+=4;for(let u of t)Q(o,u,s),s+=4;Q(o,4*e.length,s),s+=4;for(let u of e)Q(o,u,s),s+=4;this._requests[f]={extended:"users-groups-by-id@openssh.com",cb:r};let a=Ve(this,o);if(this._debug){let u=a?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${u} users-groups-by-id@openssh.com`)}}handle(t,e){if(!this.server)throw new Error("Server-only method called in client mode");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");let r=e.length;if(r>256)throw new Error("handle too large (> 256 bytes)");let i=9,s=Buffer.allocUnsafe(4+1+4+4+r);Q(s,s.length-4,0),s[4]=Yt.HANDLE,Q(s,t,5),Q(s,r,i),r&&s.set(e,i+=4);let o=Ve(this,s);this._debug&&this._debug(`SFTP: Outbound: ${o?"Buffered":"Sending"} HANDLE`)}status(t,e,r){if(!this.server)throw new Error("Server-only method called in client mode");if(!Rd.has(e))throw new Error(`Bad status code: ${e}`);r||(r="");let i=Buffer.byteLength(r),s=9,o=Buffer.allocUnsafe(4+1+4+4+4+i+4);Q(o,o.length-4,0),o[4]=Yt.STATUS,Q(o,t,5),Q(o,e,s),Q(o,i,s+=4),s+=4,i&&(o.utf8Write(r,s,i),s+=i),Q(o,0,s);let f=Ve(this,o);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} STATUS`)}data(t,e,r){if(!this.server)throw new Error("Server-only method called in client mode");let i=Buffer.isBuffer(e);if(!i&&typeof e!="string")throw new Error("data is not a Buffer or string");let s;!i&&!r&&(r=void 0,s=!0);let o=i?e.length:Buffer.byteLength(e,r),f=9,a=Buffer.allocUnsafe(4+1+4+4+o);Q(a,a.length-4,0),a[4]=Yt.DATA,Q(a,t,5),Q(a,o,f),o&&(i?a.set(e,f+=4):s?a.utf8Write(e,f+=4,o):a.write(e,f+=4,o,r));let u=Ve(this,a);this._debug&&this._debug(`SFTP: Outbound: ${u?"Buffered":"Sending"} DATA`)}name(t,e){if(!this.server)throw new Error("Server-only method called in client mode");if(!Array.isArray(e)){if(typeof e!="object"||e===null)throw new Error("names is not an object or array");e=[e]}let r=e.length,i=0,s,o=[];for(let h=0;h<r;++h){let l=e[h],A=!l||!l.filename||typeof l.filename!="string"?"":l.filename;i+=4+Buffer.byteLength(A);let _=!l||!l.longname||typeof l.longname!="string"?"":l.longname;if(i+=4+Buffer.byteLength(_),typeof l.attrs=="object"&&l.attrs!==null){if(s=Xn(l.attrs),i+=4+s.nb,s.nb){let x;s.nb===ke.length?x=new Uint8Array(ke):(x=new Uint8Array(s.nb),On(ke,x,0,s.nb,0)),s.bytes=x}o.push(s)}else i+=4,o.push(null)}let f=9,a=Buffer.allocUnsafe(4+1+4+4+i);Q(a,a.length-4,0),a[4]=Yt.NAME,Q(a,t,5),Q(a,r,f),f+=4;for(let h=0;h<r;++h){let l=e[h];{let _=!l||!l.filename||typeof l.filename!="string"?"":l.filename,x=Buffer.byteLength(_);Q(a,x,f),f+=4,x&&(a.utf8Write(_,f,x),f+=x)}{let _=!l||!l.longname||typeof l.longname!="string"?"":l.longname,x=Buffer.byteLength(_);Q(a,x,f),f+=4,x&&(a.utf8Write(_,f,x),f+=x)}let A=o[h];A?(Q(a,A.flags,f),f+=4,A.flags&&A.bytes&&(a.set(A.bytes,f),f+=A.nb)):(Q(a,0,f),f+=4)}let u=Ve(this,a);this._debug&&this._debug(`SFTP: Outbound: ${u?"Buffered":"Sending"} NAME`)}attrs(t,e){if(!this.server)throw new Error("Server-only method called in client mode");if(typeof e!="object"||e===null)throw new Error("attrs is not an object");e=Xn(e);let r=e.flags,i=e.nb,s=9,o=Buffer.allocUnsafe(4+1+4+4+i);Q(o,o.length-4,0),o[4]=Yt.ATTRS,Q(o,t,5),Q(o,r,s),i&&(s+=4,i===ke.length?o.set(ke,s):On(ke,o,0,i,s),s+=i);let f=Ve(this,o);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} ATTRS`)}};function Od(n){try{return Buffer.allocUnsafe(n)}catch(t){return t}}function Oc(n,t,e,r,i,s,o,f){let a=n._maxReadLen,u=Math.max(i-a,0);u&&(i=a);let h=t.length,l=9,A=s,_=Buffer.allocUnsafe(4+1+4+4+h+8+4);Q(_,_.length-4,0),_[4]=Be.READ;let x=n._writeReqid=n._writeReqid+1&ct;Q(_,x,5),Q(_,h,l),_.set(t,l+=4),l+=h;for(let C=7;C>=0;--C)_[l+C]=A&255,A/=256;Q(_,i,l+=8),typeof o!="function"&&(o=Lc);let b=f||{nb:0,position:s,off:r,origOff:r,len:void 0,overflow:void 0,cb:(C,v,X)=>{let L=b.len,z=b.overflow;if(C){if(o._wantEOFError||C.code!==et.EOF)return o(C)}else{if(X>L)return o(new Error("Received more data than requested"));if(X===L&&z){b.nb+=X,b.position+=X,b.off+=X,Oc(n,t,e,b.off,z,b.position,o,b);return}}X=X||0,b.origOff===0&&e.length===b.nb?v=e:v=yr(e,b.origOff,b.origOff+b.nb+X),o(void 0,b.nb+X,v,b.position)},buffer:void 0};b.len=i,b.overflow=u,b.buffer=yr(e,r,r+i),n._requests[x]=b;let w=Ve(n,_);n._debug&&n._debug(`SFTP: Outbound: ${w?"Buffered":"Sending"} READ`)}function Bc(n,t,e,r,i,s){let o=64,f=32768,a,u,h;typeof i=="function"?s=i:typeof i=="object"&&i!==null&&(typeof i.concurrency=="number"&&i.concurrency>0&&!isNaN(i.concurrency)&&(o=i.concurrency),typeof i.chunkSize=="number"&&i.chunkSize>0&&!isNaN(i.chunkSize)&&(f=i.chunkSize),typeof i.fileSize=="number"&&i.fileSize>0&&!isNaN(i.fileSize)&&(h=i.fileSize),typeof i.step=="function"&&(a=i.step),(typeof i.mode=="string"||typeof i.mode=="number")&&(u=Jo(i.mode)));let l,A=0,_=0,x=!1,b,w,C,v=f*o;function X(L){if(x)return;x=!0;let z=0,ne;b||w?(ne=()=>{--z===0&&s(L)},b&&(n===Un||n.outgoing.state==="open")&&++z,w&&(t===Un||t.outgoing.state==="open")&&++z,b&&(n===Un||n.outgoing.state==="open")&&n.close(b,ne),w&&(t===Un||t.outgoing.state==="open")&&t.close(w,ne)):s(L)}n.open(e,"r",(L,z)=>{if(L)return X(L);b=z,h===void 0?n.fstat(b,ne):ne(null,{size:h});function ne(J,y){if(J){if(n!==Un){n.stat(e,(S,O)=>{if(S)return X(J);ne(null,O)});return}return X(J)}l=y.size,t.open(r,"w",(S,O)=>{if(S)return X(S);if(w=O,l<=0)return X();for(;v>l;){if(o===1){v=l;break}v-=f,--o}if(C=Od(v),C instanceof Error)return X(C);u!==void 0?t.fchmod(w,u,function Z(re){if(re){t.chmod(r,u,oe=>Z());return}te()}):te();function q(Z,re,oe,T,M,F){if(Z)return X(Z);M=M||0,t.write(w,C,M,re,T,V);function V(Ae){if(Ae)return X(Ae);if(_+=re,a&&a(_,re,l),re<F)return se(M,T+re,F-re);if(_===l){t.close(w,Ee=>{if(w=void 0,Ee)return X(Ee);n.close(b,dt=>{if(b=void 0,dt)return X(dt);s()})});return}if(A>=l)return;let pe=A+f>l?l-A:f;se(M,A,pe),A+=pe}}function H(Z,re,oe){return(T,M,F)=>{q(T,M,F,re,Z,oe)}}function se(Z,re,oe){n.read(b,C,Z,oe,re,H(Z,re,oe))}function te(){let Z=0,re=0;for(;A<l&&Z<o;){let oe=A+f>l?l-A:f;se(re,A,oe),re+=oe,A+=oe,++Z}}})}})}function $o(n,t,e,r,i,s,o){let f=typeof o=="function"?o:void 0;n.write(t,e,r,i,s,(a,u)=>{if(a)return n.close(t,()=>{f&&f(a)});u===i?n.close(t,f):(r+=u,i-=u,s+=u,$o(n,t,e,r,i,s,f))})}var ns=class{constructor(t){this.mode=t&&t.mode,this.uid=t&&t.uid,this.gid=t&&t.gid,this.size=t&&t.size,this.atime=t&&t.atime,this.mtime=t&&t.mtime,this.extended=t&&t.extended}isDirectory(){return(this.mode&Gt.S_IFMT)===Gt.S_IFDIR}isFile(){return(this.mode&Gt.S_IFMT)===Gt.S_IFREG}isBlockDevice(){return(this.mode&Gt.S_IFMT)===Gt.S_IFBLK}isCharacterDevice(){return(this.mode&Gt.S_IFMT)===Gt.S_IFCHR}isSymbolicLink(){return(this.mode&Gt.S_IFMT)===Gt.S_IFLNK}isFIFO(){return(this.mode&Gt.S_IFMT)===Gt.S_IFIFO}isSocket(){return(this.mode&Gt.S_IFMT)===Gt.S_IFSOCK}};function Xn(n){let t=0,e=0;if(typeof n=="object"&&n!==null){if(typeof n.size=="number"){t|=mn.SIZE;let r=n.size;ke[e++]=r/72057594037927940,ke[e++]=r/281474976710656,ke[e++]=r/1099511627776,ke[e++]=r/4294967296,ke[e++]=r/16777216,ke[e++]=r/65536,ke[e++]=r/256,ke[e++]=r}if(typeof n.uid=="number"&&typeof n.gid=="number"){t|=mn.UIDGID;let r=n.uid,i=n.gid;ke[e++]=r>>>24,ke[e++]=r>>>16,ke[e++]=r>>>8,ke[e++]=r,ke[e++]=i>>>24,ke[e++]=i>>>16,ke[e++]=i>>>8,ke[e++]=i}if(typeof n.mode=="number"||typeof n.mode=="string"){let r=Jo(n.mode);t|=mn.PERMISSIONS,ke[e++]=r>>>24,ke[e++]=r>>>16,ke[e++]=r>>>8,ke[e++]=r}if((typeof n.atime=="number"||Go(n.atime))&&(typeof n.mtime=="number"||Go(n.mtime))){let r=Ir(n.atime),i=Ir(n.mtime);t|=mn.ACMODTIME,ke[e++]=r>>>24,ke[e++]=r>>>16,ke[e++]=r>>>8,ke[e++]=r,ke[e++]=i>>>24,ke[e++]=i>>>16,ke[e++]=i>>>8,ke[e++]=i}}return{flags:t,nb:e}}function Ir(n){if(typeof n=="number"&&n===n)return n;if(Go(n))return parseInt(n.getTime()/1e3,10);throw new Error(`Cannot parse time: ${n}`)}function Jo(n){if(typeof n=="number"&&n===n)return n;if(typeof n=="string")return Jo(parseInt(n,8));throw new Error(`Cannot parse mode: ${n}`)}var Xo={r:we.READ,"r+":we.READ|we.WRITE,w:we.TRUNC|we.CREAT|we.WRITE,wx:we.TRUNC|we.CREAT|we.WRITE|we.EXCL,xw:we.TRUNC|we.CREAT|we.WRITE|we.EXCL,"w+":we.TRUNC|we.CREAT|we.READ|we.WRITE,"wx+":we.TRUNC|we.CREAT|we.READ|we.WRITE|we.EXCL,"xw+":we.TRUNC|we.CREAT|we.READ|we.WRITE|we.EXCL,a:we.APPEND|we.CREAT|we.WRITE,ax:we.APPEND|we.CREAT|we.WRITE|we.EXCL,xa:we.APPEND|we.CREAT|we.WRITE|we.EXCL,"a+":we.APPEND|we.CREAT|we.READ|we.WRITE,"ax+":we.APPEND|we.CREAT|we.READ|we.WRITE|we.EXCL,"xa+":we.APPEND|we.CREAT|we.READ|we.WRITE|we.EXCL};function Uc(n){let t=Xo[n];return t!==void 0?t:null}var Ud=(()=>{let n=Object.keys(Xo);return t=>{for(let e=0;e<n.length;++e){let r=n[e];if(Xo[r]===t)return r}return null}})();function xr(n){let t=k.readUInt32BE();if(t===void 0)return;let e=new ns;if(t&mn.SIZE){let r=k.readUInt64BE(n);if(r===void 0)return;e.size=r}if(t&mn.UIDGID){let r=k.readUInt32BE(),i=k.readUInt32BE();if(i===void 0)return;e.uid=r,e.gid=i}if(t&mn.PERMISSIONS){let r=k.readUInt32BE();if(r===void 0)return;e.mode=r}if(t&mn.ACMODTIME){let r=k.readUInt32BE(),i=k.readUInt32BE();if(i===void 0)return;e.atime=r,e.mtime=i}if(t&mn.EXTENDED){let r=k.readUInt32BE();if(r===void 0)return;let i={};for(let s=0;s<r;++s){let o=k.readString(!0),f=k.readString();if(f===void 0)return;i[o]=f}e.extended=i}return e}function Ve(n,t){let e=Pc(n,t);return e!==void 0?(n._buffer.push(e),!1):!0}function Pc(n,t){let e=n.outgoing;if(e.state!=="open")return;if(e.window===0)return n._waitWindow=!0,n._chunkcb=Rc,t;let r,i=t.length,s=0;for(;i-s>0&&e.window>0;){let o=Math.min(i-s,e.window,e.packetSize);e.window-=o,e.window===0&&(n._waitWindow=!0,n._chunkcb=Rc),s===0&&o===i?n._protocol.channelData(n.outgoing.id,t):n._protocol.channelData(n.outgoing.id,yr(t,s,s+o)),s+=o}return i-s>0&&(s>0?r=yr(t,s,i):r=t),r}function Rc(){this._chunkcb=void 0;let n=this._buffer,t=0;for(;t<n.length;){let e=n[t],r=Pc(this,e);if(r!==void 0){r!==e&&(n[t]=r),t>0&&(this._buffer=n.slice(t));return}++t}t>0&&(this._buffer=[])}function it(n,t,e){let r=new Error(t);return r.level="sftp-protocol",!e&&n._debug&&n._debug(`SFTP: Inbound: ${t}`),n.emit("error",r),n.destroy(),Dc(n),!1}function Dc(n){let t=Object.keys(n._requests);if(t.length===0)return;let e=n._requests;n._requests={};let r=new Error("No response from server");for(let i=0;i<t.length;++i){let s=e[t[i]];typeof s.cb=="function"&&s.cb(r)}}function Pd(n,t){let e=9,r=Buffer.allocUnsafe(4+1+4+4+18);Q(r,r.length-4,0),r[4]=Be.EXTENDED;let i=n._writeReqid=n._writeReqid+1&ct;Q(r,i,5),Q(r,18,e),r.utf8Write("limits@openssh.com",e+=4,18),n._requests[i]={extended:"limits@openssh.com",cb:t};let s=Ve(n,r);if(n._debug){let o=s?"Buffered":"Sending";n._debug(`SFTP: Outbound: ${o} limits@openssh.com`)}}var Dd={[Yt.VERSION]:(n,t)=>{if(n._version!==-1)return it(n,"Duplicate VERSION packet");let e={};k.init(t,1);let r=k.readUInt32BE();for(;k.avail();){let i=k.readString(!0),s=k.readString(!0);if(s===void 0){r=void 0;break}e[i]=s}if(k.clear(),r===void 0)return it(n,"Malformed VERSION packet");if(n._debug){let i=Object.keys(e);i.length?n._debug(`SFTP: Inbound: Received VERSION (v${r}, exts:${i})`):n._debug(`SFTP: Inbound: Received VERSION (v${r})`)}if(n._version=r,n._extensions=e,e["limits@openssh.com"]==="1")return Pd(n,(i,s)=>{i||(s.maxPktLen>0&&(n._maxOutPktLen=s.maxPktLen),s.maxReadLen>0&&(n._maxReadLen=s.maxReadLen),s.maxWriteLen>0&&(n._maxWriteLen=s.maxWriteLen),n.maxOpenHandles=s.maxOpenHandles>0?s.maxOpenHandles:1/0),n.emit("ready")});n.emit("ready")},[Yt.STATUS]:(n,t)=>{k.init(t,1);let e=k.readUInt32BE(),r=k.readUInt32BE(),i=k.readString(!0);if(k.clear(),n._debug){let o=JSON.stringify(i);n._debug(`SFTP: Inbound: Received STATUS (id:${e}, ${r}, ${o})`)}let s=n._requests[e];if(delete n._requests[e],s&&typeof s.cb=="function"){if(r===et.OK){s.cb();return}let o=new Error(i||kd[r]||"Unknown status");o.code=r,s.cb(o)}},[Yt.HANDLE]:(n,t)=>{k.init(t,1);let e=k.readUInt32BE(),r=k.readString();if(k.clear(),r===void 0)return e!==void 0&&delete n._requests[e],it(n,"Malformed HANDLE packet");n._debug&&n._debug(`SFTP: Inbound: Received HANDLE (id:${e})`);let i=n._requests[e];delete n._requests[e],i&&typeof i.cb=="function"&&i.cb(void 0,r)},[Yt.DATA]:(n,t)=>{k.init(t,1);let e=k.readUInt32BE(),r;if(e!==void 0&&(r=n._requests[e],delete n._requests[e]),r&&typeof r.cb=="function")if(r.buffer){let i=k.readString(r.buffer);if(k.clear(),i!==void 0){n._debug&&n._debug(`SFTP: Inbound: Received DATA (id:${e}, ${i})`),r.cb(void 0,r.buffer,i);return}}else{let i=k.readString();if(k.clear(),i!==void 0){n._debug&&n._debug(`SFTP: Inbound: Received DATA (id:${e}, ${i.length})`),r.cb(void 0,i);return}}else{let i=k.skipString();if(k.clear(),i!==void 0){n._debug&&n._debug(`SFTP: Inbound: Received DATA (id:${e}, ${i})`);return}}return it(n,"Malformed DATA packet")},[Yt.NAME]:(n,t)=>{k.init(t,1);let e=k.readUInt32BE(),r;e!==void 0&&(r=n._requests[e],delete n._requests[e]);let i=k.readUInt32BE();if(i!==void 0){let s=[];for(let o=0;o<i;++o){let f=k.readString(!0),a=k.readString(!0),u=xr(n._biOpt);if(u===void 0){s=void 0;break}s.push({filename:f,longname:a,attrs:u})}if(s!==void 0){n._debug&&n._debug(`SFTP: Inbound: Received NAME (id:${e}, ${s.length})`),k.clear(),r&&typeof r.cb=="function"&&r.cb(void 0,s);return}}return k.clear(),it(n,"Malformed NAME packet")},[Yt.ATTRS]:(n,t)=>{k.init(t,1);let e=k.readUInt32BE(),r;e!==void 0&&(r=n._requests[e],delete n._requests[e]);let i=xr(n._biOpt);if(k.clear(),i!==void 0){n._debug&&n._debug(`SFTP: Inbound: Received ATTRS (id:${e})`),r&&typeof r.cb=="function"&&r.cb(void 0,i);return}return it(n,"Malformed ATTRS packet")},[Yt.EXTENDED]:(n,t)=>{k.init(t,1);let e=k.readUInt32BE();if(e!==void 0){let r=n._requests[e];if(r)switch(delete n._requests[e],r.extended){case"statvfs@openssh.com":case"fstatvfs@openssh.com":{let i=n._biOpt,s={f_bsize:k.readUInt64BE(i),f_frsize:k.readUInt64BE(i),f_blocks:k.readUInt64BE(i),f_bfree:k.readUInt64BE(i),f_bavail:k.readUInt64BE(i),f_files:k.readUInt64BE(i),f_ffree:k.readUInt64BE(i),f_favail:k.readUInt64BE(i),f_sid:k.readUInt64BE(i),f_flag:k.readUInt64BE(i),f_namemax:k.readUInt64BE(i)};if(s.f_namemax===void 0)break;n._debug&&n._debug(`SFTP: Inbound: Received EXTENDED_REPLY (id:${e}, ${r.extended})`),k.clear(),typeof r.cb=="function"&&r.cb(void 0,s);return}case"limits@openssh.com":{let i={maxPktLen:k.readUInt64BE(),maxReadLen:k.readUInt64BE(),maxWriteLen:k.readUInt64BE(),maxOpenHandles:k.readUInt64BE()};if(i.maxOpenHandles===void 0)break;n._debug&&n._debug(`SFTP: Inbound: Received EXTENDED_REPLY (id:${e}, ${r.extended})`),k.clear(),typeof r.cb=="function"&&r.cb(void 0,i);return}case"users-groups-by-id@openssh.com":{let i=k.readUInt32BE();if(i===void 0)break;let s=new Array(i);for(let a=0;a<s.length;++a)s[a]=k.readString(!0);let o=k.readUInt32BE();if(o===void 0)break;let f=new Array(o);for(let a=0;a<f.length;++a)f[a]=k.readString(!0);if(f.length>0&&f[f.length-1]===void 0)break;n._debug&&n._debug(`SFTP: Inbound: Received EXTENDED_REPLY (id:${e}, ${r.extended})`),k.clear(),typeof r.cb=="function"&&r.cb(void 0,s,f);return}default:n._debug&&n._debug(`SFTP: Inbound: Received EXTENDED_REPLY (id:${e}, ???)`),k.clear(),typeof r.cb=="function"&&r.cb();return}else{n._debug&&n._debug(`SFTP: Inbound: Received EXTENDED_REPLY (id:${e}, ???)`),k.clear();return}}return k.clear(),it(n,"Malformed EXTENDED_REPLY packet")}},Qd={[Be.INIT]:(n,t)=>{if(n._version!==-1)return it(n,"Duplicate INIT packet");let e={};k.init(t,1);let r=k.readUInt32BE();for(;k.avail();){let i=k.readString(!0),s=k.readString(!0);if(s===void 0){r=void 0;break}e[i]=s}if(k.clear(),r===void 0)return it(n,"Malformed INIT packet");if(n._debug){let i=Object.keys(e);i.length?n._debug(`SFTP: Inbound: Received INIT (v${r}, exts:${i})`):n._debug(`SFTP: Inbound: Received INIT (v${r})`)}Ve(n,Td),n._version=r,n._extensions=e,n.emit("ready")},[Be.OPEN]:(n,t)=>{k.init(t,1);let e=k.readUInt32BE(),r=k.readString(!0),i=k.readUInt32BE(),s=xr(n._biOpt);if(k.clear(),s===void 0)return it(n,"Malformed OPEN packet");n._debug&&n._debug(`SFTP: Inbound: Received OPEN (id:${e})`),n.emit("OPEN",e,r,i,s)||n.status(e,et.OP_UNSUPPORTED)},[Be.CLOSE]:(n,t)=>{k.init(t,1);let e=k.readUInt32BE(),r=k.readString();if(k.clear(),r===void 0||r.length>256)return it(n,"Malformed CLOSE packet");n._debug&&n._debug(`SFTP: Inbound: Received CLOSE (id:${e})`),n.emit("CLOSE",e,r)||n.status(e,et.OP_UNSUPPORTED)},[Be.READ]:(n,t)=>{k.init(t,1);let e=k.readUInt32BE(),r=k.readString(),i=k.readUInt64BE(n._biOpt),s=k.readUInt32BE();if(k.clear(),s===void 0||r.length>256)return it(n,"Malformed READ packet");n._debug&&n._debug(`SFTP: Inbound: Received READ (id:${e})`),n.emit("READ",e,r,i,s)||n.status(e,et.OP_UNSUPPORTED)},[Be.WRITE]:(n,t)=>{k.init(t,1);let e=k.readUInt32BE(),r=k.readString(),i=k.readUInt64BE(n._biOpt),s=k.readString();if(k.clear(),s===void 0||r.length>256)return it(n,"Malformed WRITE packet");n._debug&&n._debug(`SFTP: Inbound: Received WRITE (id:${e})`),n.emit("WRITE",e,r,i,s)||n.status(e,et.OP_UNSUPPORTED)},[Be.LSTAT]:(n,t)=>{k.init(t,1);let e=k.readUInt32BE(),r=k.readString(!0);if(k.clear(),r===void 0)return it(n,"Malformed LSTAT packet");n._debug&&n._debug(`SFTP: Inbound: Received LSTAT (id:${e})`),n.emit("LSTAT",e,r)||n.status(e,et.OP_UNSUPPORTED)},[Be.FSTAT]:(n,t)=>{k.init(t,1);let e=k.readUInt32BE(),r=k.readString();if(k.clear(),r===void 0||r.length>256)return it(n,"Malformed FSTAT packet");n._debug&&n._debug(`SFTP: Inbound: Received FSTAT (id:${e})`),n.emit("FSTAT",e,r)||n.status(e,et.OP_UNSUPPORTED)},[Be.SETSTAT]:(n,t)=>{k.init(t,1);let e=k.readUInt32BE(),r=k.readString(!0),i=xr(n._biOpt);if(k.clear(),i===void 0)return it(n,"Malformed SETSTAT packet");n._debug&&n._debug(`SFTP: Inbound: Received SETSTAT (id:${e})`),n.emit("SETSTAT",e,r,i)||n.status(e,et.OP_UNSUPPORTED)},[Be.FSETSTAT]:(n,t)=>{k.init(t,1);let e=k.readUInt32BE(),r=k.readString(),i=xr(n._biOpt);if(k.clear(),i===void 0||r.length>256)return it(n,"Malformed FSETSTAT packet");n._debug&&n._debug(`SFTP: Inbound: Received FSETSTAT (id:${e})`),n.emit("FSETSTAT",e,r,i)||n.status(e,et.OP_UNSUPPORTED)},[Be.OPENDIR]:(n,t)=>{k.init(t,1);let e=k.readUInt32BE(),r=k.readString(!0);if(k.clear(),r===void 0)return it(n,"Malformed OPENDIR packet");n._debug&&n._debug(`SFTP: Inbound: Received OPENDIR (id:${e})`),n.emit("OPENDIR",e,r)||n.status(e,et.OP_UNSUPPORTED)},[Be.READDIR]:(n,t)=>{k.init(t,1);let e=k.readUInt32BE(),r=k.readString();if(k.clear(),r===void 0||r.length>256)return it(n,"Malformed READDIR packet");n._debug&&n._debug(`SFTP: Inbound: Received READDIR (id:${e})`),n.emit("READDIR",e,r)||n.status(e,et.OP_UNSUPPORTED)},[Be.REMOVE]:(n,t)=>{k.init(t,1);let e=k.readUInt32BE(),r=k.readString(!0);if(k.clear(),r===void 0)return it(n,"Malformed REMOVE packet");n._debug&&n._debug(`SFTP: Inbound: Received REMOVE (id:${e})`),n.emit("REMOVE",e,r)||n.status(e,et.OP_UNSUPPORTED)},[Be.MKDIR]:(n,t)=>{k.init(t,1);let e=k.readUInt32BE(),r=k.readString(!0),i=xr(n._biOpt);if(k.clear(),i===void 0)return it(n,"Malformed MKDIR packet");n._debug&&n._debug(`SFTP: Inbound: Received MKDIR (id:${e})`),n.emit("MKDIR",e,r,i)||n.status(e,et.OP_UNSUPPORTED)},[Be.RMDIR]:(n,t)=>{k.init(t,1);let e=k.readUInt32BE(),r=k.readString(!0);if(k.clear(),r===void 0)return it(n,"Malformed RMDIR packet");n._debug&&n._debug(`SFTP: Inbound: Received RMDIR (id:${e})`),n.emit("RMDIR",e,r)||n.status(e,et.OP_UNSUPPORTED)},[Be.REALPATH]:(n,t)=>{k.init(t,1);let e=k.readUInt32BE(),r=k.readString(!0);if(k.clear(),r===void 0)return it(n,"Malformed REALPATH packet");n._debug&&n._debug(`SFTP: Inbound: Received REALPATH (id:${e})`),n.emit("REALPATH",e,r)||n.status(e,et.OP_UNSUPPORTED)},[Be.STAT]:(n,t)=>{k.init(t,1);let e=k.readUInt32BE(),r=k.readString(!0);if(k.clear(),r===void 0)return it(n,"Malformed STAT packet");n._debug&&n._debug(`SFTP: Inbound: Received STAT (id:${e})`),n.emit("STAT",e,r)||n.status(e,et.OP_UNSUPPORTED)},[Be.RENAME]:(n,t)=>{k.init(t,1);let e=k.readUInt32BE(),r=k.readString(!0),i=k.readString(!0);if(k.clear(),i===void 0)return it(n,"Malformed RENAME packet");n._debug&&n._debug(`SFTP: Inbound: Received RENAME (id:${e})`),n.emit("RENAME",e,r,i)||n.status(e,et.OP_UNSUPPORTED)},[Be.READLINK]:(n,t)=>{k.init(t,1);let e=k.readUInt32BE(),r=k.readString(!0);if(k.clear(),r===void 0)return it(n,"Malformed READLINK packet");n._debug&&n._debug(`SFTP: Inbound: Received READLINK (id:${e})`),n.emit("READLINK",e,r)||n.status(e,et.OP_UNSUPPORTED)},[Be.SYMLINK]:(n,t)=>{k.init(t,1);let e=k.readUInt32BE(),r=k.readString(!0),i=k.readString(!0);if(k.clear(),i===void 0)return it(n,"Malformed SYMLINK packet");n._debug&&n._debug(`SFTP: Inbound: Received SYMLINK (id:${e})`);let s;n._isOpenSSH?s=n.emit("SYMLINK",e,i,r):s=n.emit("SYMLINK",e,r,i),s||n.status(e,et.OP_UNSUPPORTED)},[Be.EXTENDED]:(n,t)=>{k.init(t,1);let e=k.readUInt32BE(),r=k.readString(!0);if(r===void 0)return k.clear(),it(n,"Malformed EXTENDED packet");let i;k.avail()&&(i=k.readRaw()),k.clear(),n._debug&&n._debug(`SFTP: Inbound: Received EXTENDED (id:${e})`),n.emit("EXTENDED",e,r,i)||n.status(e,et.OP_UNSUPPORTED)}},{ERR_INVALID_ARG_TYPE:Hd,ERR_OUT_OF_RANGE:ts,validateNumber:Fd}=mc(),kc=128,Mt,jo=[];function Md(n){jo.length>0?Mt=jo.pop():Mt=Buffer.allocUnsafe(n),Mt.used=0}function Vo(n,t){if(!Number.isSafeInteger(n))throw Fd(n,t),Number.isInteger(n)?new ts(t,">= 0 and <= 2 ** 53 - 1",n):new ts(t,"an integer",n);if(n<0)throw new ts(t,">= 0 and <= 2 ** 53 - 1",n)}function Wo(n){return n+7&-8}function Cn(n,t,e){if(e===void 0)e={};else if(typeof e=="string")e={encoding:e};else{if(e===null||typeof e!="object")throw new TypeError('"options" argument must be a string or an object');e=Object.create(e)}if(e.highWaterMark===void 0&&(e.highWaterMark=64*1024),e.emitClose=!1,e.autoDestroy=!1,Tc.call(this,e),this.path=t,this.flags=e.flags===void 0?"r":e.flags,this.mode=e.mode===void 0?438:e.mode,this.start=e.start,this.end=e.end,this.autoClose=e.autoClose===void 0?!0:e.autoClose,this.pos=0,this.bytesRead=0,this.isClosed=!1,this.handle=e.handle===void 0?null:e.handle,this.sftp=n,this._opening=!1,this.start!==void 0&&(Vo(this.start,"start"),this.pos=this.start),this.end===void 0)this.end=1/0;else if(this.end!==1/0&&(Vo(this.end,"end"),this.start!==void 0&&this.start>this.end))throw new ts("start",`<= "end" (here: ${this.end})`,this.start);this.on("end",function(){this.autoClose&&this.destroy()}),Buffer.isBuffer(this.handle)||this.open()}vc(Cn,Tc);Cn.prototype.open=function(){this._opening||(this._opening=!0,this.sftp.open(this.path,this.flags,this.mode,(n,t)=>{if(this._opening=!1,n){this.emit("error",n),this.autoClose&&this.destroy();return}this.handle=t,this.emit("open",t),this.emit("ready"),this.read()}))};Cn.prototype._read=function(n){if(!Buffer.isBuffer(this.handle))return this.once("open",()=>this._read(n));if(this.destroyed)return;(!Mt||Mt.length-Mt.used<kc)&&Md(this.readableHighWaterMark||this._readableState.highWaterMark);let t=Mt,e=Math.min(Mt.length-Mt.used,n),r=Mt.used;if(this.end!==void 0&&(e=Math.min(this.end-this.pos+1,e)),e<=0)return this.push(null);this.sftp.read(this.handle,Mt,Mt.used,e,this.pos,(i,s)=>{if(i){this.emit("error",i),this.autoClose&&this.destroy();return}let o=null;if(r+e===t.used&&t===Mt)t.used=Wo(t.used+s-e);else{let f=r+e&-8,a=Wo(r+s);f-a>=kc&&jo.push(t.slice(a,f))}s>0&&(this.bytesRead+=s,o=t.slice(r,r+s)),this.pos+=s,this.push(o)}),Mt.used=Wo(Mt.used+e)};Cn.prototype._destroy=function(n,t){if(this._opening&&!Buffer.isBuffer(this.handle)){this.once("open",Nc.bind(null,this,t,n));return}Nc(this,t,n),this.handle=null,this._opening=!1};function Nc(n,t,e){if(!n.handle)return r();n.sftp.close(n.handle,r);function r(i){i=i||e,t(i),n.isClosed=!0,i||n.emit("close")}}Cn.prototype.close=function(n){this.destroy(null,n)};Object.defineProperty(Cn.prototype,"pending",{get(){return this.handle===null},configurable:!0});function nn(n,t,e){if(e===void 0)e={};else if(typeof e=="string")e={encoding:e};else{if(e===null||typeof e!="object")throw new TypeError('"options" argument must be a string or an object');e=Object.create(e)}e.emitClose=!1,e.autoDestroy=!1,zo.call(this,e),this.path=t,this.flags=e.flags===void 0?"w":e.flags,this.mode=e.mode===void 0?438:e.mode,this.start=e.start,this.autoClose=e.autoClose===void 0?!0:e.autoClose,this.pos=0,this.bytesWritten=0,this.isClosed=!1,this.handle=e.handle===void 0?null:e.handle,this.sftp=n,this._opening=!1,this.start!==void 0&&(Vo(this.start,"start"),this.pos=this.start),e.encoding&&this.setDefaultEncoding(e.encoding),this.on("finish",function(){this._writableState.finalCalled||this.autoClose&&this.destroy()}),Buffer.isBuffer(this.handle)||this.open()}vc(nn,zo);nn.prototype._final=function(n){this.autoClose&&this.destroy(),n()};nn.prototype.open=function(){this._opening||(this._opening=!0,this.sftp.open(this.path,this.flags,this.mode,(n,t)=>{if(this._opening=!1,n){this.emit("error",n),this.autoClose&&this.destroy();return}this.handle=t;let e=r=>{if(r){this.sftp.chmod(this.path,this.mode,i=>e());return}if(this.flags[0]==="a"){let i=(s,o)=>{if(s){this.sftp.stat(this.path,(f,a)=>{if(f){this.destroy(),this.emit("error",s);return}i(null,a)});return}this.pos=o.size,this.emit("open",t),this.emit("ready")};this.sftp.fstat(t,i);return}this.emit("open",t),this.emit("ready")};this.sftp.fchmod(t,this.mode,e)}))};nn.prototype._write=function(n,t,e){if(!Buffer.isBuffer(n)){let r=new Hd("data","Buffer",n);return this.emit("error",r)}if(!Buffer.isBuffer(this.handle))return this.once("open",function(){this._write(n,t,e)});this.sftp.write(this.handle,n,0,n.length,this.pos,(r,i)=>{if(r)return this.autoClose&&this.destroy(),e(r);this.bytesWritten+=i,e()}),this.pos+=n.length};nn.prototype._writev=function(n,t){if(!Buffer.isBuffer(this.handle))return this.once("open",function(){this._writev(n,t)});let e=this.sftp,r=this.handle,i=n.length,s=(o,f)=>{if(o)return this.destroy(),t(o);this.bytesWritten+=f,--i===0&&t()};for(let o=0;o<n.length;++o){let f=n[o].chunk;e.write(r,f,0,f.length,this.pos,s),this.pos+=f.length}};typeof zo.prototype.destroy!="function"&&(nn.prototype.destroy=Cn.prototype.destroy);nn.prototype._destroy=Cn.prototype._destroy;nn.prototype.close=function(n){if(n){if(this.isClosed){process.nextTick(n);return}this.on("close",n)}this.autoClose||this.on("finish",this.destroy.bind(this)),this.end()};nn.prototype.destroySoon=nn.prototype.end;Object.defineProperty(nn.prototype,"pending",{get(){return this.handle===null},configurable:!0});Qc.exports={flagsToString:Ud,OPEN_MODE:we,SFTP:Yo,Stats:ns,STATUS_CODE:et,stringToFlags:Uc}});var sf=ze((sg,qc)=>{"use strict";var{Duplex:qd,Readable:Kd,Writable:Wd}=require("stream"),{CHANNEL_EXTENDED_DATATYPE:{STDERR:Hc}}=yn(),{bufferSlice:rs}=rn(),Gd=32*1024,ii=2*1024*1024,nf=ii/2,Zo=class extends Kd{constructor(t,e){super(e),this._channel=t}_read(t){this._channel._waitChanDrain&&(this._channel._waitChanDrain=!1,this._channel.incoming.window<=nf&&rf(this._channel))}},ef=class extends Wd{constructor(t){super({highWaterMark:ii}),this._channel=t}_write(t,e,r){let i=this._channel,s=i._client._protocol,o=i.outgoing,f=o.packetSize,a=o.id,u=o.window,h=t.length,l=0;if(o.state==="open"){for(;h-l>0&&u>0;){let A=h-l;A>u&&(A=u),A>f&&(A=f),l===0&&A===h?s.channelExtData(a,t,Hc):s.channelExtData(a,rs(t,l,l+A),Hc),l+=A,u-=A}if(o.window=u,h-l>0){u===0&&(i._waitWindow=!0),l>0?i._chunkErr=rs(t,l,h):i._chunkErr=t,i._chunkcbErr=r;return}r()}}},tf=class extends qd{constructor(t,e,r){let i={highWaterMark:ii,allowHalfOpen:!r||r&&r.allowHalfOpen!==!1,emitClose:!1};super(i),this.allowHalfOpen=i.allowHalfOpen;let s=!!(r&&r.server);this.server=s,this.type=e.type,this.subtype=void 0,this.incoming=e.incoming,this.outgoing=e.outgoing,this._callbacks=[],this._client=t,this._hasX11=!1,this._exit={code:void 0,signal:void 0,dump:void 0,desc:void 0},this.stdin=this.stdout=this,s?this.stderr=new ef(this):this.stderr=new Zo(this,i),this._waitWindow=!1,this._waitChanDrain=!1,this._chunk=void 0,this._chunkcb=void 0,this._chunkErr=void 0,this._chunkcbErr=void 0,this.on("finish",Fc).on("prefinish",Fc),this.on("end",Mc).on("close",Mc)}_read(t){this._waitChanDrain&&(this._waitChanDrain=!1,this.incoming.window<=nf&&rf(this))}_write(t,e,r){let i=this._client._protocol,s=this.outgoing,o=s.packetSize,f=s.id,a=s.window,u=t.length,h=0;if(s.state==="open"){for(;u-h>0&&a>0;){let l=u-h;l>a&&(l=a),l>o&&(l=o),h===0&&l===u?i.channelData(f,t):i.channelData(f,rs(t,h,h+l)),h+=l,a-=l}if(s.window=a,u-h>0){a===0&&(this._waitWindow=!0),h>0?this._chunk=rs(t,h,u):this._chunk=t,this._chunkcb=r;return}r()}}eof(){this.outgoing.state==="open"&&(this.outgoing.state="eof",this._client._protocol.channelEOF(this.outgoing.id))}close(){(this.outgoing.state==="open"||this.outgoing.state==="eof")&&(this.outgoing.state="closing",this._client._protocol.channelClose(this.outgoing.id))}destroy(){return this.end(),this.close(),this}setWindow(t,e,r,i){if(this.server)throw new Error("Client-only method called in server mode");this.type==="session"&&(this.subtype==="shell"||this.subtype==="exec")&&this.writable&&this.outgoing.state==="open"&&this._client._protocol.windowChange(this.outgoing.id,t,e,r,i)}signal(t){if(this.server)throw new Error("Client-only method called in server mode");this.type==="session"&&this.writable&&this.outgoing.state==="open"&&this._client._protocol.signal(this.outgoing.id,t)}exit(t,e,r){if(!this.server)throw new Error("Server-only method called in client mode");this.type==="session"&&this.writable&&this.outgoing.state==="open"&&(typeof t=="number"?this._client._protocol.exitStatus(this.outgoing.id,t):this._client._protocol.exitSignal(this.outgoing.id,t,e,r))}};function Fc(){this.eof(),(this.server||!this.allowHalfOpen)&&this.close(),this.writable=!1}function Mc(){this.readable=!1}function rf(n){if(n.outgoing.state==="closed")return;let t=ii-n.incoming.window;t<=0||(n.incoming.window+=t,n._client._protocol.channelWindowAdjust(n.outgoing.id,t))}qc.exports={Channel:tf,MAX_WINDOW:ii,PACKET_SIZE:Gd,windowAdjust:rf,WINDOW_THRESHOLD:nf}});var af=ze((og,Gc)=>{"use strict";var{SFTP:Yd}=ri(),si=2**32-1;function Kc(n,t,e,r){if(n._chanMgr.remove(t),typeof r!="function")return;let i;e instanceof Error?i=e:typeof e=="object"&&e!==null?(i=new Error(`(SSH) Channel open failure: ${e.description}`),i.reason=e.reason):(i=new Error("(SSH) Channel open failure: server closed channel unexpectedly"),i.reason=""),r(i)}function Wc(n,t,e,r,i){if(typeof e=="function"){Kc(n,t,r,e);return}if(typeof e!="object"||e===null||e.incoming&&e.incoming.state==="closed"||(n._chanMgr.remove(t),e.server&&e.constructor.name==="Session"))return;e.incoming.state="closed",e.readable&&e.push(null),e.server?e.stderr.writable&&e.stderr.end():e.stderr.readable&&e.stderr.push(null),e.constructor!==Yd&&(e.outgoing.state==="open"||e.outgoing.state==="eof")&&!i&&e.close(),e.outgoing.state==="closing"&&(e.outgoing.state="closed");let s=e._readableState,o=e._writableState;o&&!o.ending&&!o.finished&&!i&&e.end();let f=e._callbacks;e._callbacks=[];for(let a=0;a<f.length;++a)f[a](!0);if(e.server)!e.readable||e.destroyed||s&&s.endEmitted?e.emit("close"):e.once("end",()=>e.emit("close"));else{let a;switch(e.type){case"direct-streamlocal@openssh.com":case"direct-tcpip":a=()=>e.emit("close");break;default:{let h=e._exit;a=()=>{h.code===null?e.emit("close",h.code,h.signal,h.dump,h.desc):e.emit("close",h.code)}}}!e.readable||e.destroyed||s&&s.endEmitted?a():e.once("end",a);let u=e.stderr._readableState;!e.stderr.readable||e.stderr.destroyed||u&&u.endEmitted?e.stderr.emit("close"):e.stderr.once("end",()=>e.stderr.emit("close"))}}var ff=class{constructor(t){this._client=t,this._channels={},this._cur=-1,this._count=0}add(t){let e;if(this._cur<si)e=++this._cur;else if(this._count===0)this._cur=0,e=0;else{let r=this._channels;for(let i=0;i<si;++i)if(r[i]===void 0){e=i;break}}return e===void 0?-1:(this._channels[e]=t||!0,++this._count,e)}update(t,e){if(typeof t!="number"||t<0||t>=si||!isFinite(t))throw new Error(`Invalid channel id: ${t}`);e&&this._channels[t]&&(this._channels[t]=e)}get(t){if(typeof t!="number"||t<0||t>=si||!isFinite(t))throw new Error(`Invalid channel id: ${t}`);return this._channels[t]}remove(t){if(typeof t!="number"||t<0||t>=si||!isFinite(t))throw new Error(`Invalid channel id: ${t}`);this._channels[t]&&(delete this._channels[t],this._count&&--this._count)}cleanup(t){let e=this._channels;this._channels={},this._cur=-1,this._count=0;let r=Object.keys(e),i=this._client;for(let s=0;s<r.length;++s){let o=+r[s],f=e[o];Wc(i,o,f._channel||f,t,!0)}}},of=(()=>{let n=Object.prototype.toString;return t=>n.call(t)==="[object RegExp]"})();function $d(n,t,e){if(Array.isArray(n)&&n.length>0){for(let r=0;r<n.length;++r)if(e.indexOf(n[r])===-1)throw new Error(`Unsupported algorithm: ${n[r]}`);return n}if(typeof n=="object"&&n!==null){let r=Object.keys(n),i=t;for(let s=0;s<r.length;++s){let o=r[s],f=n[o];switch(o){case"append":if(Array.isArray(f)||(f=[f]),Array.isArray(f))for(let a=0;a<f.length;++a){let u=f[a];if(typeof u=="string"){if(!u||i.indexOf(u)!==-1)continue;if(e.indexOf(u)===-1)throw new Error(`Unsupported algorithm: ${u}`);i===t&&(i=i.slice()),i.push(u)}else if(of(u))for(let h=0;h<e.length;++h){let l=e[h];if(u.test(l)){if(i.indexOf(l)!==-1)continue;i===t&&(i=i.slice()),i.push(l)}}}break;case"prepend":if(Array.isArray(f)||(f=[f]),Array.isArray(f))for(let a=f.length;a>=0;--a){let u=f[a];if(typeof u=="string"){if(!u||i.indexOf(u)!==-1)continue;if(e.indexOf(u)===-1)throw new Error(`Unsupported algorithm: ${u}`);i===t&&(i=i.slice()),i.unshift(u)}else if(of(u))for(let h=e.length;h>=0;--h){let l=e[h];if(u.test(l)){if(i.indexOf(l)!==-1)continue;i===t&&(i=i.slice()),i.unshift(l)}}}break;case"remove":if(Array.isArray(f)||(f=[f]),Array.isArray(f))for(let a=0;a<f.length;++a){let u=f[a];if(typeof u=="string"){if(!u)continue;let h=i.indexOf(u);if(h===-1)continue;i===t&&(i=i.slice()),i.splice(h,1)}else if(of(u))for(let h=0;h<i.length;++h)u.test(i[h])&&(i===t&&(i=i.slice()),i.splice(h,1),--h)}break}}return i}return t}Gc.exports={ChannelManager:ff,generateAlgorithmList:$d,onChannelOpenFailure:Kc,onCHANNEL_CLOSE:Wc,isWritable:n=>n&&n.writable&&n._readableState&&n._readableState.ended===!1}});var df=ze((fg,du)=>{"use strict";var{createHash:Xd,getHashes:jd,randomFillSync:Vd}=require("crypto"),{Socket:zd}=require("net"),{lookup:Jd}=require("dns"),Zd=require("events"),e0=jd(),{COMPAT:uu,CHANNEL_EXTENDED_DATATYPE:{STDERR:t0},CHANNEL_OPEN_FAILURE:oi,DEFAULT_CIPHER:Yc,DEFAULT_COMPRESSION:$c,DEFAULT_KEX:Xc,DEFAULT_MAC:jc,DEFAULT_SERVER_HOST_KEY:Vc,DISCONNECT_REASON:zc,DISCONNECT_REASON_BY_VALUE:n0,SUPPORTED_CIPHER:r0,SUPPORTED_COMPRESSION:i0,SUPPORTED_KEX:s0,SUPPORTED_MAC:o0,SUPPORTED_SERVER_HOST_KEY:f0}=yn(),{init:a0}=Nn(),c0=qo(),{parseKey:os}=Ln(),{SFTP:u0}=ri(),{bufferCopy:Jc,makeBufferParser:hu,makeError:h0,readUInt32BE:l0,sigSSHToASN1:d0,writeUInt32BE:cf}=rn(),{AgentContext:Zc,createAgent:eu,isAgent:tu}=Bo(),{Channel:lu,MAX_WINDOW:fs,PACKET_SIZE:as,windowAdjust:nu,WINDOW_THRESHOLD:ru}=sf(),{ChannelManager:A0,generateAlgorithmList:fi,isWritable:mt,onChannelOpenFailure:g0,onCHANNEL_CLOSE:E0}=af(),is=hu(),ss=hu(),ai=/^OpenSSH_(?:(?![0-4])\d)|(?:\d{2,})/,hf=n=>{},lf=class extends Zd{constructor(){super(),this.config={host:void 0,port:void 0,localAddress:void 0,localPort:void 0,forceIPv4:void 0,forceIPv6:void 0,keepaliveCountMax:void 0,keepaliveInterval:void 0,readyTimeout:void 0,ident:void 0,username:void 0,password:void 0,privateKey:void 0,tryKeyboard:void 0,agent:void 0,allowAgentFwd:void 0,authHandler:void 0,hostHashAlgo:void 0,hostHashCb:void 0,strictVendor:void 0,debug:void 0},this._agent=void 0,this._readyTimeout=void 0,this._chanMgr=void 0,this._callbacks=void 0,this._forwarding=void 0,this._forwardingUnix=void 0,this._acceptX11=void 0,this._agentFwdEnabled=void 0,this._remoteVer=void 0,this._protocol=void 0,this._sock=void 0,this._resetKA=void 0}connect(t){if(this._sock&&mt(this._sock))return this.once("close",()=>{this.connect(t)}),this.end(),this;this.config.host=t.hostname||t.host||"localhost",this.config.port=t.port||22,this.config.localAddress=typeof t.localAddress=="string"?t.localAddress:void 0,this.config.localPort=typeof t.localPort=="string"||typeof t.localPort=="number"?t.localPort:void 0,this.config.forceIPv4=t.forceIPv4||!1,this.config.forceIPv6=t.forceIPv6||!1,this.config.keepaliveCountMax=typeof t.keepaliveCountMax=="number"&&t.keepaliveCountMax>=0?t.keepaliveCountMax:3,this.config.keepaliveInterval=typeof t.keepaliveInterval=="number"&&t.keepaliveInterval>0?t.keepaliveInterval:0,this.config.readyTimeout=typeof t.readyTimeout=="number"&&t.readyTimeout>=0?t.readyTimeout:2e4,this.config.ident=typeof t.ident=="string"||Buffer.isBuffer(t.ident)?t.ident:void 0;let e={kex:void 0,serverHostKey:void 0,cs:{cipher:void 0,mac:void 0,compress:void 0,lang:[]},sc:void 0},r=!0;if(typeof t.algorithms=="object"&&t.algorithms!==null&&(e.kex=fi(t.algorithms.kex,Xc,s0),e.kex!==Xc&&(r=!1),e.serverHostKey=fi(t.algorithms.serverHostKey,Vc,f0),e.serverHostKey!==Vc&&(r=!1),e.cs.cipher=fi(t.algorithms.cipher,Yc,r0),e.cs.cipher!==Yc&&(r=!1),e.cs.mac=fi(t.algorithms.hmac,jc,o0),e.cs.mac!==jc&&(r=!1),e.cs.compress=fi(t.algorithms.compress,$c,i0),e.cs.compress!==$c&&(r=!1),r||(e.sc=e.cs)),typeof t.username=="string")this.config.username=t.username;else if(typeof t.user=="string")this.config.username=t.user;else throw new Error("Invalid username");this.config.password=typeof t.password=="string"?t.password:void 0,this.config.privateKey=typeof t.privateKey=="string"||Buffer.isBuffer(t.privateKey)?t.privateKey:void 0,this.config.localHostname=typeof t.localHostname=="string"?t.localHostname:void 0,this.config.localUsername=typeof t.localUsername=="string"?t.localUsername:void 0,this.config.tryKeyboard=t.tryKeyboard===!0,typeof t.agent=="string"&&t.agent.length?this.config.agent=eu(t.agent):tu(t.agent)?this.config.agent=t.agent:this.config.agent=void 0,this.config.allowAgentFwd=t.agentForward===!0&&this.config.agent!==void 0;let i=this.config.authHandler=typeof t.authHandler=="function"||Array.isArray(t.authHandler)?t.authHandler:void 0;this.config.strictVendor=typeof t.strictVendor=="boolean"?t.strictVendor:!0;let s=this.config.debug=typeof t.debug=="function"?t.debug:void 0;if(t.agentForward===!0&&!this.config.allowAgentFwd)throw new Error("You must set a valid agent path to allow agent forwarding");let o=this._callbacks=[];this._chanMgr=new A0(this),this._forwarding={},this._forwardingUnix={},this._acceptX11=0,this._agentFwdEnabled=!1,this._agent=this.config.agent?this.config.agent:void 0,this._remoteVer=void 0;let f;if(this.config.privateKey){if(f=os(this.config.privateKey,t.passphrase),f instanceof Error)throw new Error(`Cannot parse privateKey: ${f.message}`);if(Array.isArray(f)&&(f=f[0]),f.getPrivatePEM()===null)throw new Error("privateKey value does not contain a (valid) private key")}let a;if(typeof t.hostVerifier=="function"){let T=t.hostVerifier,M;e0.indexOf(t.hostHash)!==-1&&(M=Xd(t.hostHash)),a=(F,V)=>{M&&(M.update(F),F=M.digest("hex"));let Ae=T(F,V);Ae!==void 0&&V(Ae)}}let u=this._sock=t.sock||new zd,h=!1,l=!1;this._protocol&&this._protocol.cleanup();let A=s?(T,M,F)=>{s(`Debug output from server: ${JSON.stringify(F)}`)}:void 0,_,x=this._protocol=new c0({ident:this.config.ident,offer:r?void 0:e,onWrite:T=>{mt(u)&&u.write(T)},onError:T=>{T.level==="handshake"&&clearTimeout(this._readyTimeout),x._destruct||u.removeAllListeners("data"),this.emit("error",T);try{u.end()}catch{}},onHeader:T=>{l=!0,this._remoteVer=T.versions.software,T.greeting&&this.emit("greeting",T.greeting)},onHandshakeComplete:T=>{this.emit("handshake",T),h||(h=!0,x.service("ssh-userauth"))},debug:s,hostVerifier:a,messageHandlers:{DEBUG:A,DISCONNECT:(T,M,F)=>{if(M!==zc.BY_APPLICATION){F||(F=n0[M],F===void 0&&(F=`Unexpected disconnection reason: ${M}`));let V=new Error(F);V.code=M,this.emit("error",V)}u.end()},SERVICE_ACCEPT:(T,M)=>{M==="ssh-userauth"&&Z()},EXT_INFO:(T,M)=>{if(_===void 0){for(let F of M)if(F.name==="server-sig-algs"){_=F.algs;return}_=null}},USERAUTH_BANNER:(T,M)=>{this.emit("banner",M)},USERAUTH_SUCCESS:T=>{L(),clearTimeout(this._readyTimeout),this.emit("ready")},USERAUTH_FAILURE:(T,M,F)=>{if(y.keyAlgos){let V=y.keyAlgos[0][0];if(s&&s(`Client: ${y.type} (${V}) auth failed`),y.keyAlgos.shift(),y.keyAlgos.length){let[Ae,pe]=y.keyAlgos[0];switch(y.type){case"agent":x.authPK(y.username,y.agentCtx.currentKey(),Ae);return;case"publickey":x.authPK(y.username,y.key,Ae);return;case"hostbased":x.authHostbased(y.username,y.key,y.localHostname,y.localUsername,Ae,(Ee,dt)=>{let vt=y.key.sign(Ee,pe);if(vt instanceof Error)return vt.message=`Error while signing with key: ${vt.message}`,vt.level="client-authentication",this.emit("error",vt),Z();dt(vt)});return}}else y.keyAlgos=void 0}if(y.type==="agent"){let V=y.agentCtx.pos();return s&&s(`Client: Agent key #${V+1} failed`),re()}s&&s(`Client: ${y.type} auth failed`),S=F,O=M,Z()},USERAUTH_PASSWD_CHANGEREQ:(T,M)=>{y.type==="password"&&this.emit("change password",M,F=>{x.authPassword(this.config.username,this.config.password,F)})},USERAUTH_PK_OK:T=>{let M,F;if(y.keyAlgos&&([M,F]=y.keyAlgos[0]),y.type==="agent"){let V=y.agentCtx.currentKey();x.authPK(y.username,V,M,(Ae,pe)=>{let Ee={hash:F};y.agentCtx.sign(V,Ae,Ee,(dt,vt)=>{if(dt)dt.level="agent",this.emit("error",dt);else return pe(vt);re()})})}else y.type==="publickey"&&x.authPK(y.username,y.key,M,(V,Ae)=>{let pe=y.key.sign(V,F);if(pe instanceof Error)return pe.message=`Error signing data with key: ${pe.message}`,pe.level="client-authentication",this.emit("error",pe),Z();Ae(pe)})},USERAUTH_INFO_REQUEST:(T,M,F,V)=>{if(y.type==="keyboard-interactive"){if((Array.isArray(V)?V.length:0)===0){s&&s("Client: Sending automatic USERAUTH_INFO_RESPONSE"),x.authInfoRes();return}y.prompt(M,F,"",V,pe=>{x.authInfoRes(pe)})}},REQUEST_SUCCESS:(T,M)=>{o.length&&o.shift()(!1,M)},REQUEST_FAILURE:T=>{o.length&&o.shift()(!0)},GLOBAL_REQUEST:(T,M,F,V)=>{switch(M){case"hostkeys-00@openssh.com":x0(this,V,(Ae,pe)=>{Ae||this.emit("hostkeys",pe)}),F&&x.requestSuccess();break;default:F&&x.requestFailure()}},CHANNEL_OPEN:(T,M)=>{b0(this,M)},CHANNEL_OPEN_CONFIRMATION:(T,M)=>{let F=this._chanMgr.get(M.recipient);if(typeof F!="function")return;let V=F.type==="sftp",pe={type:V?"session":F.type,incoming:{id:M.recipient,window:fs,packetSize:as,state:"open"},outgoing:{id:M.sender,window:M.window,packetSize:M.packetSize,state:"open"}},Ee=V?new u0(this,pe,{debug:s}):new lu(this,pe);this._chanMgr.update(M.recipient,Ee),F(void 0,Ee)},CHANNEL_OPEN_FAILURE:(T,M,F,V)=>{let Ae=this._chanMgr.get(M);if(typeof Ae!="function")return;g0(this,M,{reason:F,description:V},Ae)},CHANNEL_DATA:(T,M,F)=>{let V=this._chanMgr.get(M);if(!(typeof V!="object"||V===null)&&V.incoming.window!==0){if(V.incoming.window-=F.length,V.push(F)===!1){V._waitChanDrain=!0;return}V.incoming.window<=ru&&nu(V)}},CHANNEL_EXTENDED_DATA:(T,M,F,V)=>{if(V!==t0)return;let Ae=this._chanMgr.get(M);if(!(typeof Ae!="object"||Ae===null)&&Ae.incoming.window!==0){if(Ae.incoming.window-=F.length,!Ae.stderr.push(F)){Ae._waitChanDrain=!0;return}Ae.incoming.window<=ru&&nu(Ae)}},CHANNEL_WINDOW_ADJUST:(T,M,F)=>{let V=this._chanMgr.get(M);typeof V!="object"||V===null||(V.outgoing.window+=F,V._waitWindow&&(V._waitWindow=!1,V._chunk?V._write(V._chunk,null,V._chunkcb):V._chunkcb?V._chunkcb():V._chunkErr?V.stderr._write(V._chunkErr,null,V._chunkcbErr):V._chunkcbErr&&V._chunkcbErr()))},CHANNEL_SUCCESS:(T,M)=>{let F=this._chanMgr.get(M);typeof F!="object"||F===null||(this._resetKA(),F._callbacks.length&&F._callbacks.shift()(!1))},CHANNEL_FAILURE:(T,M)=>{let F=this._chanMgr.get(M);typeof F!="object"||F===null||(this._resetKA(),F._callbacks.length&&F._callbacks.shift()(!0))},CHANNEL_REQUEST:(T,M,F,V,Ae)=>{let pe=this._chanMgr.get(M);if(typeof pe!="object"||pe===null)return;let Ee=pe._exit;if(Ee.code===void 0){switch(F){case"exit-status":pe.emit("exit",Ee.code=Ae);return;case"exit-signal":pe.emit("exit",Ee.code=null,Ee.signal=`SIG${Ae.signal}`,Ee.dump=Ae.coreDumped,Ee.desc=Ae.errorMessage);return}V&&T.channelFailure(pe.outgoing.id)}},CHANNEL_EOF:(T,M)=>{let F=this._chanMgr.get(M);typeof F!="object"||F===null||F.incoming.state==="open"&&(F.incoming.state="eof",F.readable&&F.push(null),F.stderr.readable&&F.stderr.push(null))},CHANNEL_CLOSE:(T,M)=>{E0(this,M,this._chanMgr.get(M))}}});u.pause();let b=this.config.keepaliveInterval,w=this.config.keepaliveCountMax,C=0,v,X=()=>{if(++C>w){if(clearInterval(v),u.readable){let T=new Error("Keepalive timeout");T.level="client-timeout",this.emit("error",T),u.destroy()}return}mt(u)?(o.push(L),x.ping()):clearInterval(v)};function L(){b>0&&(C=0,clearInterval(v),mt(u)&&(v=setInterval(X,b)))}this._resetKA=L;let z=(()=>{let T=!1;return()=>{if(!T&&(T=!0,J&&!l)){let M=h0("Connection lost before handshake","protocol",!0);this.emit("error",M)}}})(),ne=(()=>{let T=!1;return()=>{T||(T=!0,J=!0,s&&s("Socket connected"),this.emit("connect"),a0.then(()=>{x.start(),u.on("data",M=>{try{x.parse(M,0,M.length)}catch(F){this.emit("error",F);try{mt(u)&&u.end()}catch{}}}),u.stderr&&typeof u.stderr.resume=="function"&&u.stderr.resume(),u.resume()}).catch(M=>{this.emit("error",M);try{mt(u)&&u.end()}catch{}}))}})(),J=!1;u.on("connect",ne).on("timeout",()=>{this.emit("timeout")}).on("error",T=>{s&&s(`Socket error: ${T.message}`),clearTimeout(this._readyTimeout),T.level="client-socket",this.emit("error",T)}).on("end",()=>{s&&s("Socket ended"),z(),x.cleanup(),clearTimeout(this._readyTimeout),clearInterval(v),this.emit("end")}).on("close",()=>{s&&s("Socket closed"),z(),x.cleanup(),clearTimeout(this._readyTimeout),clearInterval(v),this.emit("close");let T=o;o=this._callbacks=[];let M=new Error("No response from server");for(let F=0;F<T.length;++F)T[F](M);this._chanMgr.cleanup(M)});let y,S=null,O=null,q=["none"];this.config.password!==void 0&&q.push("password"),f!==void 0&&q.push("publickey"),this._agent!==void 0&&q.push("agent"),this.config.tryKeyboard&&q.push("keyboard-interactive"),f!==void 0&&this.config.localHostname!==void 0&&this.config.localUsername!==void 0&&q.push("hostbased"),Array.isArray(i)?i=cu(i):typeof i!="function"&&(i=cu(q));let H=!1,se=T=>{if(!H){if(H=!0,T===!1){let M=new Error("All configured authentication methods failed");M.level="client-authentication",this.emit("error",M),this.end();return}if(typeof T=="string"){let M=T;if(q.indexOf(M)===-1)return te(`Authentication method not allowed: ${M}`);let F=this.config.username;switch(M){case"password":T={type:M,username:F,password:this.config.password};break;case"publickey":T={type:M,username:F,key:f};break;case"hostbased":T={type:M,username:F,key:f,localHostname:this.config.localHostname,localUsername:this.config.localUsername};break;case"agent":T={type:M,username:F,agentCtx:new Zc(this._agent)};break;case"keyboard-interactive":T={type:M,username:F,prompt:(...V)=>this.emit("keyboard-interactive",...V)};break;case"none":T={type:M,username:F};break;default:return te(`Skipping unsupported authentication method: ${T}`)}}else{if(typeof T!="object"||T===null)return te(`Skipping invalid authentication attempt: ${T}`);{let M=T.username;if(typeof M!="string")return te(`Skipping invalid authentication attempt: ${T}`);let F=T.type;switch(F){case"password":{let{password:V}=T;if(typeof V!="string"&&!Buffer.isBuffer(V))return te("Skipping invalid password auth attempt");T={type:F,username:M,password:V};break}case"publickey":{let V=os(T.key,T.passphrase);if(V instanceof Error)return te("Skipping invalid key auth attempt");if(!V.isPrivateKey())return te("Skipping non-private key");T={type:F,username:M,key:V};break}case"hostbased":{let{localHostname:V,localUsername:Ae}=T,pe=os(T.key,T.passphrase);if(pe instanceof Error||typeof V!="string"||typeof Ae!="string")return te("Skipping invalid hostbased auth attempt");if(!pe.isPrivateKey())return te("Skipping non-private key");T={type:F,username:M,key:pe,localHostname:V,localUsername:Ae};break}case"agent":{let V=T.agent;if(typeof V=="string"&&V.length)V=eu(V);else if(!tu(V))return te(`Skipping invalid agent: ${T.agent}`);T={type:F,username:M,agentCtx:new Zc(V)};break}case"keyboard-interactive":{let{prompt:V}=T;if(typeof V!="function")return te("Skipping invalid keyboard-interactive auth attempt");T={type:F,username:M,prompt:V};break}case"none":T={type:F,username:M};break;default:return te(`Skipping unsupported authentication method: ${T}`)}}}y=T;try{let M=y.username;switch(y.type){case"password":x.authPassword(M,y.password);break;case"publickey":{let F;if(y.keyAlgos=uf(this,y.key,_),y.keyAlgos)if(y.keyAlgos.length)F=y.keyAlgos[0][0];else return te("Skipping key authentication (no mutual hash algorithm)");x.authPK(M,y.key,F);break}case"hostbased":{let F,V;if(y.keyAlgos=uf(this,y.key,_),y.keyAlgos)if(y.keyAlgos.length)[F,V]=y.keyAlgos[0];else return te("Skipping hostbased authentication (no mutual hash algorithm)");x.authHostbased(M,y.key,y.localHostname,y.localUsername,F,(Ae,pe)=>{let Ee=y.key.sign(Ae,V);if(Ee instanceof Error)return Ee.message=`Error while signing with key: ${Ee.message}`,Ee.level="client-authentication",this.emit("error",Ee),Z();pe(Ee)});break}case"agent":y.agentCtx.init(F=>{if(F)return F.level="agent",this.emit("error",F),Z();re()});break;case"keyboard-interactive":x.authKeyboard(M);break;case"none":x.authNone(M);break}}finally{H=!1}}};function te(T){s&&s(T),process.nextTick(Z)}function Z(){H=!1;let T=i(O,S,se);H||T===void 0||se(T)}let re=()=>{if(y.type==="agent"){let T=y.agentCtx.nextKey();if(T===!1)s&&s("Agent: No more keys left to try"),s&&s("Client: agent auth failed"),Z();else{let M=y.agentCtx.pos(),F;if(y.keyAlgos=uf(this,T,_),y.keyAlgos)if(y.keyAlgos.length)F=y.keyAlgos[0][0];else{s&&s(`Agent: Skipping key #${M+1} (no mutual hash algorithm)`),re();return}s&&s(`Agent: Trying key #${M+1}`),x.authPK(y.username,T,F)}}},oe=()=>{this.config.readyTimeout>0&&(this._readyTimeout=setTimeout(()=>{let T=new Error("Timed out while waiting for handshake");T.level="client-timeout",this.emit("error",T),u.destroy()},this.config.readyTimeout))};if(t.sock)oe(),typeof u.connecting=="boolean"&&u.connecting||ne();else{let T=this.config.host,M=this.config.forceIPv4,F=this.config.forceIPv6;s&&s(`Client: Trying ${T} on port ${this.config.port} ...`);let V=()=>{oe(),u.connect({host:T,port:this.config.port,localAddress:this.config.localAddress,localPort:this.config.localPort}),u.setMaxListeners(0),u.setTimeout(typeof t.timeout=="number"?t.timeout:0)};!M&&!F||M&&F?V():Jd(T,M?4:6,(Ae,pe,Ee)=>{if(Ae){let dt=M?"IPv4":"IPv6",vt=new Error(`Error while looking up ${dt} address for '${T}': ${Ae}`);clearTimeout(this._readyTimeout),vt.level="client-dns",this.emit("error",vt),this.emit("close");return}T=pe,V()})}return this}end(){return this._sock&&mt(this._sock)&&(this._protocol.disconnect(zc.BY_APPLICATION),this._sock.end()),this}destroy(){return this._sock&&mt(this._sock)&&this._sock.destroy(),this}exec(t,e,r){if(!this._sock||!mt(this._sock))throw new Error("Not connected");typeof e=="function"&&(r=e,e={});let i={allowHalfOpen:e.allowHalfOpen!==!1};return Sr(this,"session",i,(s,o)=>{if(s){r(s);return}let f=[];function a(u){if(u){o.close(),r(u);return}f.length&&f.shift()()}(this.config.allowAgentFwd===!0||e&&e.agentForward===!0&&this._agent!==void 0)&&f.push(()=>ou(o,a)),typeof e=="object"&&e!==null&&(typeof e.env=="object"&&e.env!==null&&fu(o,e.env),(typeof e.pty=="object"&&e.pty!==null||e.pty===!0)&&f.push(()=>su(o,e.pty,a)),(typeof e.x11=="object"&&e.x11!==null||e.x11==="number"||e.x11===!0)&&f.push(()=>iu(o,e.x11,a))),f.push(()=>p0(o,t,e,r)),f.shift()()}),this}shell(t,e,r){if(!this._sock||!mt(this._sock))throw new Error("Not connected");return typeof t=="function"?(r=t,t=e=void 0):typeof e=="function"&&(r=e,e=void 0),t&&(t.x11!==void 0||t.env!==void 0)&&(e=t,t=void 0),Sr(this,"session",(i,s)=>{if(i){r(i);return}let o=[];function f(a){if(a){s.close(),r(a);return}o.length&&o.shift()()}(this.config.allowAgentFwd===!0||e&&e.agentForward===!0&&this._agent!==void 0)&&o.push(()=>ou(s,f)),t!==!1&&o.push(()=>su(s,t,f)),typeof e=="object"&&e!==null&&(typeof e.env=="object"&&e.env!==null&&fu(s,e.env),(typeof e.x11=="object"&&e.x11!==null||e.x11==="number"||e.x11===!0)&&o.push(()=>iu(s,e.x11,f))),o.push(()=>_0(s,r)),o.shift()()}),this}subsys(t,e){if(!this._sock||!mt(this._sock))throw new Error("Not connected");return Sr(this,"session",(r,i)=>{if(r){e(r);return}au(i,t,(s,o)=>{if(s){e(s);return}e(void 0,o)})}),this}forwardIn(t,e,r){if(!this._sock||!mt(this._sock))throw new Error("Not connected");let i=typeof r=="function";return i&&this._callbacks.push((s,o)=>{if(s){r(s!==!0?s:new Error(`Unable to bind to ${t}:${e}`));return}let f=e;e===0&&o&&o.length>=4&&(f=l0(o,0),this._protocol._compatFlags&uu.DYN_RPORT_BUG||(e=f)),this._forwarding[`${t}:${e}`]=f,r(void 0,f)}),this._protocol.tcpipForward(t,e,i),this}unforwardIn(t,e,r){if(!this._sock||!mt(this._sock))throw new Error("Not connected");let i=typeof r=="function";return i&&this._callbacks.push(s=>{if(s){r(s!==!0?s:new Error(`Unable to unbind from ${t}:${e}`));return}delete this._forwarding[`${t}:${e}`],r()}),this._protocol.cancelTcpipForward(t,e,i),this}forwardOut(t,e,r,i,s){if(!this._sock||!mt(this._sock))throw new Error("Not connected");let o={srcIP:t,srcPort:e,dstIP:r,dstPort:i};return typeof s!="function"&&(s=hf),Sr(this,"direct-tcpip",o,s),this}openssh_noMoreSessions(t){if(!this._sock||!mt(this._sock))throw new Error("Not connected");let e=typeof t=="function";return!this.config.strictVendor||this.config.strictVendor&&ai.test(this._remoteVer)?(e&&this._callbacks.push(r=>{if(r){t(r!==!0?r:new Error("Unable to disable future sessions"));return}t()}),this._protocol.openssh_noMoreSessions(e),this):e?(process.nextTick(t,new Error("strictVendor enabled and server is not OpenSSH or compatible version")),this):this}openssh_forwardInStreamLocal(t,e){if(!this._sock||!mt(this._sock))throw new Error("Not connected");let r=typeof e=="function";return!this.config.strictVendor||this.config.strictVendor&&ai.test(this._remoteVer)?(r&&this._callbacks.push(i=>{if(i){e(i!==!0?i:new Error(`Unable to bind to ${t}`));return}this._forwardingUnix[t]=!0,e()}),this._protocol.openssh_streamLocalForward(t,r),this):r?(process.nextTick(e,new Error("strictVendor enabled and server is not OpenSSH or compatible version")),this):this}openssh_unforwardInStreamLocal(t,e){if(!this._sock||!mt(this._sock))throw new Error("Not connected");let r=typeof e=="function";return!this.config.strictVendor||this.config.strictVendor&&ai.test(this._remoteVer)?(r&&this._callbacks.push(i=>{if(i){e(i!==!0?i:new Error(`Unable to unbind from ${t}`));return}delete this._forwardingUnix[t],e()}),this._protocol.openssh_cancelStreamLocalForward(t,r),this):r?(process.nextTick(e,new Error("strictVendor enabled and server is not OpenSSH or compatible version")),this):this}openssh_forwardOutStreamLocal(t,e){if(!this._sock||!mt(this._sock))throw new Error("Not connected");return typeof e!="function"&&(e=hf),!this.config.strictVendor||this.config.strictVendor&&ai.test(this._remoteVer)?(Sr(this,"direct-streamlocal@openssh.com",{socketPath:t},e),this):(process.nextTick(e,new Error("strictVendor enabled and server is not OpenSSH or compatible version")),this)}sftp(t){if(!this._sock||!mt(this._sock))throw new Error("Not connected");return Sr(this,"sftp",(e,r)=>{if(e){t(e);return}au(r,"sftp",(i,s)=>{if(i){t(i);return}function o(){r.removeListener("ready",f),r.removeListener("error",a),r.removeListener("exit",u),r.removeListener("close",u)}function f(){o(),t(void 0,r)}function a(h){o(),t(h)}function u(h,l){o();let A;typeof h=="number"?A=`Received exit code ${h} while establishing SFTP session`:l!==void 0?A=`Received signal ${l} while establishing SFTP session`:A="Received unexpected SFTP session termination";let _=new Error(A);_.code=h,_.signal=l,t(_)}r.on("ready",f).on("error",a).on("exit",u).on("close",u),r._init()})}),this}setNoDelay(t){return this._sock&&typeof this._sock.setNoDelay=="function"&&this._sock.setNoDelay(t),this}};function Sr(n,t,e,r){let i=fs,s=as;typeof e=="function"&&(r=e,e={});let o=(a,u)=>{r(a,u)};o.type=t;let f=n._chanMgr.add(o);if(f===-1){r(new Error("No free channels available"));return}switch(t){case"session":case"sftp":n._protocol.session(f,i,s);break;case"direct-tcpip":n._protocol.directTcpip(f,i,s,e);break;case"direct-streamlocal@openssh.com":n._protocol.openssh_directStreamLocal(f,i,s,e);break;default:throw new Error(`Unsupported channel type: ${t}`)}}function iu(n,t,e){let r={single:!1,protocol:"MIT-MAGIC-COOKIE-1",cookie:void 0,screen:0};typeof t=="function"?e=t:typeof t=="object"&&t!==null&&(typeof t.single=="boolean"&&(r.single=t.single),typeof t.screen=="number"&&(r.screen=t.screen),typeof t.protocol=="string"&&(r.protocol=t.protocol),typeof t.cookie=="string"?r.cookie=t.cookie:Buffer.isBuffer(t.cookie)&&(r.cookie=t.cookie.hexSlice(0,t.cookie.length))),r.cookie===void 0&&(r.cookie=I0());let i=typeof e=="function";if(n.outgoing.state!=="open"){i&&e(new Error("Channel is not open"));return}i&&n._callbacks.push(s=>{if(s){e(s!==!0?s:new Error("Unable to request X11"));return}n._hasX11=!0,++n._client._acceptX11,n.once("close",()=>{n._client._acceptX11&&--n._client._acceptX11}),e()}),n._client._protocol.x11Forward(n.outgoing.id,r,i)}function su(n,t,e){let r=24,i=80,s=640,o=480,f="vt100",a=null;typeof t=="function"?e=t:typeof t=="object"&&t!==null&&(typeof t.rows=="number"&&(r=t.rows),typeof t.cols=="number"&&(i=t.cols),typeof t.width=="number"&&(s=t.width),typeof t.height=="number"&&(o=t.height),typeof t.term=="string"&&(f=t.term),typeof t.modes=="object"&&(a=t.modes));let u=typeof e=="function";if(n.outgoing.state!=="open"){u&&e(new Error("Channel is not open"));return}u&&n._callbacks.push(h=>{if(h){e(h!==!0?h:new Error("Unable to request a pseudo-terminal"));return}e()}),n._client._protocol.pty(n.outgoing.id,r,i,o,s,f,a,u)}function ou(n,t){let e=typeof t=="function";if(n.outgoing.state!=="open"){e&&t(new Error("Channel is not open"));return}if(n._client._agentFwdEnabled){e&&t(!1);return}n._client._agentFwdEnabled=!0,n._callbacks.push(r=>{if(r){n._client._agentFwdEnabled=!1,e&&t(r!==!0?r:new Error("Unable to request agent forwarding"));return}e&&t()}),n._client._protocol.openssh_agentForward(n.outgoing.id,!0)}function _0(n,t){if(n.outgoing.state!=="open"){t(new Error("Channel is not open"));return}n._callbacks.push(e=>{if(e){t(e!==!0?e:new Error("Unable to open shell"));return}n.subtype="shell",t(void 0,n)}),n._client._protocol.shell(n.outgoing.id,!0)}function p0(n,t,e,r){if(n.outgoing.state!=="open"){r(new Error("Channel is not open"));return}n._callbacks.push(i=>{if(i){r(i!==!0?i:new Error("Unable to exec"));return}n.subtype="exec",n.allowHalfOpen=e.allowHalfOpen!==!1,r(void 0,n)}),n._client._protocol.exec(n.outgoing.id,t,!0)}function fu(n,t){if(n.outgoing.state!=="open")return;let e=Object.keys(t||{});for(let r=0;r<e.length;++r){let i=e[r],s=t[i];n._client._protocol.env(n.outgoing.id,i,s,!1)}}function au(n,t,e){if(n.outgoing.state!=="open"){e(new Error("Channel is not open"));return}n._callbacks.push(r=>{if(r){e(r!==!0?r:new Error(`Unable to start subsystem: ${t}`));return}n.subtype="subsystem",e(void 0,n)}),n._client._protocol.subsystem(n.outgoing.id,t,!0)}function b0(n,t){let e=-1,r,i=()=>{let a={type:t.type,incoming:{id:e,window:fs,packetSize:as,state:"open"},outgoing:{id:t.sender,window:t.window,packetSize:t.packetSize,state:"open"}},u=new lu(n,a);return n._chanMgr.update(e,u),n._protocol.channelOpenConfirm(t.sender,e,fs,as),u},s=()=>{r===void 0&&(e===-1?r=oi.RESOURCE_SHORTAGE:r=oi.CONNECT_FAILED),e!==-1&&n._chanMgr.remove(e),n._protocol.channelOpenFail(t.sender,r,"")},o=()=>(e=n._chanMgr.add(),e===-1&&(r=oi.RESOURCE_SHORTAGE,n.config.debug&&n.config.debug("Client: Automatic rejection of incoming channel open: no channels available")),e!==-1),f=t.data;switch(t.type){case"forwarded-tcpip":{let a=n._forwarding[`${f.destIP}:${f.destPort}`];if(a!==void 0&&o()){f.destPort===0&&(f.destPort=a),n.emit("tcp connection",f,i,s);return}break}case"forwarded-streamlocal@openssh.com":if(n._forwardingUnix[f.socketPath]!==void 0&&o()){n.emit("unix connection",f,i,s);return}break;case"auth-agent@openssh.com":if(n._agentFwdEnabled&&typeof n._agent.getStream=="function"&&o()){n._agent.getStream((a,u)=>{if(a)return s();let h=i();h.pipe(u).pipe(h)});return}break;case"x11":if(n._acceptX11!==0&&o()){n.emit("x11",f,i,s);return}break;default:r=oi.UNKNOWN_CHANNEL_TYPE,n.config.debug&&n.config.debug(`Client: Automatic rejection of unsupported incoming channel open type: ${t.type}`)}r===void 0&&(r=oi.ADMINISTRATIVELY_PROHIBITED,n.config.debug&&n.config.debug("Client: Automatic rejection of unexpected incoming channel open for: "+t.type)),s()}var I0=(()=>{let n=Buffer.allocUnsafe(16);return()=>(Vd(n,0,16),n.hexSlice(0,16))})();function cu(n){if(!Array.isArray(n))throw new Error("authList must be an array");let t=0;return(e,r,i)=>t===n.length?!1:n[t++]}function x0(n,t,e){if(!n._sock||!mt(n._sock))return;if(typeof e!="function"&&(e=hf),!Array.isArray(t))throw new TypeError("Invalid keys argument type");let r=[];for(let i of t){let s=os(i);if(s instanceof Error)throw s;r.push(s)}if(!n.config.strictVendor||n.config.strictVendor&&ai.test(n._remoteVer)){n._callbacks.push((i,s)=>{if(i){e(i!==!0?i:new Error("Server failed to prove supplied keys"));return}let o=[],f=0;for(is.init(s,0);is.avail()&&f!==r.length;){let a=r[f++],u=a.getPublicSSH(),h=is.readString();ss.init(h,0);let l=ss.readString(!0),A=ss.readString(),_;if(l!==a.type)if(a.type==="ssh-rsa")switch(l){case"rsa-sha2-256":_="sha256";break;case"rsa-sha2-512":_="sha512";break;default:continue}else continue;let x=n._protocol._kex.sessionID,b=Buffer.allocUnsafe(4+29+4+x.length+4+u.length),w=0;cf(b,29,w),b.utf8Write("hostkeys-prove-00@openssh.com",w+=4,29),cf(b,x.length,w+=29),Jc(x,b,0,x.length,w+=4),cf(b,u.length,w+=x.length),Jc(u,b,0,u.length,w+=4),(A=d0(A,l))&&a.verify(b,A,_)===!0&&o.push(a)}ss.clear(),is.clear(),e(null,o)}),n._protocol.openssh_hostKeysProve(r);return}process.nextTick(e,new Error("strictVendor enabled and server is not OpenSSH or compatible version"))}function uf(n,t,e){switch(t.type){case"ssh-rsa":if(n._protocol._compatFlags&uu.IMPLY_RSA_SHA2_SIGALGS&&(Array.isArray(e)?e=["rsa-sha2-256","rsa-sha2-512",...e]:e=["rsa-sha2-256","rsa-sha2-512"]),Array.isArray(e)){if(e.indexOf("rsa-sha2-256")!==-1)return[["rsa-sha2-256","sha256"]];if(e.indexOf("rsa-sha2-512")!==-1)return[["rsa-sha2-512","sha512"]];if(e.indexOf("ssh-rsa")===-1)return[]}return[["ssh-rsa","sha1"]]}}du.exports=lf});var gu=ze(Au=>{"use strict";var{Agent:gf}=require("http"),{Agent:y0}=require("https"),{connect:S0}=require("tls"),Af;for(let n of[gf,y0]){class t extends n{constructor(r,i){super(i),this._connectCfg=r,this._defaultSrcIP=i&&i.srcIP||"localhost"}createConnection(r,i){let s=r&&r.localAddress||this._defaultSrcIP,o=r&&r.localPort||0,f=r.host,a=r.port;Af===void 0&&(Af=df());let u=new Af,h=!1;u.on("ready",()=>{u.forwardOut(s,o,f,a,(l,A)=>{if(h=!0,l)return u.end(),i(l);A.once("close",()=>u.end()),i(null,w0(A,n,r))})}).on("error",i).on("close",()=>{h||i(new Error("Unexpected connection close"))}).connect(this._connectCfg)}}Au[n===gf?"SSHTTPAgent":"SSHTTPSAgent"]=t}function ci(){}function w0(n,t,e){if(t===gf)return n.setKeepAlive=ci,n.setNoDelay=ci,n.setTimeout=ci,n.ref=ci,n.unref=ci,n.destroySoon=n.destroy,n;e.socket=n;let r=S0(e),i=(()=>{let s=!1;return()=>{s||(s=!0,n.isPaused()&&n.resume())}})();return r.on("end",i).on("close",i),r}});var _u=ze((cg,bf)=>{"use strict";var{Server:m0}=require("net"),hi=require("events"),{listenerCount:Dt}=hi,{CHANNEL_OPEN_FAILURE:wr,DEFAULT_CIPHER:C0,DEFAULT_COMPRESSION:B0,DEFAULT_KEX:R0,DEFAULT_MAC:k0,DEFAULT_SERVER_HOST_KEY:N0,DISCONNECT_REASON:mr,DISCONNECT_REASON_BY_VALUE:T0,SUPPORTED_CIPHER:v0,SUPPORTED_COMPRESSION:L0,SUPPORTED_KEX:O0,SUPPORTED_MAC:U0,SUPPORTED_SERVER_HOST_KEY:P0}=yn(),{init:D0}=Nn(),{KexInit:Q0}=Yi(),{parseKey:Eu}=Ln(),H0=qo(),{SFTP:F0}=ri(),{writeUInt32BE:M0}=rn(),{Channel:Cr,MAX_WINDOW:Pn,PACKET_SIZE:Dn,windowAdjust:q0,WINDOW_THRESHOLD:K0}=sf(),{ChannelManager:W0,generateAlgorithmList:ui,isWritable:cs,onChannelOpenFailure:G0,onCHANNEL_CLOSE:Y0}=af(),$0=10,Qn=class extends hi{constructor(t,e,r,i,s){super(),this.username=this.user=e,this.service=r,this.method=i,this._initialResponse=!1,this._finalResponse=!1,this._multistep=!1,this._cbfinal=(o,f,a)=>{this._finalResponse||(this._finalResponse=!0,s(this,o,f,a))},this._protocol=t}accept(){this._cleanup&&this._cleanup(),this._initialResponse=!0,this._cbfinal(!0)}reject(t,e){this._cleanup&&this._cleanup(),this._initialResponse=!0,this._cbfinal(!1,t,e)}},us=class extends Qn{constructor(t,e,r,i,s,o){super(t,e,r,i,o),this._multistep=!0,this._cb=void 0,this._onInfoResponse=f=>{let a=this._cb;a&&(this._cb=void 0,a(f))},this.submethods=s,this.on("abort",()=>{this._cb&&this._cb(new Error("Authentication request aborted"))})}prompt(t,e,r,i){Array.isArray(t)||(t=[t]),typeof e=="function"?(i=e,e=r=void 0):typeof r=="function"?(i=r,r=void 0):typeof i!="function"&&(i=void 0);for(let s=0;s<t.length;++s)typeof t[s]=="string"&&(t[s]={prompt:t[s],echo:!0});this._cb=i,this._initialResponse=!0,this._protocol.authInfoReq(e,r,t)}},_f=class extends Qn{constructor(t,e,r,i,s,o){super(t,e,r,i,o),this.key={algo:s.keyAlgo,data:s.key},this.hashAlgo=s.hashAlgo,this.signature=s.signature,this.blob=s.blob}accept(){this.signature?Qn.prototype.accept.call(this):(this._initialResponse=!0,this._protocol.authPKOK(this.key.algo,this.key.data))}},pf=class extends Qn{constructor(t,e,r,i,s,o){super(t,e,r,i,o),this.key={algo:s.keyAlgo,data:s.key},this.hashAlgo=s.hashAlgo,this.signature=s.signature,this.blob=s.blob,this.localHostname=s.localHostname,this.localUsername=s.localUsername}},hs=class extends Qn{constructor(t,e,r,i,s,o){super(t,e,r,i,o),this.password=s,this._changeCb=void 0}requestChange(t,e){if(this._changeCb)throw new Error("Change request already in progress");if(typeof t!="string")throw new Error("prompt argument must be a string");if(typeof e!="function")throw new Error("Callback argument must be a function");this._changeCb=e,this._protocol.authPasswdChg(t)}},gn=class extends hi{constructor(t,e,r){super(),this.type="session",this.subtype=void 0,this.server=!0,this._ending=!1,this._channel=void 0,this._chanInfo={type:"session",incoming:{id:r,window:Pn,packetSize:Dn,state:"open"},outgoing:{id:e.sender,window:e.window,packetSize:e.packetSize,state:"open"}}}},Vt=class extends hi{constructor(t,e){if(super(),typeof t!="object"||t===null)throw new Error("Missing configuration object");let r=Object.create(null),i=[],s=t.hostKeys;if(!Array.isArray(s))throw new Error("hostKeys must be an array");let o=typeof t.algorithms=="object"&&t.algorithms!==null?t.algorithms:{},f=ui(o.serverHostKey,N0,P0);for(let A=0;A<s.length;++A){let _;if(Buffer.isBuffer(s[A])||typeof s[A]=="string"?_=Eu(s[A]):_=Eu(s[A].key,s[A].passphrase),_ instanceof Error)throw new Error(`Cannot parse privateKey: ${_.message}`);if(Array.isArray(_)&&(_=_[0]),_.getPrivatePEM()===null)throw new Error("privateKey value contains an invalid private key");if(!i.includes(_.type))if(_.type==="ssh-rsa"){let x=f.indexOf("ssh-rsa"),b=f.indexOf("rsa-sha2-256"),w=f.indexOf("rsa-sha2-512");x===-1&&(x=1/0),[x,b,w].sort(X0).forEach(C=>{if(C===-1)return;let v;switch(C){case x:v="ssh-rsa";break;case b:v="rsa-sha2-256";break;case w:v="rsa-sha2-512";break;default:return}r[v]=_,i.push(v)})}else r[_.type]=_,i.push(_.type)}let a={kex:ui(o.kex,R0,O0).concat(["kex-strict-s-v00@openssh.com"]),serverHostKey:i,cs:{cipher:ui(o.cipher,C0,v0),mac:ui(o.hmac,k0,U0),compress:ui(o.compress,B0,L0),lang:[]},sc:void 0};a.sc=a.cs,typeof e=="function"&&this.on("connection",e);let u=typeof t.debug=="function"?t.debug:void 0,h=t.ident?Buffer.from(t.ident):void 0,l=new Q0(a);this._srv=new m0(A=>{if(this._connections>=this.maxConnections){A.destroy();return}++this._connections,A.once("close",()=>{--this._connections});let _;if(u){let x=`[${process.hrtime().join(".")}] `;_=b=>{u(`${x}${b}`)}}new ls(A,r,h,l,_,this,t)}).on("error",A=>{this.emit("error",A)}).on("listening",()=>{this.emit("listening")}).on("close",()=>{this.emit("close")}),this._connections=0,this.maxConnections=1/0}injectSocket(t){this._srv.emit("connection",t)}listen(...t){return this._srv.listen(...t),this}address(){return this._srv.address()}getConnections(t){return this._srv.getConnections(t),this}close(t){return this._srv.close(t),this}ref(){return this._srv.ref(),this}unref(){return this._srv.unref(),this}};Vt.KEEPALIVE_CLIENT_INTERVAL=15e3;Vt.KEEPALIVE_CLIENT_COUNT_MAX=3;var ls=class extends hi{constructor(t,e,r,i,s,o,f){super();let a=0,u=!1,h=[],l,A,_,x=[];this._sock=t,this._chanMgr=new W0(this),this._debug=s,this.noMoreSessions=!1,this.authenticated=!1;function b(J){}this.on("error",b);let w=s?(J,y,S)=>{s(`Debug output from client: ${JSON.stringify(S)}`)}:void 0,C=typeof f.keepaliveInterval=="number"&&isFinite(f.keepaliveInterval)&&f.keepaliveInterval>0?f.keepaliveInterval:typeof Vt.KEEPALIVE_CLIENT_INTERVAL=="number"&&isFinite(Vt.KEEPALIVE_CLIENT_INTERVAL)&&Vt.KEEPALIVE_CLIENT_INTERVAL>0?Vt.KEEPALIVE_CLIENT_INTERVAL:-1,v=typeof f.keepaliveCountMax=="number"&&isFinite(f.keepaliveCountMax)&&f.keepaliveCountMax>=0?f.keepaliveCountMax:typeof Vt.KEEPALIVE_CLIENT_COUNT_MAX=="number"&&isFinite(Vt.KEEPALIVE_CLIENT_COUNT_MAX)&&Vt.KEEPALIVE_CLIENT_COUNT_MAX>=0?Vt.KEEPALIVE_CLIENT_COUNT_MAX:-1,X=0;C!==-1&&v!==-1&&(this.once("ready",()=>{let J=()=>{clearInterval(A)};this.on("close",J).on("end",J),A=setInterval(()=>{if(++X>v){clearInterval(A);let y=new Error("Keepalive timeout");y.level="client-timeout",this.emit("error",y),this.end()}else L.ping()},C)}),_=()=>{A&&A.refresh(),X=0});let L=this._protocol=new H0({server:!0,hostKeys:e,ident:r,offer:i,onPacket:_,greeting:f.greeting,banner:f.banner,onWrite:J=>{cs(t)&&t.write(J)},onError:J=>{L._destruct||t.removeAllListeners("data"),this.emit("error",J);try{t.end()}catch{}},onHeader:J=>{this.removeListener("error",b);let y={ip:t.remoteAddress,family:t.remoteFamily,port:t.remotePort,header:J};if(!o.emit("connection",this,y)){L.disconnect(mr.BY_APPLICATION),t.end();return}J.greeting&&this.emit("greeting",J.greeting)},onHandshakeComplete:J=>{++a>1&&this.emit("rekey"),this.emit("handshake",J)},debug:s,messageHandlers:{DEBUG:w,DISCONNECT:(J,y,S)=>{if(y!==mr.BY_APPLICATION){S||(S=T0[y],S===void 0&&(S=`Unexpected disconnection reason: ${y}`));let O=new Error(S);O.code=y,this.emit("error",O)}t.end()},CHANNEL_OPEN:(J,y)=>{if(y.type==="session"&&this.noMoreSessions||!this.authenticated){let re=wr.ADMINISTRATIVELY_PROHIBITED;return L.channelOpenFail(y.sender,re)}let S=-1,O,q=!1,H,se=()=>{q||(q=!0,O===void 0&&(S===-1?O=wr.RESOURCE_SHORTAGE:O=wr.CONNECT_FAILED),S!==-1&&this._chanMgr.remove(S),L.channelOpenFail(y.sender,O,""))},te=()=>(S=this._chanMgr.add(),S===-1&&(O=wr.RESOURCE_SHORTAGE,s&&s("Automatic rejection of incoming channel open: no channels available")),S!==-1),Z=y.data;switch(y.type){case"session":if(Dt(this,"session")&&te()){H=()=>{if(q)return;q=!0;let re=new gn(this,y,S);return this._chanMgr.update(S,re),L.channelOpenConfirm(y.sender,S,Pn,Dn),re},this.emit("session",H,se);return}break;case"direct-tcpip":if(Dt(this,"tcpip")&&te()){H=()=>{if(q)return;q=!0;let re={type:void 0,incoming:{id:S,window:Pn,packetSize:Dn,state:"open"},outgoing:{id:y.sender,window:y.window,packetSize:y.packetSize,state:"open"}},oe=new Cr(this,re,{server:!0});return this._chanMgr.update(S,oe),L.channelOpenConfirm(y.sender,S,Pn,Dn),oe},this.emit("tcpip",H,se,Z);return}break;case"direct-streamlocal@openssh.com":if(Dt(this,"openssh.streamlocal")&&te()){H=()=>{if(q)return;q=!0;let re={type:void 0,incoming:{id:S,window:Pn,packetSize:Dn,state:"open"},outgoing:{id:y.sender,window:y.window,packetSize:y.packetSize,state:"open"}},oe=new Cr(this,re,{server:!0});return this._chanMgr.update(S,oe),L.channelOpenConfirm(y.sender,S,Pn,Dn),oe},this.emit("openssh.streamlocal",H,se,Z);return}break;default:O=wr.UNKNOWN_CHANNEL_TYPE,s&&s(`Automatic rejection of unsupported incoming channel open type: ${y.type}`)}O===void 0&&(O=wr.ADMINISTRATIVELY_PROHIBITED,s&&s(`Automatic rejection of unexpected incoming channel open for: ${y.type}`)),se()},CHANNEL_OPEN_CONFIRMATION:(J,y)=>{let S=this._chanMgr.get(y.recipient);if(typeof S!="function")return;let O={type:S.type,incoming:{id:y.recipient,window:Pn,packetSize:Dn,state:"open"},outgoing:{id:y.sender,window:y.window,packetSize:y.packetSize,state:"open"}},q=new Cr(this,O,{server:!0});this._chanMgr.update(y.recipient,q),S(void 0,q)},CHANNEL_OPEN_FAILURE:(J,y,S,O)=>{let q=this._chanMgr.get(y);if(typeof q!="function")return;G0(this,y,{reason:S,description:O},q)},CHANNEL_DATA:(J,y,S)=>{let O=this._chanMgr.get(y);if(!(typeof O!="object"||O===null)&&!(O.constructor===gn&&(O=O._channel,!O))&&O.incoming.window!==0){if(O.incoming.window-=S.length,O.push(S)===!1){O._waitChanDrain=!0;return}O.incoming.window<=K0&&q0(O)}},CHANNEL_EXTENDED_DATA:(J,y,S,O)=>{},CHANNEL_WINDOW_ADJUST:(J,y,S)=>{let O=this._chanMgr.get(y);typeof O!="object"||O===null||O.constructor===gn&&(O=O._channel,!O)||(O.outgoing.window+=S,O._waitWindow&&(O._waitWindow=!1,O._chunk?O._write(O._chunk,null,O._chunkcb):O._chunkcb?O._chunkcb():O._chunkErr?O.stderr._write(O._chunkErr,null,O._chunkcbErr):O._chunkcbErr&&O._chunkcbErr()))},CHANNEL_SUCCESS:(J,y)=>{let S=this._chanMgr.get(y);typeof S!="object"||S===null||S.constructor===gn&&(S=S._channel,!S)||S._callbacks.length&&S._callbacks.shift()(!1)},CHANNEL_FAILURE:(J,y)=>{let S=this._chanMgr.get(y);typeof S!="object"||S===null||S.constructor===gn&&(S=S._channel,!S)||S._callbacks.length&&S._callbacks.shift()(!0)},CHANNEL_REQUEST:(J,y,S,O,q)=>{let H=this._chanMgr.get(y);if(typeof H!="object"||H===null)return;let se=!1,te,Z;if(H.constructor!==gn){O&&L.channelFailure(H.outgoing.id);return}if(O&&(S!=="shell"&&S!=="exec"&&S!=="subsystem"&&(te=()=>{se||H._ending||H._channel||(se=!0,L.channelSuccess(H._chanInfo.outgoing.id))}),Z=()=>{se||H._ending||H._channel||(se=!0,L.channelFailure(H._chanInfo.outgoing.id))}),H._ending){Z&&Z();return}switch(S){case"env":if(Dt(H,"env")){H.emit("env",te,Z,{key:q.name,val:q.value});return}break;case"pty-req":if(Dt(H,"pty")){H.emit("pty",te,Z,q);return}break;case"window-change":Dt(H,"window-change")?H.emit("window-change",te,Z,q):Z&&Z();break;case"x11-req":if(Dt(H,"x11")){H.emit("x11",te,Z,q);return}break;case"signal":if(Dt(H,"signal")){H.emit("signal",te,Z,{name:q});return}break;case"auth-agent-req@openssh.com":if(Dt(H,"auth-agent")){H.emit("auth-agent",te,Z);return}break;case"shell":if(Dt(H,"shell")){te=()=>{if(se||H._ending||H._channel)return;se=!0,O&&L.channelSuccess(H._chanInfo.outgoing.id);let re=new Cr(this,H._chanInfo,{server:!0});return re.subtype=H.subtype=S,H._channel=re,re},H.emit("shell",te,Z);return}break;case"exec":if(Dt(H,"exec")){te=()=>{if(se||H._ending||H._channel)return;se=!0,O&&L.channelSuccess(H._chanInfo.outgoing.id);let re=new Cr(this,H._chanInfo,{server:!0});return re.subtype=H.subtype=S,H._channel=re,re},H.emit("exec",te,Z,{command:q});return}break;case"subsystem":{let re=q==="sftp";if(te=()=>{if(se||H._ending||H._channel)return;se=!0,O&&L.channelSuccess(H._chanInfo.outgoing.id);let oe;return re?oe=new F0(this,H._chanInfo,{server:!0,debug:s}):(oe=new Cr(this,H._chanInfo,{server:!0}),oe.subtype=H.subtype=`${S}:${q}`),H._channel=oe,oe},q==="sftp"){if(Dt(H,"sftp")){H.emit("sftp",te,Z);return}re=!1}if(Dt(H,"subsystem")){H.emit("subsystem",te,Z,{name:q});return}break}}s&&s(`Automatic rejection of incoming channel request: ${S}`),Z&&Z()},CHANNEL_EOF:(J,y)=>{let S=this._chanMgr.get(y);typeof S!="object"||S===null||S.constructor===gn&&(S._ending||(S._ending=!0,S.emit("eof"),S.emit("end")),S=S._channel,!S)||S.incoming.state==="open"&&(S.incoming.state="eof",S.readable&&S.push(null))},CHANNEL_CLOSE:(J,y)=>{let S=this._chanMgr.get(y);typeof S!="object"||S===null||S.constructor===gn&&(S._ending=!0,S.emit("close"),S=S._channel,!S)||Y0(this,y,S)},SERVICE_REQUEST:(J,y)=>{if(a===0||u||this.authenticated||y!=="ssh-userauth"){L.disconnect(mr.SERVICE_NOT_AVAILABLE),t.end();return}u=!0,L.serviceAccept(y)},USERAUTH_REQUEST:(J,y,S,O,q)=>{if(a===0||this.authenticated||l&&(l.username!==y||l.service!==S)||O!=="password"&&O!=="publickey"&&O!=="hostbased"&&O!=="keyboard-interactive"&&O!=="none"||h.length===$0){L.disconnect(mr.PROTOCOL_ERROR),t.end();return}else if(S!=="ssh-connection"){L.disconnect(mr.SERVICE_NOT_AVAILABLE),t.end();return}let H;switch(O){case"keyboard-interactive":H=new us(L,y,S,O,q,z);break;case"publickey":H=new _f(L,y,S,O,q,z);break;case"hostbased":H=new pf(L,y,S,O,q,z);break;case"password":if(l&&l instanceof hs&&l._changeCb){let se=l._changeCb;l._changeCb=void 0,se(q.newPassword);return}H=new hs(L,y,S,O,q,z);break;case"none":H=new Qn(L,y,S,O,z);break}if(l)if(l._initialResponse)l._multistep&&!l._finalResponse&&(l._cleanup&&l._cleanup(),l.emit("abort"));else return h.push(H);l=H,Dt(this,"authentication")?this.emit("authentication",l):l.reject()},USERAUTH_INFO_RESPONSE:(J,y)=>{l&&l instanceof us&&l._onInfoResponse(y)},GLOBAL_REQUEST:(J,y,S,O)=>{let q={type:null,buf:null};function H(se,te){q.type=se,q.buf=te,ne()}if(S&&x.push(q),(y==="tcpip-forward"||y==="cancel-tcpip-forward"||y==="no-more-sessions@openssh.com"||y==="streamlocal-forward@openssh.com"||y==="cancel-streamlocal-forward@openssh.com")&&Dt(this,"request")&&this.authenticated){let se,te;if(S){let Z=!1;se=re=>{if(Z)return;Z=!0;let oe;y==="tcpip-forward"&&O.bindPort===0&&typeof re=="number"&&(oe=Buffer.allocUnsafe(4),M0(oe,re,0)),H("SUCCESS",oe)},te=()=>{Z||(Z=!0,H("FAILURE"))}}if(y==="no-more-sessions@openssh.com"){this.noMoreSessions=!0,se&&se();return}this.emit("request",se,te,y,O)}else S&&H("FAILURE")}}});t.pause(),D0.then(()=>{L.start(),t.on("data",J=>{try{L.parse(J,0,J.length)}catch(y){this.emit("error",y);try{cs(t)&&t.end()}catch{}}}),t.resume()}).catch(J=>{this.emit("error",J);try{cs(t)&&t.end()}catch{}}),t.on("error",J=>{J.level="socket",this.emit("error",J)}).once("end",()=>{s&&s("Socket ended"),L.cleanup(),this.emit("end")}).once("close",()=>{s&&s("Socket closed"),L.cleanup(),this.emit("close");let J=new Error("No response from server");this._chanMgr.cleanup(J)});let z=(J,y,S,O)=>{l===J&&!this.authenticated&&(y?(l=void 0,this.authenticated=!0,L.authSuccess(),h=[],this.emit("ready")):(L.authFailure(S,O),h.length&&(l=h.pop(),Dt(this,"authentication")?this.emit("authentication",l):l.reject())))};function ne(){for(;x.length>0&&x[0].type;){let J=x.shift();J.type==="SUCCESS"&&L.requestSuccess(J.buf),J.type==="FAILURE"&&L.requestFailure()}}}end(){return this._sock&&cs(this._sock)&&(this._protocol.disconnect(mr.BY_APPLICATION),this._sock.end()),this}x11(t,e,r){return Ef(this,"x11",{originAddr:t,originPort:e},r),this}forwardOut(t,e,r,i,s){return Ef(this,"forwarded-tcpip",{boundAddr:t,boundPort:e,remoteAddr:r,remotePort:i},s),this}openssh_forwardOutStreamLocal(t,e){return Ef(this,"forwarded-streamlocal@openssh.com",{socketPath:t},e),this}rekey(t){let e;try{this._protocol.rekey()}catch(r){e=r}typeof t=="function"&&(e?process.nextTick(t,e):this.once("rekey",t))}setNoDelay(t){return this._sock&&typeof this._sock.setNoDelay=="function"&&this._sock.setNoDelay(t),this}};function Ef(n,t,e,r){let i=Pn,s=Dn;typeof e=="function"&&(r=e,e={});let o=(a,u)=>{r(a,u)};o.type=t;let f=n._chanMgr.add(o);if(f===-1){r(new Error("No free channels available"));return}switch(t){case"forwarded-tcpip":n._protocol.forwardedTcpip(f,i,s,e);break;case"x11":n._protocol.x11(f,i,s,e);break;case"forwarded-streamlocal@openssh.com":n._protocol.openssh_forwardedStreamLocal(f,i,s,e);break;default:throw new Error(`Unsupported channel type: ${t}`)}}function X0(n,t){return n-t}bf.exports=Vt;bf.exports.IncomingClient=ls});var yu=ze((ug,xu)=>{"use strict";var{createCipheriv:j0,generateKeyPair:V0,generateKeyPairSync:z0,getCurves:J0,randomBytes:pu}=require("crypto"),{Ber:gt}=Qr(),Z0=Qs().pbkdf,{CIPHER_INFO:eA}=Nn(),tA=16,nA=16,rA=J0(),iA=new Map(Object.entries(eA));function bu(n,t){if(typeof n!="string")throw new TypeError("Key type must be a string");let e={type:"spki",format:"der"},r={type:"pkcs8",format:"der"};switch(n.toLowerCase()){case"rsa":{if(typeof t!="object"||t===null)throw new TypeError("Missing options object for RSA key");let i=t.bits;if(!Number.isInteger(i))throw new TypeError("RSA bits must be an integer");if(i<=0||i>16384)throw new RangeError("RSA bits must be non-zero and <= 16384");return["rsa",{modulusLength:i,publicKeyEncoding:e,privateKeyEncoding:r}]}case"ecdsa":{if(typeof t!="object"||t===null)throw new TypeError("Missing options object for ECDSA key");if(!Number.isInteger(t.bits))throw new TypeError("ECDSA bits must be an integer");let i;switch(t.bits){case 256:i="prime256v1";break;case 384:i="secp384r1";break;case 521:i="secp521r1";break;default:throw new Error("ECDSA bits must be 256, 384, or 521")}if(!rA.includes(i))throw new Error("Unsupported ECDSA bits value");return["ec",{namedCurve:i,publicKeyEncoding:e,privateKeyEncoding:r}]}case"ed25519":return["ed25519",{publicKeyEncoding:e,privateKeyEncoding:r}];default:throw new Error(`Unsupported key type: ${n}`)}}function sA(n,t,e){switch(n){case"rsa":{let r=new gt.Reader(e);if(r.readSequence(),r.readInt()!==0)throw new Error("Unsupported version in RSA private key");if(r.readSequence(),r.readOID()!=="1.2.840.113549.1.1.1")throw new Error("Bad RSA private OID");if(r.readByte()!==gt.Null)throw new Error("Malformed RSA private key (expected null)");if(r.readByte()!==0)throw new Error("Malformed RSA private key (expected zero-length null)");if(r=new gt.Reader(r.readString(gt.OctetString,!0)),r.readSequence(),r.readInt()!==0)throw new Error("Unsupported version in RSA private key");let i=r.readString(gt.Integer,!0),s=r.readString(gt.Integer,!0),o=r.readString(gt.Integer,!0),f=r.readString(gt.Integer,!0),a=r.readString(gt.Integer,!0);r.readString(gt.Integer,!0),r.readString(gt.Integer,!0);let u=r.readString(gt.Integer,!0),h=Buffer.from("ssh-rsa"),l=Buffer.allocUnsafe(4+h.length+4+i.length+4+s.length+4+o.length+4+u.length+4+f.length+4+a.length),A=0;l.writeUInt32BE(h.length,A+=0),l.set(h,A+=4),l.writeUInt32BE(i.length,A+=h.length),l.set(i,A+=4),l.writeUInt32BE(s.length,A+=i.length),l.set(s,A+=4),l.writeUInt32BE(o.length,A+=s.length),l.set(o,A+=4),l.writeUInt32BE(u.length,A+=o.length),l.set(u,A+=4),l.writeUInt32BE(f.length,A+=u.length),l.set(f,A+=4),l.writeUInt32BE(a.length,A+=f.length),l.set(a,A+=4);let _=Buffer.allocUnsafe(4+h.length+4+s.length+4+i.length);return A=0,_.writeUInt32BE(h.length,A+=0),_.set(h,A+=4),_.writeUInt32BE(s.length,A+=h.length),_.set(s,A+=4),_.writeUInt32BE(i.length,A+=s.length),_.set(i,A+=4),{sshName:h.toString(),priv:l,pub:_}}case"ec":{let r=new gt.Reader(t);if(r.readSequence(),r.readSequence(),r.readOID()!=="1.2.840.10045.2.1")throw new Error("Bad ECDSA public OID");r.readOID();let i=r.readString(gt.BitString,!0);{let A=0;for(;A<i.length&&i[A]===0;++A);A>0&&(i=i.slice(A))}if(r=new gt.Reader(e),r.readSequence(),r.readInt()!==0)throw new Error("Unsupported version in ECDSA private key");if(r.readSequence(),r.readOID()!=="1.2.840.10045.2.1")throw new Error("Bad ECDSA private OID");let s=r.readOID(),o;switch(s){case"1.2.840.10045.3.1.7":o="nistp256";break;case"1.3.132.0.34":o="nistp384";break;case"1.3.132.0.35":o="nistp521";break;default:throw new Error("Unsupported curve in ECDSA private key")}if(r=new gt.Reader(r.readString(gt.OctetString,!0)),r.readSequence(),r.readInt()!==1)throw new Error("Unsupported version in ECDSA private key");let f=Buffer.concat([Buffer.from([0]),r.readString(gt.OctetString,!0)]),a=Buffer.from(`ecdsa-sha2-${o}`);o=Buffer.from(o);let u=Buffer.allocUnsafe(4+a.length+4+o.length+4+i.length+4+f.length),h=0;u.writeUInt32BE(a.length,h+=0),u.set(a,h+=4),u.writeUInt32BE(o.length,h+=a.length),u.set(o,h+=4),u.writeUInt32BE(i.length,h+=o.length),u.set(i,h+=4),u.writeUInt32BE(f.length,h+=i.length),u.set(f,h+=4);let l=Buffer.allocUnsafe(4+a.length+4+o.length+4+i.length);return h=0,l.writeUInt32BE(a.length,h+=0),l.set(a,h+=4),l.writeUInt32BE(o.length,h+=a.length),l.set(o,h+=4),l.writeUInt32BE(i.length,h+=o.length),l.set(i,h+=4),{sshName:a.toString(),priv:u,pub:l}}case"ed25519":{let r=new gt.Reader(t);if(r.readSequence(),r.readSequence(),r.readOID()!=="1.3.101.112")throw new Error("Bad ED25519 public OID");let i=r.readString(gt.BitString,!0);{let h=0;for(;h<i.length&&i[h]===0;++h);h>0&&(i=i.slice(h))}if(r=new gt.Reader(e),r.readSequence(),r.readInt()!==0)throw new Error("Unsupported version in ED25519 private key");if(r.readSequence(),r.readOID()!=="1.3.101.112")throw new Error("Bad ED25519 private OID");r=new gt.Reader(r.readString(gt.OctetString,!0));let s=r.readString(gt.OctetString,!0),o=Buffer.from("ssh-ed25519"),f=Buffer.allocUnsafe(4+o.length+4+i.length+4+(s.length+i.length)),a=0;f.writeUInt32BE(o.length,a+=0),f.set(o,a+=4),f.writeUInt32BE(i.length,a+=o.length),f.set(i,a+=4),f.writeUInt32BE(s.length+i.length,a+=i.length),f.set(s,a+=4),f.set(i,a+=s.length);let u=Buffer.allocUnsafe(4+o.length+4+i.length);return a=0,u.writeUInt32BE(o.length,a+=0),u.set(o,a+=4),u.writeUInt32BE(i.length,a+=o.length),u.set(i,a+=4),{sshName:o.toString(),priv:f,pub:u}}}}function Iu(n,t,e,r){let i="new",s,o="";if(typeof r=="object"&&r!==null&&(typeof r.comment=="string"&&r.comment&&(o=r.comment),typeof r.format=="string"&&r.format&&(i=r.format),r.passphrase)){let f;if(typeof r.passphrase=="string")f=Buffer.from(r.passphrase);else if(Buffer.isBuffer(r.passphrase))f=r.passphrase;else throw new Error("Invalid passphrase");if(r.cipher===void 0)throw new Error("Missing cipher name");let a=iA.get(r.cipher);if(a===void 0)throw new Error("Invalid cipher name");if(i==="new"){let u=nA;if(r.rounds!==void 0){if(!Number.isInteger(r.rounds))throw new TypeError("rounds must be an integer");r.rounds>0&&(u=r.rounds)}let h=Buffer.allocUnsafe(a.keyLen+a.ivLen),l=pu(tA);if(Z0(f,f.length,l,l.length,h,h.length,u)!==0)return new Error("Failed to generate information to encrypt key");let _=Buffer.allocUnsafe(4+l.length+4);{let x=0;_.writeUInt32BE(l.length,x+=0),_.set(l,x+=4),_.writeUInt32BE(u,x+=l.length)}s={cipher:a,cipherName:r.cipher,kdfName:"bcrypt",kdfOptions:_,key:h.slice(0,a.keyLen),iv:h.slice(a.keyLen)}}}switch(i){case"new":{let f=`-----BEGIN OPENSSH PRIVATE KEY-----
`,a,u=Buffer.from(s?s.cipherName:"none"),h=Buffer.from(s?s.kdfName:"none"),l=s?s.kdfOptions:Buffer.alloc(0),A=s?s.cipher.blockLen:8,_=sA(n,t,e),x=pu(4),b=Buffer.from(o),w=4+4+_.priv.length+4+b.length,C=[];for(let ne=1;(w+C.length)%A;++ne)C.push(ne&255);C=Buffer.from(C);let v=Buffer.allocUnsafe(w+C.length),X;{let ne=0;v.set(x,ne+=0),v.set(x,ne+=4),v.set(_.priv,ne+=4),v.writeUInt32BE(b.length,ne+=_.priv.length),v.set(b,ne+=4),v.set(C,ne+=b.length)}if(s){let ne={authTagLength:s.cipher.authLen},J=j0(s.cipher.sslName,s.key,s.iv,ne);J.setAutoPadding(!1),v=Buffer.concat([J.update(v),J.final()]),s.cipher.authLen>0?X=J.getAuthTag():X=Buffer.alloc(0),s.key.fill(0),s.iv.fill(0)}else X=Buffer.alloc(0);let L=Buffer.from("openssh-key-v1\0"),z=Buffer.allocUnsafe(L.length+4+u.length+4+h.length+4+l.length+4+4+_.pub.length+4+v.length+X.length);{let ne=0;z.set(L,ne+=0),z.writeUInt32BE(u.length,ne+=L.length),z.set(u,ne+=4),z.writeUInt32BE(h.length,ne+=u.length),z.set(h,ne+=4),z.writeUInt32BE(l.length,ne+=h.length),z.set(l,ne+=4),z.writeUInt32BE(1,ne+=l.length),z.writeUInt32BE(_.pub.length,ne+=4),z.set(_.pub,ne+=4),z.writeUInt32BE(v.length,ne+=_.pub.length),z.set(v,ne+=4),z.set(X,ne+=v.length)}{let ne=z.base64Slice(0,z.length),J=ne.replace(/.{64}/g,`$&
`);ne.length&63&&(J+=`
`),f+=J}{let ne=_.pub.base64Slice(0,_.pub.length);a=`${_.sshName} ${ne}${o?` ${o}`:""}`}return f+=`-----END OPENSSH PRIVATE KEY-----
`,{private:f,public:a}}default:throw new Error("Invalid output key format")}}function oA(){}xu.exports={generateKeyPair:(n,t,e)=>{typeof t=="function"&&(e=t,t=void 0),typeof e!="function"&&(e=oA);let r=bu(n,t);V0(...r,(i,s,o)=>{if(i)return e(i);let f;try{f=Iu(r[0],s,o,t)}catch(a){return e(a)}e(null,f)})},generateKeyPairSync:(n,t)=>{let e=bu(n,t),{publicKey:r,privateKey:i}=z0(...e);return Iu(e[0],r,i,t)}}});var wu=ze((hg,Su)=>{"use strict";var{AgentProtocol:fA,BaseAgent:aA,createAgent:cA,CygwinAgent:uA,OpenSSHAgent:hA,PageantAgent:lA}=Bo(),{SSHTTPAgent:dA,SSHTTPSAgent:AA}=gu(),{parseKey:gA}=Ln(),{flagsToString:EA,OPEN_MODE:_A,STATUS_CODE:pA,stringToFlags:bA}=ri();Su.exports={AgentProtocol:fA,BaseAgent:aA,createAgent:cA,Client:df(),CygwinAgent:uA,HTTPAgent:dA,HTTPSAgent:AA,OpenSSHAgent:hA,PageantAgent:lA,Server:_u(),utils:{parseKey:gA,...yu(),sftp:{flagsToString:EA,OPEN_MODE:_A,STATUS_CODE:pA,stringToFlags:bA}}}});var wA={};Du(wA,{default:()=>Es});module.exports=Qu(wA);var qt=require("obsidian");var Ie=cn(require("assert"),1),Br=cn(require("fs"),1),xf=cn(kf(),1),Bu=cn(Mf(),1),Qt=cn(require("path"),1);var ln=class{constructor({concurrency:t=1}={}){this.options={concurrency:t},this.running=0,this.queue=[],this.idleCallbacks=[]}clear(){this.queue=[]}onIdle(t){return this.idleCallbacks.push(t),()=>{let e=this.idleCallbacks.indexOf(t);e!==-1&&this.idleCallbacks.splice(e,1)}}waitTillIdle(){return new Promise(t=>{if(this.running===0){t();return}let e=this.onIdle(()=>{e(),t()})})}add(t){return new Promise((e,r)=>{let i=()=>{this.running+=1;try{Promise.resolve(t()).then(s=>{e(s),this.processNext()},s=>{r(s),this.processNext()})}catch(s){r(s),this.processNext()}};this.running>=this.options.concurrency?this.queue.push(i):i()})}processNext(){this.running-=1;let t=this.queue.shift();t?t():this.running===0&&this.idleCallbacks.forEach(e=>e())}};var Rs=cn(require("fs"),1),ks=cn(require("path"),1),sr=cn(require("assert"),1);var qf={join(n,t){return ks.default.join(n,t)},basename(n){return ks.default.basename(n)},stat(n){return new Promise((t,e)=>{Rs.default.stat(n,(r,i)=>{r?e(r):t(i)})})},readdir(n){return new Promise((t,e)=>{Rs.default.readdir(n,(r,i)=>{r?e(r):t(i)})})}};async function Kf({path:n,recursive:t,validate:e,result:r,fileSystem:i,queue:s,reject:o}){let f=await i.stat(n);if(f.isFile()?r.files.push(n):f.isDirectory()&&r.directories.push(n),!f.isDirectory()||t==="none")return;(await i.readdir(n)).forEach(u=>{let h=i.join(n,u);e(h)&&s.add(()=>Kf({path:h,recursive:t==="shallow"?"none":"deep",validate:e,result:r,fileSystem:i,queue:s,reject:o})).catch(o)})}async function wh(n,{recursive:t=!0,validate:e=null,concurrency:r=1/0,fileSystem:i=qf}={}){(0,sr.default)(n&&typeof n=="string","path must be a valid string"),(0,sr.default)(typeof t=="boolean","options.recursive must be a valid boolean"),(0,sr.default)(e===null||typeof e=="function","options.validate must be a valid function"),(0,sr.default)(typeof r=="number","options.concurrency must be a valid number"),(0,sr.default)(i!==null&&typeof i=="object","options.fileSystem must be a valid object");let s=new ln({concurrency:r}),o={files:[],directories:[]},f={...qf,...i};return await new Promise((a,u)=>{Kf({path:n,recursive:t?"deep":"shallow",validate:e??(h=>f.basename(h).slice(0,1)!=="."),result:o,fileSystem:f,queue:s,reject:u}).then(()=>s.waitTillIdle()).then(a,u)}),o}var Ns=wh;var yf=cn(Gf(),1),Ru=cn(wu(),1),If=1,mu=n=>!Qt.default.basename(n).startsWith("."),Cu=()=>{},As=class extends Error{constructor(t,e=null){super(t),this.code=e}};function ds(n){return n.includes("\\")?n.split("\\").join("/"):n}async function IA(n){return new Promise((t,e)=>{Br.default.readFile(n,"utf8",(r,i)=>{r?e(r):t(i)})})}var xA=/Error: (E[\S]+): /;async function yA(n,t){let e=null;try{e=await new Promise((r,i)=>{t.stat(n,(s,o)=>{s?i(s):r(o)})})}catch{}if(e){if(e.isDirectory())return;throw new Error("mkdir() failed, target already exists and is not a directory")}try{await new Promise((r,i)=>{t.mkdir(n,s=>{s?i(s):r()})})}catch(r){if(r!=null&&typeof r.stack=="string"){let i=xA.exec(r.stack);throw i!=null?new As(r.message,i[1]):r}}}var gs=class{constructor(){this.connection=null}getConnection(){let{connection:t}=this;if(t==null)throw new Error("Not connected to server");return t}async connect(t){(0,Ie.default)(t!=null&&typeof t=="object","config must be a valid object");let e={...t};if((0,Ie.default)(e.username!=null&&typeof e.username=="string","config.username must be a valid string"),e.host!=null)(0,Ie.default)(typeof e.host=="string","config.host must be a valid string");else if(e.sock!=null)(0,Ie.default)(typeof e.sock=="object","config.sock must be a valid object");else throw new Ie.AssertionError({message:"Either config.host or config.sock must be provided"});if(e.privateKey!=null||e.privateKeyPath!=null){if(e.privateKey!=null?((0,Ie.default)(typeof e.privateKey=="string","config.privateKey must be a valid string"),(0,Ie.default)(e.privateKeyPath==null,"config.privateKeyPath must not be specified when config.privateKey is specified")):e.privateKeyPath!=null&&((0,Ie.default)(typeof e.privateKeyPath=="string","config.privateKeyPath must be a valid string"),(0,Ie.default)(e.privateKey==null,"config.privateKey must not be specified when config.privateKeyPath is specified")),(0,Ie.default)(e.passphrase==null||typeof e.passphrase=="string","config.passphrase must be null or a valid string"),e.privateKeyPath!=null)try{e.privateKey=await IA(e.privateKeyPath)}catch(i){throw i!=null&&i.code==="ENOENT"?new Ie.AssertionError({message:"config.privateKeyPath does not exist at given fs path"}):i}}else e.password!=null&&(0,Ie.default)(typeof e.password=="string","config.password must be a valid string");if(e.tryKeyboard!=null&&(0,Ie.default)(typeof e.tryKeyboard=="boolean","config.tryKeyboard must be a valid boolean"),e.tryKeyboard){let{password:i}=e;e.onKeyboardInteractive!=null?(0,Ie.default)(typeof e.onKeyboardInteractive=="function","config.onKeyboardInteractive must be a valid function"):i!=null&&(e.onKeyboardInteractive=(s,o,f,a,u)=>{a.length>0&&a[0].prompt.toLowerCase().includes("password")&&u([i])})}let r=new Ru.default.Client;return this.connection=r,await new Promise((i,s)=>{r.on("error",s),e.onKeyboardInteractive&&r.on("keyboard-interactive",e.onKeyboardInteractive),r.on("ready",()=>{r.removeListener("error",s),i()}),r.on("end",()=>{this.connection===r&&(this.connection=null)}),r.on("close",()=>{this.connection===r&&(this.connection=null),s(new As("No response from server","ETIMEDOUT"))}),r.connect(e)}),this}isConnected(){return this.connection!=null}async requestShell(t){let e=this.getConnection();return new Promise((r,i)=>{e.on("error",i);let s=(o,f)=>{e.removeListener("error",i),o?i(o):r(f)};t==null?e.shell(s):e.shell(t,s)})}async withShell(t,e){(0,Ie.default)(typeof t=="function","callback must be a valid function");let r=await this.requestShell(e);try{await t(r)}finally{r.destroy()}}async requestSFTP(){let t=this.getConnection();return new Promise((e,r)=>{t.on("error",r),t.sftp((i,s)=>{t.removeListener("error",r),i?r(i):e(s)})})}async withSFTP(t){(0,Ie.default)(typeof t=="function","callback must be a valid function");let e=await this.requestSFTP();try{await t(e)}finally{e.end()}}async execCommand(t,e={}){(0,Ie.default)(typeof t=="string","command must be a valid string"),(0,Ie.default)(e!=null&&typeof e=="object","options must be a valid object"),(0,Ie.default)(e.cwd==null||typeof e.cwd=="string","options.cwd must be a valid string"),(0,Ie.default)(e.stdin==null||typeof e.stdin=="string"||xf.default.readable(e.stdin),"options.stdin must be a valid string or readable stream"),(0,Ie.default)(e.execOptions==null||typeof e.execOptions=="object","options.execOptions must be a valid object"),(0,Ie.default)(e.encoding==null||typeof e.encoding=="string","options.encoding must be a valid string"),(0,Ie.default)(e.onChannel==null||typeof e.onChannel=="function","options.onChannel must be a valid function"),(0,Ie.default)(e.onStdout==null||typeof e.onStdout=="function","options.onStdout must be a valid function"),(0,Ie.default)(e.onStderr==null||typeof e.onStderr=="function","options.onStderr must be a valid function"),(0,Ie.default)(e.noTrim==null||typeof e.noTrim=="boolean","options.noTrim must be a boolean");let r=t;e.cwd&&(r=`cd ${(0,yf.default)([e.cwd])} ; ${r}`);let i=this.getConnection(),s={stdout:[],stderr:[]};return new Promise((o,f)=>{i.on("error",f),i.exec(r,e.execOptions!=null?e.execOptions:{},(a,u)=>{if(i.removeListener("error",f),a){f(a);return}e.onChannel&&e.onChannel(u),u.on("data",A=>{e.onStdout&&e.onStdout(A),s.stdout.push(A.toString(e.encoding))}),u.stderr.on("data",A=>{e.onStderr&&e.onStderr(A),s.stderr.push(A.toString(e.encoding))}),e.stdin!=null?xf.default.readable(e.stdin)?e.stdin.pipe(u,{end:!0}):(u.write(e.stdin),u.end()):u.end();let h=null,l=null;u.on("exit",(A,_)=>{h=A??null,l=_??null}),u.on("close",()=>{let A=s.stdout.join(""),_=s.stderr.join("");e.noTrim!==!0&&(A=A.trim(),_=_.trim()),o({code:h??null,signal:l??null,stdout:A,stderr:_})})})})}async exec(t,e,r={}){(0,Ie.default)(typeof t=="string","command must be a valid string"),(0,Ie.default)(Array.isArray(e),"parameters must be a valid array"),(0,Ie.default)(r!=null&&typeof r=="object","options must be a valid object"),(0,Ie.default)(r.stream==null||["both","stdout","stderr"].includes(r.stream),"options.stream must be one of both, stdout, stderr");for(let o=0,{length:f}=e;o<f;o+=1)(0,Ie.default)(typeof e[o]=="string",`parameters[${o}] must be a valid string`);let i=`${t}${e.length>0?` ${(0,yf.default)(e)}`:""}`,s=await this.execCommand(i,r);if(r.stream==null||r.stream==="stdout"){if(s.stderr)throw new Error(s.stderr);return s.stdout}return r.stream==="stderr"?s.stderr:s}async mkdir(t,e="sftp",r=null){if((0,Ie.default)(typeof t=="string","path must be a valid string"),(0,Ie.default)(typeof e=="string"&&(e==="sftp"||e==="exec"),"method must be either sftp or exec"),(0,Ie.default)(r==null||typeof r=="object","sftp must be a valid object"),e==="exec"){await this.exec("mkdir",["-p",ds(t)]);return}let i=r||await this.requestSFTP(),s=async o=>yA(ds(t),i).catch(async f=>{if(!o||f==null||f.message!=="No such file"&&f.code!=="ENOENT")throw f;await this.mkdir(Qt.default.dirname(t),"sftp",i),await s(!1)});try{await s(!0)}finally{r||i.end()}}async getFile(t,e,r=null,i=null){(0,Ie.default)(typeof t=="string","localFile must be a valid string"),(0,Ie.default)(typeof e=="string","remoteFile must be a valid string"),(0,Ie.default)(r==null||typeof r=="object","sftp must be a valid object"),(0,Ie.default)(i==null||typeof i=="object","transferOptions must be a valid object");let s=r||await this.requestSFTP();try{await new Promise((o,f)=>{s.fastGet(ds(e),t,i||{},a=>{a?f(a):o()})})}finally{r||s.end()}}async putFile(t,e,r=null,i=null){(0,Ie.default)(typeof t=="string","localFile must be a valid string"),(0,Ie.default)(typeof e=="string","remoteFile must be a valid string"),(0,Ie.default)(r==null||typeof r=="object","sftp must be a valid object"),(0,Ie.default)(i==null||typeof i=="object","transferOptions must be a valid object"),(0,Ie.default)(await new Promise(f=>{Br.default.access(t,Br.default.constants.R_OK,a=>{f(a===null)})}),`localFile does not exist at ${t}`);let s=r||await this.requestSFTP(),o=f=>new Promise((a,u)=>{s.fastPut(t,ds(e),i||{},h=>{if(h==null){a();return}h.message==="No such file"&&f?a(this.mkdir(Qt.default.dirname(e),"sftp",s).then(()=>o(!1))):u(h)})});try{await o(!0)}finally{r||s.end()}}async putFiles(t,{concurrency:e=If,sftp:r=null,transferOptions:i={}}={}){(0,Ie.default)(Array.isArray(t),"files must be an array");for(let a=0,{length:u}=t;a<u;a+=1){let h=t[a];(0,Ie.default)(h,"files items must be valid objects"),(0,Ie.default)(h.local&&typeof h.local=="string",`files[${a}].local must be a string`),(0,Ie.default)(h.remote&&typeof h.remote=="string",`files[${a}].remote must be a string`)}let s=[],o=r||await this.requestSFTP(),f=new ln({concurrency:e});try{await new Promise((a,u)=>{t.forEach(h=>{f.add(async()=>{await this.putFile(h.local,h.remote,o,i),s.push(h)}).catch(u)}),f.waitTillIdle().then(a)})}catch(a){throw a!=null&&(a.transferred=s),a}finally{r||o.end()}}async putDirectory(t,e,{concurrency:r=If,sftp:i=null,transferOptions:s={},recursive:o=!0,tick:f=Cu,validate:a=mu}={}){(0,Ie.default)(typeof t=="string"&&t,"localDirectory must be a string"),(0,Ie.default)(typeof e=="string"&&e,"remoteDirectory must be a string");let u=await new Promise(b=>{Br.default.stat(t,(w,C)=>{b(C||null)})});(0,Ie.default)(u!=null,`localDirectory does not exist at ${t}`),(0,Ie.default)(u.isDirectory(),`localDirectory is not a directory at ${t}`);let h=i||await this.requestSFTP(),l=await Ns(t,{recursive:o,validate:a}),A=l.files.map(b=>Qt.default.relative(t,b)),_=l.directories.map(b=>Qt.default.relative(t,b));_.sort((b,w)=>b.length-w.length);let x=!1;try{await new Promise((b,w)=>{let C=new ln({concurrency:r});_.forEach(v=>{C.add(async()=>{await this.mkdir(Qt.default.join(e,v),"sftp",h)}).catch(w)}),b(C.waitTillIdle())}),await new Promise((b,w)=>{let C=new ln({concurrency:r});A.forEach(v=>{C.add(async()=>{let X=Qt.default.join(t,v),L=Qt.default.join(e,v);try{await this.putFile(X,L,h,s),f(X,L,null)}catch(z){x=!0,f(X,L,z)}}).catch(w)}),b(C.waitTillIdle())})}finally{i||h.end()}return!x}async getDirectory(t,e,{concurrency:r=If,sftp:i=null,transferOptions:s={},recursive:o=!0,tick:f=Cu,validate:a=mu}={}){(0,Ie.default)(typeof t=="string"&&t,"localDirectory must be a string"),(0,Ie.default)(typeof e=="string"&&e,"remoteDirectory must be a string");let u=await new Promise(b=>{Br.default.stat(t,(w,C)=>{b(C||null)})});(0,Ie.default)(u!=null,`localDirectory does not exist at ${t}`),(0,Ie.default)(u.isDirectory(),`localDirectory is not a directory at ${t}`);let h=i||await this.requestSFTP(),l=await Ns(e,{recursive:o,validate:a,concurrency:r,fileSystem:{basename(b){return Qt.default.posix.basename(b)},join(b,w){return Qt.default.posix.join(b,w)},readdir(b){return new Promise((w,C)=>{h.readdir(b,(v,X)=>{v?C(v):w(X.map(L=>L.filename))})})},stat(b){return new Promise((w,C)=>{h.stat(b,(v,X)=>{v?C(v):w(X)})})}}}),A=l.files.map(b=>Qt.default.relative(e,b)),_=l.directories.map(b=>Qt.default.relative(e,b));_.sort((b,w)=>b.length-w.length);let x=!1;try{await new Promise((b,w)=>{let C=new ln({concurrency:r});_.forEach(v=>{C.add(async()=>{await(0,Bu.default)(Qt.default.join(t,v))}).catch(w)}),b(C.waitTillIdle())}),await new Promise((b,w)=>{let C=new ln({concurrency:r});A.forEach(v=>{C.add(async()=>{let X=Qt.default.join(t,v),L=Qt.default.join(e,v);try{await this.getFile(X,L,h,s),f(X,L,null)}catch(z){x=!0,f(X,L,z)}}).catch(w)}),b(C.waitTillIdle())})}finally{i||h.end()}return!x}forwardIn(t,e,r){let i=this.getConnection();return new Promise((s,o)=>{i.forwardIn(t,e,(f,a)=>{if(f){o(f);return}let u=(l,A,_)=>{l.destIP===t&&l.destPort===a&&r?.(l,A,_)};r&&i.on("tcp connection",u),s({port:a,dispose:()=>new Promise((l,A)=>{i.off("tcp connection",u),i.unforwardIn(t,a,_=>{_&&A(f),l()})})})})})}forwardOut(t,e,r,i){let s=this.getConnection();return new Promise((o,f)=>{s.forwardOut(t,e,r,i,(a,u)=>{if(a){f(a);return}o(u)})})}forwardInStreamLocal(t,e){let r=this.getConnection();return new Promise((i,s)=>{r.openssh_forwardInStreamLocal(t,o=>{if(o){s(o);return}let f=(u,h,l)=>{u.socketPath===t&&e?.(u,h,l)};e&&r.on("unix connection",f),i({dispose:()=>new Promise((u,h)=>{r.off("unix connection",f),r.openssh_unforwardInStreamLocal(t,l=>{l&&h(l),u()})})})})})}forwardOutStreamLocal(t){let e=this.getConnection();return new Promise((r,i)=>{e.openssh_forwardOutStreamLocal(t,(s,o)=>{if(s){i(s);return}r(o)})})}dispose(){this.connection&&(this.connection.end(),this.connection=null)}};var SA={serverAddress:"",username:"",password:"",remotePath:""},Es=class extends qt.Plugin{async onload(){await this.loadSettings(),this.addCommand({id:"upload-current-file",name:"Upload Current File via SCP",callback:()=>this.uploadCurrentFile()}),this.addSettingTab(new Sf(this.app,this))}async uploadCurrentFile(){let e=this.app.workspace.getActiveFile();if(!e){console.error("No active file"),new qt.Notice("No active file!");return}let r="";this.app.vault.adapter instanceof qt.FileSystemAdapter&&(r=this.app.vault.adapter.getFullPath(e.path));let i=this.app.vault.getName(),s=r.lastIndexOf(i);if(s===-1){console.error("Vault name not found in file path");return}let o=r.substring(s+i.length+1),f=new gs;try{await f.connect({host:this.settings.serverAddress,username:this.settings.username,password:this.settings.password}),await f.execCommand(`mkdir -p ${this.settings.remotePath}`),await f.putFile(r,`${this.settings.remotePath}/${o}`),console.log(`File ${e.name} uploaded successfully`),new qt.Notice(`File ${e.name} uploaded successfully`)}catch(a){console.error("Error uploading file:",a),new qt.Notice("Error uploading file:",a)}finally{f.dispose()}}onunload(){console.log("Unloading ScpNoteUpload")}async loadSettings(){this.settings=Object.assign({},SA,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}},Sf=class extends qt.PluginSettingTab{constructor(e,r){super(e,r);this.plugin=r}display(){let{containerEl:e}=this;e.empty(),e.createEl("h2",{text:"Settings for SCP Note upload plugin"}),new qt.Setting(e).setName("Server Address").setDesc("The address of the server to upload files to.").addText(r=>r.setPlaceholder("example.com").setValue(this.plugin.settings.serverAddress).onChange(async i=>{this.plugin.settings.serverAddress=i,await this.plugin.saveSettings()})),new qt.Setting(e).setName("Username").setDesc("The username for SCP authentication.").addText(r=>r.setPlaceholder("your-username").setValue(this.plugin.settings.username).onChange(async i=>{this.plugin.settings.username=i,await this.plugin.saveSettings()})),new qt.Setting(e).setName("Password").setDesc("The password for SCP authentication.").addText(r=>r.setPlaceholder("your-password").setValue(this.plugin.settings.password).onChange(async i=>{this.plugin.settings.password=i,await this.plugin.saveSettings()})),new qt.Setting(e).setName("Remote Path").setDesc("The path on the remote server to upload files to.").addText(r=>r.setPlaceholder("/path/on/remote/server").setValue(this.plugin.settings.remotePath).onChange(async i=>{this.plugin.settings.remotePath=i,await this.plugin.saveSettings}))}};
